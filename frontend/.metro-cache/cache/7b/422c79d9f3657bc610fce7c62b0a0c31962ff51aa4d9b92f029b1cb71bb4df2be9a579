{"dependencies":[{"name":"../../errors/request.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":21,"index":129},"end":{"line":4,"column":55,"index":163}}],"key":"Bu6PYP3hUl2jiacy+OFL3cCcZHs=","exportNames":["*"],"imports":1}},{"name":"../../errors/transport.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":23,"index":188},"end":{"line":5,"column":59,"index":224}}],"key":"zWCiWm0X6zDiE+/d0erAkFo4VRM=","exportNames":["*"],"imports":1}},{"name":"../../utils/rpc/compat.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":20,"index":246},"end":{"line":6,"column":56,"index":282}}],"key":"q/adGe8MlQaOJQCFIDwvr3ETeWc=","exportNames":["*"],"imports":1}},{"name":"../../utils/rpc/webSocket.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":23,"index":307},"end":{"line":7,"column":62,"index":346}}],"key":"W+twNTor4FMBuXnSTPA769ofcEk=","exportNames":["*"],"imports":1}},{"name":"./createTransport.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":29,"index":377},"end":{"line":8,"column":60,"index":408}}],"key":"2KKCa+DiBTjCoOj7i5xHNLHMXm8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.webSocket = webSocket;\n  const request_js_1 = require(_dependencyMap[0], \"../../errors/request.js\");\n  const transport_js_1 = require(_dependencyMap[1], \"../../errors/transport.js\");\n  const compat_js_1 = require(_dependencyMap[2], \"../../utils/rpc/compat.js\");\n  const webSocket_js_1 = require(_dependencyMap[3], \"../../utils/rpc/webSocket.js\");\n  const createTransport_js_1 = require(_dependencyMap[4], \"./createTransport.js\");\n  function webSocket(url, config = {}) {\n    const {\n      keepAlive,\n      key = 'webSocket',\n      methods,\n      name = 'WebSocket JSON-RPC',\n      reconnect,\n      retryDelay\n    } = config;\n    return ({\n      chain,\n      retryCount: retryCount_,\n      timeout: timeout_\n    }) => {\n      const retryCount = config.retryCount ?? retryCount_;\n      const timeout = timeout_ ?? config.timeout ?? 10_000;\n      const url_ = url || chain?.rpcUrls.default.webSocket?.[0];\n      if (!url_) throw new transport_js_1.UrlRequiredError();\n      return (0, createTransport_js_1.createTransport)({\n        key,\n        methods,\n        name,\n        async request({\n          method,\n          params\n        }) {\n          const body = {\n            method,\n            params\n          };\n          const rpcClient = await (0, webSocket_js_1.getWebSocketRpcClient)(url_, {\n            keepAlive,\n            reconnect\n          });\n          const {\n            error,\n            result\n          } = await rpcClient.requestAsync({\n            body,\n            timeout\n          });\n          if (error) throw new request_js_1.RpcRequestError({\n            body,\n            error,\n            url: url_\n          });\n          return result;\n        },\n        retryCount,\n        retryDelay,\n        timeout,\n        type: 'webSocket'\n      }, {\n        getSocket() {\n          return (0, compat_js_1.getSocket)(url_);\n        },\n        getRpcClient() {\n          return (0, webSocket_js_1.getWebSocketRpcClient)(url_);\n        },\n        async subscribe({\n          params,\n          onData,\n          onError\n        }) {\n          const rpcClient = await (0, webSocket_js_1.getWebSocketRpcClient)(url_);\n          const {\n            result: subscriptionId\n          } = await new Promise((resolve, reject) => rpcClient.request({\n            body: {\n              method: 'eth_subscribe',\n              params\n            },\n            onError(error) {\n              reject(error);\n              onError?.(error);\n              return;\n            },\n            onResponse(response) {\n              if (response.error) {\n                reject(response.error);\n                onError?.(response.error);\n                return;\n              }\n              if (typeof response.id === 'number') {\n                resolve(response);\n                return;\n              }\n              if (response.method !== 'eth_subscription') return;\n              onData(response.params);\n            }\n          }));\n          return {\n            subscriptionId,\n            async unsubscribe() {\n              return new Promise(resolve => rpcClient.request({\n                body: {\n                  method: 'eth_unsubscribe',\n                  params: [subscriptionId]\n                },\n                onResponse: resolve\n              }));\n            }\n          };\n        }\n      });\n    };\n  }\n});","lineCount":120,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"webSocket"],[7,19,3,17],[7,22,3,20,"webSocket"],[7,31,3,29],[8,2,4,0],[8,8,4,6,"request_js_1"],[8,20,4,18],[8,23,4,21,"require"],[8,30,4,28],[8,31,4,28,"_dependencyMap"],[8,45,4,28],[8,75,4,54],[8,76,4,55],[9,2,5,0],[9,8,5,6,"transport_js_1"],[9,22,5,20],[9,25,5,23,"require"],[9,32,5,30],[9,33,5,30,"_dependencyMap"],[9,47,5,30],[9,79,5,58],[9,80,5,59],[10,2,6,0],[10,8,6,6,"compat_js_1"],[10,19,6,17],[10,22,6,20,"require"],[10,29,6,27],[10,30,6,27,"_dependencyMap"],[10,44,6,27],[10,76,6,55],[10,77,6,56],[11,2,7,0],[11,8,7,6,"webSocket_js_1"],[11,22,7,20],[11,25,7,23,"require"],[11,32,7,30],[11,33,7,30,"_dependencyMap"],[11,47,7,30],[11,82,7,61],[11,83,7,62],[12,2,8,0],[12,8,8,6,"createTransport_js_1"],[12,28,8,26],[12,31,8,29,"require"],[12,38,8,36],[12,39,8,36,"_dependencyMap"],[12,53,8,36],[12,80,8,59],[12,81,8,60],[13,2,9,0],[13,11,9,9,"webSocket"],[13,20,9,18,"webSocket"],[13,21,9,19,"url"],[13,24,9,22],[13,26,9,24,"config"],[13,32,9,30],[13,35,9,33],[13,36,9,34],[13,37,9,35],[13,39,9,37],[14,4,10,4],[14,10,10,10],[15,6,10,12,"keepAlive"],[15,15,10,21],[16,6,10,23,"key"],[16,9,10,26],[16,12,10,29],[16,23,10,40],[17,6,10,42,"methods"],[17,13,10,49],[18,6,10,51,"name"],[18,10,10,55],[18,13,10,58],[18,33,10,78],[19,6,10,80,"reconnect"],[19,15,10,89],[20,6,10,91,"retryDelay"],[21,4,10,103],[21,5,10,104],[21,8,10,107,"config"],[21,14,10,113],[22,4,11,4],[22,11,11,11],[22,12,11,12],[23,6,11,14,"chain"],[23,11,11,19],[24,6,11,21,"retryCount"],[24,16,11,31],[24,18,11,33,"retryCount_"],[24,29,11,44],[25,6,11,46,"timeout"],[25,13,11,53],[25,15,11,55,"timeout_"],[26,4,11,64],[26,5,11,65],[26,10,11,70],[27,6,12,8],[27,12,12,14,"retryCount"],[27,22,12,24],[27,25,12,27,"config"],[27,31,12,33],[27,32,12,34,"retryCount"],[27,42,12,44],[27,46,12,48,"retryCount_"],[27,57,12,59],[28,6,13,8],[28,12,13,14,"timeout"],[28,19,13,21],[28,22,13,24,"timeout_"],[28,30,13,32],[28,34,13,36,"config"],[28,40,13,42],[28,41,13,43,"timeout"],[28,48,13,50],[28,52,13,54],[28,58,13,60],[29,6,14,8],[29,12,14,14,"url_"],[29,16,14,18],[29,19,14,21,"url"],[29,22,14,24],[29,26,14,28,"chain"],[29,31,14,33],[29,33,14,35,"rpcUrls"],[29,40,14,42],[29,41,14,43,"default"],[29,48,14,50],[29,49,14,51,"webSocket"],[29,58,14,60],[29,61,14,63],[29,62,14,64],[29,63,14,65],[30,6,15,8],[30,10,15,12],[30,11,15,13,"url_"],[30,15,15,17],[30,17,16,12],[30,23,16,18],[30,27,16,22,"transport_js_1"],[30,41,16,36],[30,42,16,37,"UrlRequiredError"],[30,58,16,53],[30,59,16,54],[30,60,16,55],[31,6,17,8],[31,13,17,15],[31,14,17,16],[31,15,17,17],[31,17,17,19,"createTransport_js_1"],[31,37,17,39],[31,38,17,40,"createTransport"],[31,53,17,55],[31,55,17,57],[32,8,18,12,"key"],[32,11,18,15],[33,8,19,12,"methods"],[33,15,19,19],[34,8,20,12,"name"],[34,12,20,16],[35,8,21,12],[35,14,21,18,"request"],[35,21,21,25,"request"],[35,22,21,26],[36,10,21,28,"method"],[36,16,21,34],[37,10,21,36,"params"],[38,8,21,43],[38,9,21,44],[38,11,21,46],[39,10,22,16],[39,16,22,22,"body"],[39,20,22,26],[39,23,22,29],[40,12,22,31,"method"],[40,18,22,37],[41,12,22,39,"params"],[42,10,22,46],[42,11,22,47],[43,10,23,16],[43,16,23,22,"rpcClient"],[43,25,23,31],[43,28,23,34],[43,34,23,40],[43,35,23,41],[43,36,23,42],[43,38,23,44,"webSocket_js_1"],[43,52,23,58],[43,53,23,59,"getWebSocketRpcClient"],[43,74,23,80],[43,76,23,82,"url_"],[43,80,23,86],[43,82,23,88],[44,12,24,20,"keepAlive"],[44,21,24,29],[45,12,25,20,"reconnect"],[46,10,26,16],[46,11,26,17],[46,12,26,18],[47,10,27,16],[47,16,27,22],[48,12,27,24,"error"],[48,17,27,29],[49,12,27,31,"result"],[50,10,27,38],[50,11,27,39],[50,14,27,42],[50,20,27,48,"rpcClient"],[50,29,27,57],[50,30,27,58,"requestAsync"],[50,42,27,70],[50,43,27,71],[51,12,28,20,"body"],[51,16,28,24],[52,12,29,20,"timeout"],[53,10,30,16],[53,11,30,17],[53,12,30,18],[54,10,31,16],[54,14,31,20,"error"],[54,19,31,25],[54,21,32,20],[54,27,32,26],[54,31,32,30,"request_js_1"],[54,43,32,42],[54,44,32,43,"RpcRequestError"],[54,59,32,58],[54,60,32,59],[55,12,33,24,"body"],[55,16,33,28],[56,12,34,24,"error"],[56,17,34,29],[57,12,35,24,"url"],[57,15,35,27],[57,17,35,29,"url_"],[58,10,36,20],[58,11,36,21],[58,12,36,22],[59,10,37,16],[59,17,37,23,"result"],[59,23,37,29],[60,8,38,12],[60,9,38,13],[61,8,39,12,"retryCount"],[61,18,39,22],[62,8,40,12,"retryDelay"],[62,18,40,22],[63,8,41,12,"timeout"],[63,15,41,19],[64,8,42,12,"type"],[64,12,42,16],[64,14,42,18],[65,6,43,8],[65,7,43,9],[65,9,43,11],[66,8,44,12,"getSocket"],[66,17,44,21,"getSocket"],[66,18,44,21],[66,20,44,24],[67,10,45,16],[67,17,45,23],[67,18,45,24],[67,19,45,25],[67,21,45,27,"compat_js_1"],[67,32,45,38],[67,33,45,39,"getSocket"],[67,42,45,48],[67,44,45,50,"url_"],[67,48,45,54],[67,49,45,55],[68,8,46,12],[68,9,46,13],[69,8,47,12,"getRpcClient"],[69,20,47,24,"getRpcClient"],[69,21,47,24],[69,23,47,27],[70,10,48,16],[70,17,48,23],[70,18,48,24],[70,19,48,25],[70,21,48,27,"webSocket_js_1"],[70,35,48,41],[70,36,48,42,"getWebSocketRpcClient"],[70,57,48,63],[70,59,48,65,"url_"],[70,63,48,69],[70,64,48,70],[71,8,49,12],[71,9,49,13],[72,8,50,12],[72,14,50,18,"subscribe"],[72,23,50,27,"subscribe"],[72,24,50,28],[73,10,50,30,"params"],[73,16,50,36],[74,10,50,38,"onData"],[74,16,50,44],[75,10,50,46,"onError"],[76,8,50,54],[76,9,50,55],[76,11,50,57],[77,10,51,16],[77,16,51,22,"rpcClient"],[77,25,51,31],[77,28,51,34],[77,34,51,40],[77,35,51,41],[77,36,51,42],[77,38,51,44,"webSocket_js_1"],[77,52,51,58],[77,53,51,59,"getWebSocketRpcClient"],[77,74,51,80],[77,76,51,82,"url_"],[77,80,51,86],[77,81,51,87],[78,10,52,16],[78,16,52,22],[79,12,52,24,"result"],[79,18,52,30],[79,20,52,32,"subscriptionId"],[80,10,52,47],[80,11,52,48],[80,14,52,51],[80,20,52,57],[80,24,52,61,"Promise"],[80,31,52,68],[80,32,52,69],[80,33,52,70,"resolve"],[80,40,52,77],[80,42,52,79,"reject"],[80,48,52,85],[80,53,52,90,"rpcClient"],[80,62,52,99],[80,63,52,100,"request"],[80,70,52,107],[80,71,52,108],[81,12,53,20,"body"],[81,16,53,24],[81,18,53,26],[82,14,54,24,"method"],[82,20,54,30],[82,22,54,32],[82,37,54,47],[83,14,55,24,"params"],[84,12,56,20],[84,13,56,21],[85,12,57,20,"onError"],[85,19,57,27,"onError"],[85,20,57,28,"error"],[85,25,57,33],[85,27,57,35],[86,14,58,24,"reject"],[86,20,58,30],[86,21,58,31,"error"],[86,26,58,36],[86,27,58,37],[87,14,59,24,"onError"],[87,21,59,31],[87,24,59,34,"error"],[87,29,59,39],[87,30,59,40],[88,14,60,24],[89,12,61,20],[89,13,61,21],[90,12,62,20,"onResponse"],[90,22,62,30,"onResponse"],[90,23,62,31,"response"],[90,31,62,39],[90,33,62,41],[91,14,63,24],[91,18,63,28,"response"],[91,26,63,36],[91,27,63,37,"error"],[91,32,63,42],[91,34,63,44],[92,16,64,28,"reject"],[92,22,64,34],[92,23,64,35,"response"],[92,31,64,43],[92,32,64,44,"error"],[92,37,64,49],[92,38,64,50],[93,16,65,28,"onError"],[93,23,65,35],[93,26,65,38,"response"],[93,34,65,46],[93,35,65,47,"error"],[93,40,65,52],[93,41,65,53],[94,16,66,28],[95,14,67,24],[96,14,68,24],[96,18,68,28],[96,25,68,35,"response"],[96,33,68,43],[96,34,68,44,"id"],[96,36,68,46],[96,41,68,51],[96,49,68,59],[96,51,68,61],[97,16,69,28,"resolve"],[97,23,69,35],[97,24,69,36,"response"],[97,32,69,44],[97,33,69,45],[98,16,70,28],[99,14,71,24],[100,14,72,24],[100,18,72,28,"response"],[100,26,72,36],[100,27,72,37,"method"],[100,33,72,43],[100,38,72,48],[100,56,72,66],[100,58,73,28],[101,14,74,24,"onData"],[101,20,74,30],[101,21,74,31,"response"],[101,29,74,39],[101,30,74,40,"params"],[101,36,74,46],[101,37,74,47],[102,12,75,20],[103,10,76,16],[103,11,76,17],[103,12,76,18],[103,13,76,19],[104,10,77,16],[104,17,77,23],[105,12,78,20,"subscriptionId"],[105,26,78,34],[106,12,79,20],[106,18,79,26,"unsubscribe"],[106,29,79,37,"unsubscribe"],[106,30,79,37],[106,32,79,40],[107,14,80,24],[107,21,80,31],[107,25,80,35,"Promise"],[107,32,80,42],[107,33,80,44,"resolve"],[107,40,80,51],[107,44,80,56,"rpcClient"],[107,53,80,65],[107,54,80,66,"request"],[107,61,80,73],[107,62,80,74],[108,16,81,28,"body"],[108,20,81,32],[108,22,81,34],[109,18,82,32,"method"],[109,24,82,38],[109,26,82,40],[109,43,82,57],[110,18,83,32,"params"],[110,24,83,38],[110,26,83,40],[110,27,83,41,"subscriptionId"],[110,41,83,55],[111,16,84,28],[111,17,84,29],[112,16,85,28,"onResponse"],[112,26,85,38],[112,28,85,40,"resolve"],[113,14,86,24],[113,15,86,25],[113,16,86,26],[113,17,86,27],[114,12,87,20],[115,10,88,16],[115,11,88,17],[116,8,89,12],[117,6,90,8],[117,7,90,9],[117,8,90,10],[118,4,91,4],[118,5,91,5],[119,2,92,0],[120,0,92,1],[120,3]],"functionMap":{"names":["<global>","webSocket","<anonymous>","request","getSocket","getRpcClient","subscribe","Promise$argument_0","rpcClient.request$argument_0.onError","rpcClient.request$argument_0.onResponse","unsubscribe"],"mappings":"AAA;ACQ;WCE;YCU;aDiB;YEM;aFE;YGC;aHE;YIC;qECE;oBCK;qBDI;oBEC;qBFa;kBDC;oBIG;2CHC;0BGM;qBJC;aJE;KDE;CDC"},"hasCjsExports":true},"type":"js/module"}]}