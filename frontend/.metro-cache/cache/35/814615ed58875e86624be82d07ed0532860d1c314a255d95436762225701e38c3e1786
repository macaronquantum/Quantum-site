{"dependencies":[{"name":"../../errors/request.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":84,"index":84}}],"key":"2pE/btc+6/9ceuRiPNwUYrtm86Y=","exportNames":["*"],"imports":1}},{"name":"./socket.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":85},"end":{"line":2,"column":50,"index":135}}],"key":"eFXiJ3xGWi9z9IR2MpLa1oE6lVc=","exportNames":["*"],"imports":1}},{"name":"isows","data":{"asyncType":"async","isESMImport":true,"locs":[{"start":{"line":7,"column":36,"index":383},"end":{"line":7,"column":51,"index":398}}],"key":"QtQ48QtBnZwN5dw4VoxUxf1ZWZU=","exportNames":["*"],"imports":1}},{"name":"expo/internal/async-require-module","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":36,"index":383},"end":{"line":7,"column":56,"index":403}}],"key":"y8mhXL4zKvSVvgnacXXOn0UU+QQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.getWebSocketRpcClient = getWebSocketRpcClient;\n  var _errorsRequestJs = require(_dependencyMap[0], \"../../errors/request.js\");\n  var _socketJs = require(_dependencyMap[1], \"./socket.js\");\n  async function getWebSocketRpcClient(url, options = {}) {\n    const {\n      keepAlive,\n      reconnect\n    } = options;\n    return (0, _socketJs.getSocketRpcClient)({\n      async getSocket({\n        onClose,\n        onError,\n        onOpen,\n        onResponse\n      }) {\n        const WebSocket = await require(_dependencyMap[3], \"expo/internal/async-require-module\")(_dependencyMap[2], _dependencyMap.paths, \"isows\").then(module => module.WebSocket);\n        const socket = new WebSocket(url);\n        function onClose_() {\n          socket.removeEventListener('close', onClose_);\n          socket.removeEventListener('message', onMessage);\n          socket.removeEventListener('error', onError);\n          socket.removeEventListener('open', onOpen);\n          onClose();\n        }\n        function onMessage({\n          data\n        }) {\n          // ignore empty messages\n          if (typeof data === 'string' && data.trim().length === 0) return;\n          try {\n            const _data = JSON.parse(data);\n            onResponse(_data);\n          } catch (error) {\n            onError(error);\n          }\n        }\n        // Setup event listeners for RPC & subscription responses.\n        socket.addEventListener('close', onClose_);\n        socket.addEventListener('message', onMessage);\n        socket.addEventListener('error', onError);\n        socket.addEventListener('open', onOpen);\n        // Wait for the socket to open.\n        if (socket.readyState === WebSocket.CONNECTING) {\n          await new Promise((resolve, reject) => {\n            if (!socket) return;\n            socket.onopen = resolve;\n            socket.onerror = reject;\n          });\n        }\n        const {\n          close: close_\n        } = socket;\n        return Object.assign(socket, {\n          close() {\n            close_.bind(socket)();\n            onClose_();\n          },\n          ping() {\n            try {\n              if (socket.readyState === socket.CLOSED || socket.readyState === socket.CLOSING) throw new _errorsRequestJs.WebSocketRequestError({\n                url: socket.url,\n                cause: new _errorsRequestJs.SocketClosedError({\n                  url: socket.url\n                })\n              });\n              const body = {\n                jsonrpc: '2.0',\n                id: null,\n                method: 'net_version',\n                params: []\n              };\n              socket.send(JSON.stringify(body));\n            } catch (error) {\n              onError(error);\n            }\n          },\n          request({\n            body\n          }) {\n            if (socket.readyState === socket.CLOSED || socket.readyState === socket.CLOSING) throw new _errorsRequestJs.WebSocketRequestError({\n              body,\n              url: socket.url,\n              cause: new _errorsRequestJs.SocketClosedError({\n                url: socket.url\n              })\n            });\n            return socket.send(JSON.stringify(body));\n          }\n        });\n      },\n      keepAlive,\n      reconnect,\n      url\n    });\n  }\n});","lineCount":102,"map":[[7,2,3,0,"exports"],[7,9,3,0],[7,10,3,0,"getWebSocketRpcClient"],[7,31,3,0],[7,34,3,0,"getWebSocketRpcClient"],[7,55,3,0],[8,2,1,0],[8,6,1,0,"_errorsRequestJs"],[8,22,1,0],[8,25,1,0,"require"],[8,32,1,0],[8,33,1,0,"_dependencyMap"],[8,47,1,0],[9,2,2,0],[9,6,2,0,"_socketJs"],[9,15,2,0],[9,18,2,0,"require"],[9,25,2,0],[9,26,2,0,"_dependencyMap"],[9,40,2,0],[10,2,3,7],[10,17,3,22,"getWebSocketRpcClient"],[10,38,3,43,"getWebSocketRpcClient"],[10,39,3,44,"url"],[10,42,3,47],[10,44,3,49,"options"],[10,51,3,56],[10,54,3,59],[10,55,3,60],[10,56,3,61],[10,58,3,63],[11,4,4,4],[11,10,4,10],[12,6,4,12,"keepAlive"],[12,15,4,21],[13,6,4,23,"reconnect"],[14,4,4,33],[14,5,4,34],[14,8,4,37,"options"],[14,15,4,44],[15,4,5,4],[15,11,5,11],[15,15,5,11,"getSocketRpcClient"],[15,24,5,29],[15,25,5,29,"getSocketRpcClient"],[15,43,5,29],[15,45,5,30],[16,6,6,8],[16,12,6,14,"getSocket"],[16,21,6,23,"getSocket"],[16,22,6,24],[17,8,6,26,"onClose"],[17,15,6,33],[18,8,6,35,"onError"],[18,15,6,42],[19,8,6,44,"onOpen"],[19,14,6,50],[20,8,6,52,"onResponse"],[21,6,6,63],[21,7,6,64],[21,9,6,66],[22,8,7,12],[22,14,7,18,"WebSocket"],[22,23,7,27],[22,26,7,30],[22,32,7,36,"require"],[22,39,7,36],[22,40,7,36,"_dependencyMap"],[22,54,7,36],[22,97,7,36,"_dependencyMap"],[22,111,7,36],[22,116,7,36,"_dependencyMap"],[22,130,7,36],[22,131,7,36,"paths"],[22,136,7,36],[22,147,7,52,"then"],[22,151,7,56],[22,152,7,58,"module"],[22,158,7,64],[22,162,7,69,"module"],[22,168,7,75],[22,169,7,76,"WebSocket"],[22,178,7,85],[22,179,7,86],[23,8,8,12],[23,14,8,18,"socket"],[23,20,8,24],[23,23,8,27],[23,27,8,31,"WebSocket"],[23,36,8,40],[23,37,8,41,"url"],[23,40,8,44],[23,41,8,45],[24,8,9,12],[24,17,9,21,"onClose_"],[24,25,9,29,"onClose_"],[24,26,9,29],[24,28,9,32],[25,10,10,16,"socket"],[25,16,10,22],[25,17,10,23,"removeEventListener"],[25,36,10,42],[25,37,10,43],[25,44,10,50],[25,46,10,52,"onClose_"],[25,54,10,60],[25,55,10,61],[26,10,11,16,"socket"],[26,16,11,22],[26,17,11,23,"removeEventListener"],[26,36,11,42],[26,37,11,43],[26,46,11,52],[26,48,11,54,"onMessage"],[26,57,11,63],[26,58,11,64],[27,10,12,16,"socket"],[27,16,12,22],[27,17,12,23,"removeEventListener"],[27,36,12,42],[27,37,12,43],[27,44,12,50],[27,46,12,52,"onError"],[27,53,12,59],[27,54,12,60],[28,10,13,16,"socket"],[28,16,13,22],[28,17,13,23,"removeEventListener"],[28,36,13,42],[28,37,13,43],[28,43,13,49],[28,45,13,51,"onOpen"],[28,51,13,57],[28,52,13,58],[29,10,14,16,"onClose"],[29,17,14,23],[29,18,14,24],[29,19,14,25],[30,8,15,12],[31,8,16,12],[31,17,16,21,"onMessage"],[31,26,16,30,"onMessage"],[31,27,16,31],[32,10,16,33,"data"],[33,8,16,38],[33,9,16,39],[33,11,16,41],[34,10,17,16],[35,10,18,16],[35,14,18,20],[35,21,18,27,"data"],[35,25,18,31],[35,30,18,36],[35,38,18,44],[35,42,18,48,"data"],[35,46,18,52],[35,47,18,53,"trim"],[35,51,18,57],[35,52,18,58],[35,53,18,59],[35,54,18,60,"length"],[35,60,18,66],[35,65,18,71],[35,66,18,72],[35,68,19,20],[36,10,20,16],[36,14,20,20],[37,12,21,20],[37,18,21,26,"_data"],[37,23,21,31],[37,26,21,34,"JSON"],[37,30,21,38],[37,31,21,39,"parse"],[37,36,21,44],[37,37,21,45,"data"],[37,41,21,49],[37,42,21,50],[38,12,22,20,"onResponse"],[38,22,22,30],[38,23,22,31,"_data"],[38,28,22,36],[38,29,22,37],[39,10,23,16],[39,11,23,17],[39,12,24,16],[39,19,24,23,"error"],[39,24,24,28],[39,26,24,30],[40,12,25,20,"onError"],[40,19,25,27],[40,20,25,28,"error"],[40,25,25,33],[40,26,25,34],[41,10,26,16],[42,8,27,12],[43,8,28,12],[44,8,29,12,"socket"],[44,14,29,18],[44,15,29,19,"addEventListener"],[44,31,29,35],[44,32,29,36],[44,39,29,43],[44,41,29,45,"onClose_"],[44,49,29,53],[44,50,29,54],[45,8,30,12,"socket"],[45,14,30,18],[45,15,30,19,"addEventListener"],[45,31,30,35],[45,32,30,36],[45,41,30,45],[45,43,30,47,"onMessage"],[45,52,30,56],[45,53,30,57],[46,8,31,12,"socket"],[46,14,31,18],[46,15,31,19,"addEventListener"],[46,31,31,35],[46,32,31,36],[46,39,31,43],[46,41,31,45,"onError"],[46,48,31,52],[46,49,31,53],[47,8,32,12,"socket"],[47,14,32,18],[47,15,32,19,"addEventListener"],[47,31,32,35],[47,32,32,36],[47,38,32,42],[47,40,32,44,"onOpen"],[47,46,32,50],[47,47,32,51],[48,8,33,12],[49,8,34,12],[49,12,34,16,"socket"],[49,18,34,22],[49,19,34,23,"readyState"],[49,29,34,33],[49,34,34,38,"WebSocket"],[49,43,34,47],[49,44,34,48,"CONNECTING"],[49,54,34,58],[49,56,34,60],[50,10,35,16],[50,16,35,22],[50,20,35,26,"Promise"],[50,27,35,33],[50,28,35,34],[50,29,35,35,"resolve"],[50,36,35,42],[50,38,35,44,"reject"],[50,44,35,50],[50,49,35,55],[51,12,36,20],[51,16,36,24],[51,17,36,25,"socket"],[51,23,36,31],[51,25,37,24],[52,12,38,20,"socket"],[52,18,38,26],[52,19,38,27,"onopen"],[52,25,38,33],[52,28,38,36,"resolve"],[52,35,38,43],[53,12,39,20,"socket"],[53,18,39,26],[53,19,39,27,"onerror"],[53,26,39,34],[53,29,39,37,"reject"],[53,35,39,43],[54,10,40,16],[54,11,40,17],[54,12,40,18],[55,8,41,12],[56,8,42,12],[56,14,42,18],[57,10,42,20,"close"],[57,15,42,25],[57,17,42,27,"close_"],[58,8,42,34],[58,9,42,35],[58,12,42,38,"socket"],[58,18,42,44],[59,8,43,12],[59,15,43,19,"Object"],[59,21,43,25],[59,22,43,26,"assign"],[59,28,43,32],[59,29,43,33,"socket"],[59,35,43,39],[59,37,43,41],[60,10,44,16,"close"],[60,15,44,21,"close"],[60,16,44,21],[60,18,44,24],[61,12,45,20,"close_"],[61,18,45,26],[61,19,45,27,"bind"],[61,23,45,31],[61,24,45,32,"socket"],[61,30,45,38],[61,31,45,39],[61,32,45,40],[61,33,45,41],[62,12,46,20,"onClose_"],[62,20,46,28],[62,21,46,29],[62,22,46,30],[63,10,47,16],[63,11,47,17],[64,10,48,16,"ping"],[64,14,48,20,"ping"],[64,15,48,20],[64,17,48,23],[65,12,49,20],[65,16,49,24],[66,14,50,24],[66,18,50,28,"socket"],[66,24,50,34],[66,25,50,35,"readyState"],[66,35,50,45],[66,40,50,50,"socket"],[66,46,50,56],[66,47,50,57,"CLOSED"],[66,53,50,63],[66,57,51,28,"socket"],[66,63,51,34],[66,64,51,35,"readyState"],[66,74,51,45],[66,79,51,50,"socket"],[66,85,51,56],[66,86,51,57,"CLOSING"],[66,93,51,64],[66,95,52,28],[66,101,52,34],[66,105,52,38,"WebSocketRequestError"],[66,121,52,59],[66,122,52,59,"WebSocketRequestError"],[66,143,52,59],[66,144,52,60],[67,16,53,32,"url"],[67,19,53,35],[67,21,53,37,"socket"],[67,27,53,43],[67,28,53,44,"url"],[67,31,53,47],[68,16,54,32,"cause"],[68,21,54,37],[68,23,54,39],[68,27,54,43,"SocketClosedError"],[68,43,54,60],[68,44,54,60,"SocketClosedError"],[68,61,54,60],[68,62,54,61],[69,18,54,63,"url"],[69,21,54,66],[69,23,54,68,"socket"],[69,29,54,74],[69,30,54,75,"url"],[70,16,54,79],[70,17,54,80],[71,14,55,28],[71,15,55,29],[71,16,55,30],[72,14,56,24],[72,20,56,30,"body"],[72,24,56,34],[72,27,56,37],[73,16,57,28,"jsonrpc"],[73,23,57,35],[73,25,57,37],[73,30,57,42],[74,16,58,28,"id"],[74,18,58,30],[74,20,58,32],[74,24,58,36],[75,16,59,28,"method"],[75,22,59,34],[75,24,59,36],[75,37,59,49],[76,16,60,28,"params"],[76,22,60,34],[76,24,60,36],[77,14,61,24],[77,15,61,25],[78,14,62,24,"socket"],[78,20,62,30],[78,21,62,31,"send"],[78,25,62,35],[78,26,62,36,"JSON"],[78,30,62,40],[78,31,62,41,"stringify"],[78,40,62,50],[78,41,62,51,"body"],[78,45,62,55],[78,46,62,56],[78,47,62,57],[79,12,63,20],[79,13,63,21],[79,14,64,20],[79,21,64,27,"error"],[79,26,64,32],[79,28,64,34],[80,14,65,24,"onError"],[80,21,65,31],[80,22,65,32,"error"],[80,27,65,37],[80,28,65,38],[81,12,66,20],[82,10,67,16],[82,11,67,17],[83,10,68,16,"request"],[83,17,68,23,"request"],[83,18,68,24],[84,12,68,26,"body"],[85,10,68,31],[85,11,68,32],[85,13,68,34],[86,12,69,20],[86,16,69,24,"socket"],[86,22,69,30],[86,23,69,31,"readyState"],[86,33,69,41],[86,38,69,46,"socket"],[86,44,69,52],[86,45,69,53,"CLOSED"],[86,51,69,59],[86,55,70,24,"socket"],[86,61,70,30],[86,62,70,31,"readyState"],[86,72,70,41],[86,77,70,46,"socket"],[86,83,70,52],[86,84,70,53,"CLOSING"],[86,91,70,60],[86,93,71,24],[86,99,71,30],[86,103,71,34,"WebSocketRequestError"],[86,119,71,55],[86,120,71,55,"WebSocketRequestError"],[86,141,71,55],[86,142,71,56],[87,14,72,28,"body"],[87,18,72,32],[88,14,73,28,"url"],[88,17,73,31],[88,19,73,33,"socket"],[88,25,73,39],[88,26,73,40,"url"],[88,29,73,43],[89,14,74,28,"cause"],[89,19,74,33],[89,21,74,35],[89,25,74,39,"SocketClosedError"],[89,41,74,56],[89,42,74,56,"SocketClosedError"],[89,59,74,56],[89,60,74,57],[90,16,74,59,"url"],[90,19,74,62],[90,21,74,64,"socket"],[90,27,74,70],[90,28,74,71,"url"],[91,14,74,75],[91,15,74,76],[92,12,75,24],[92,13,75,25],[92,14,75,26],[93,12,76,20],[93,19,76,27,"socket"],[93,25,76,33],[93,26,76,34,"send"],[93,30,76,38],[93,31,76,39,"JSON"],[93,35,76,43],[93,36,76,44,"stringify"],[93,45,76,53],[93,46,76,54,"body"],[93,50,76,58],[93,51,76,59],[93,52,76,60],[94,10,77,16],[95,8,78,12],[95,9,78,13],[95,10,78,14],[96,6,79,8],[96,7,79,9],[97,6,80,8,"keepAlive"],[97,15,80,17],[98,6,81,8,"reconnect"],[98,15,81,17],[99,6,82,8,"url"],[100,4,83,4],[100,5,83,5],[100,6,83,6],[101,2,84,0],[102,0,84,1],[102,3]],"functionMap":{"names":["<global>","getWebSocketRpcClient","getSocketRpcClient$argument_0.getSocket","import.then$argument_0","onClose_","onMessage","Promise$argument_0","Object.assign$argument_1.close","Object.assign$argument_1.ping","Object.assign$argument_1.request"],"mappings":"AAA;OCE;QCG;yDCC,4BD;YEE;aFM;YGC;aHW;kCIQ;iBJK;gBKI;iBLG;gBMC;iBNmB;gBOC;iBPS;SDE;CDK"},"hasCjsExports":false},"type":"js/module"}]}