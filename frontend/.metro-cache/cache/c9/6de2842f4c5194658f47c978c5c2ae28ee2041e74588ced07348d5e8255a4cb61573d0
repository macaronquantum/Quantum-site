{"dependencies":[{"name":"../transport.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":23,"index":265},"end":{"line":7,"column":49,"index":291}}],"key":"lFCvJFzyfVWMX45Bf0f/rFXObZ0=","exportNames":["*"],"imports":1}},{"name":"../util.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":18,"index":311},"end":{"line":8,"column":39,"index":332}}],"key":"Bzso+pzc0We++WtcOzIpK6Le7v4=","exportNames":["*"],"imports":1}},{"name":"engine.io-parser","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":9,"column":27,"index":361},"end":{"line":9,"column":54,"index":388}}],"key":"ZdCLryCFqJSS+1R9t7L2i2r0/QM=","exportNames":["*"],"imports":1}},{"name":"debug","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":10,"column":32,"index":422},"end":{"line":10,"column":48,"index":438}}],"key":"iZ55sBoXw9WwOGuopuB9Sv3DBX8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var __importDefault = this && this.__importDefault || function (mod) {\n    return mod && mod.__esModule ? mod : {\n      \"default\": mod\n    };\n  };\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.Polling = void 0;\n  const transport_js_1 = require(_dependencyMap[0], \"../transport.js\");\n  const util_js_1 = require(_dependencyMap[1], \"../util.js\");\n  const engine_io_parser_1 = require(_dependencyMap[2], \"engine.io-parser\");\n  const debug_1 = __importDefault(require(_dependencyMap[3], \"debug\")); // debug()\n  const debug = (0, debug_1.default)(\"engine.io-client:polling\"); // debug()\n  class Polling extends transport_js_1.Transport {\n    constructor() {\n      super(...arguments);\n      this._polling = false;\n    }\n    get name() {\n      return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n      this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n      this.readyState = \"pausing\";\n      const pause = () => {\n        debug(\"paused\");\n        this.readyState = \"paused\";\n        onPause();\n      };\n      if (this._polling || !this.writable) {\n        let total = 0;\n        if (this._polling) {\n          debug(\"we are currently polling - waiting to pause\");\n          total++;\n          this.once(\"pollComplete\", function () {\n            debug(\"pre-pause polling complete\");\n            --total || pause();\n          });\n        }\n        if (!this.writable) {\n          debug(\"we are currently writing - waiting to pause\");\n          total++;\n          this.once(\"drain\", function () {\n            debug(\"pre-pause writing complete\");\n            --total || pause();\n          });\n        }\n      } else {\n        pause();\n      }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n      debug(\"polling\");\n      this._polling = true;\n      this.doPoll();\n      this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n      debug(\"polling got data %s\", data);\n      const callback = packet => {\n        // if its the first message we consider the transport open\n        if (\"opening\" === this.readyState && packet.type === \"open\") {\n          this.onOpen();\n        }\n        // if its a close packet, we close the ongoing requests\n        if (\"close\" === packet.type) {\n          this.onClose({\n            description: \"transport closed by the server\"\n          });\n          return false;\n        }\n        // otherwise bypass onData and handle the message\n        this.onPacket(packet);\n      };\n      // decode payload\n      (0, engine_io_parser_1.decodePayload)(data, this.socket.binaryType).forEach(callback);\n      // if an event did not trigger closing\n      if (\"closed\" !== this.readyState) {\n        // if we got data we're not polling\n        this._polling = false;\n        this.emitReserved(\"pollComplete\");\n        if (\"open\" === this.readyState) {\n          this._poll();\n        } else {\n          debug('ignoring poll - transport state \"%s\"', this.readyState);\n        }\n      }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n      const close = () => {\n        debug(\"writing close packet\");\n        this.write([{\n          type: \"close\"\n        }]);\n      };\n      if (\"open\" === this.readyState) {\n        debug(\"transport open - closing\");\n        close();\n      } else {\n        // in case we're trying to close while\n        // handshaking is in progress (GH-164)\n        debug(\"transport not open - deferring close\");\n        this.once(\"open\", close);\n      }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n      this.writable = false;\n      (0, engine_io_parser_1.encodePayload)(packets, data => {\n        this.doWrite(data, () => {\n          this.writable = true;\n          this.emitReserved(\"drain\");\n        });\n      });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n      const schema = this.opts.secure ? \"https\" : \"http\";\n      const query = this.query || {};\n      // cache busting is forced\n      if (false !== this.opts.timestampRequests) {\n        query[this.opts.timestampParam] = (0, util_js_1.randomString)();\n      }\n      if (!this.supportsBinary && !query.sid) {\n        query.b64 = 1;\n      }\n      return this.createUri(schema, query);\n    }\n  }\n  exports.Polling = Polling;\n});","lineCount":173,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0],[4,6,2,4,"__importDefault"],[4,21,2,19],[4,24,2,23],[4,28,2,27],[4,32,2,31],[4,36,2,35],[4,37,2,36,"__importDefault"],[4,52,2,51],[4,56,2,56],[4,66,2,66,"mod"],[4,69,2,69],[4,71,2,71],[5,4,3,4],[5,11,3,12,"mod"],[5,14,3,15],[5,18,3,19,"mod"],[5,21,3,22],[5,22,3,23,"__esModule"],[5,32,3,33],[5,35,3,37,"mod"],[5,38,3,40],[5,41,3,43],[6,6,3,45],[6,15,3,54],[6,17,3,56,"mod"],[7,4,3,60],[7,5,3,61],[8,2,4,0],[8,3,4,1],[9,2,5,0,"Object"],[9,8,5,6],[9,9,5,7,"defineProperty"],[9,23,5,21],[9,24,5,22,"exports"],[9,31,5,29],[9,33,5,31],[9,45,5,43],[9,47,5,45],[10,4,5,47,"value"],[10,9,5,52],[10,11,5,54],[11,2,5,59],[11,3,5,60],[11,4,5,61],[12,2,6,0,"exports"],[12,9,6,7],[12,10,6,8,"Polling"],[12,17,6,15],[12,20,6,18],[12,25,6,23],[12,26,6,24],[13,2,7,0],[13,8,7,6,"transport_js_1"],[13,22,7,20],[13,25,7,23,"require"],[13,32,7,30],[13,33,7,30,"_dependencyMap"],[13,47,7,30],[13,69,7,48],[13,70,7,49],[14,2,8,0],[14,8,8,6,"util_js_1"],[14,17,8,15],[14,20,8,18,"require"],[14,27,8,25],[14,28,8,25,"_dependencyMap"],[14,42,8,25],[14,59,8,38],[14,60,8,39],[15,2,9,0],[15,8,9,6,"engine_io_parser_1"],[15,26,9,24],[15,29,9,27,"require"],[15,36,9,34],[15,37,9,34,"_dependencyMap"],[15,51,9,34],[15,74,9,53],[15,75,9,54],[16,2,10,0],[16,8,10,6,"debug_1"],[16,15,10,13],[16,18,10,16,"__importDefault"],[16,33,10,31],[16,34,10,32,"require"],[16,41,10,39],[16,42,10,39,"_dependencyMap"],[16,56,10,39],[16,68,10,47],[16,69,10,48],[16,70,10,49],[16,71,10,50],[16,72,10,51],[17,2,11,0],[17,8,11,6,"debug"],[17,13,11,11],[17,16,11,14],[17,17,11,15],[17,18,11,16],[17,20,11,18,"debug_1"],[17,27,11,25],[17,28,11,26,"default"],[17,35,11,33],[17,37,11,35],[17,63,11,61],[17,64,11,62],[17,65,11,63],[17,66,11,64],[18,2,12,0],[18,8,12,6,"Polling"],[18,15,12,13],[18,24,12,22,"transport_js_1"],[18,38,12,36],[18,39,12,37,"Transport"],[18,48,12,46],[18,49,12,47],[19,4,13,4,"constructor"],[19,15,13,15,"constructor"],[19,16,13,15],[19,18,13,18],[20,6,14,8],[20,11,14,13],[20,12,14,14],[20,15,14,17,"arguments"],[20,24,14,26],[20,25,14,27],[21,6,15,8],[21,10,15,12],[21,11,15,13,"_polling"],[21,19,15,21],[21,22,15,24],[21,27,15,29],[22,4,16,4],[23,4,17,4],[23,8,17,8,"name"],[23,12,17,12,"name"],[23,13,17,12],[23,15,17,15],[24,6,18,8],[24,13,18,15],[24,22,18,24],[25,4,19,4],[26,4,20,4],[27,0,21,0],[28,0,22,0],[29,0,23,0],[30,0,24,0],[31,0,25,0],[32,4,26,4,"doOpen"],[32,10,26,10,"doOpen"],[32,11,26,10],[32,13,26,13],[33,6,27,8],[33,10,27,12],[33,11,27,13,"_poll"],[33,16,27,18],[33,17,27,19],[33,18,27,20],[34,4,28,4],[35,4,29,4],[36,0,30,0],[37,0,31,0],[38,0,32,0],[39,0,33,0],[40,0,34,0],[41,4,35,4,"pause"],[41,9,35,9,"pause"],[41,10,35,10,"onPause"],[41,17,35,17],[41,19,35,19],[42,6,36,8],[42,10,36,12],[42,11,36,13,"readyState"],[42,21,36,23],[42,24,36,26],[42,33,36,35],[43,6,37,8],[43,12,37,14,"pause"],[43,17,37,19],[43,20,37,22,"pause"],[43,21,37,22],[43,26,37,28],[44,8,38,12,"debug"],[44,13,38,17],[44,14,38,18],[44,22,38,26],[44,23,38,27],[45,8,39,12],[45,12,39,16],[45,13,39,17,"readyState"],[45,23,39,27],[45,26,39,30],[45,34,39,38],[46,8,40,12,"onPause"],[46,15,40,19],[46,16,40,20],[46,17,40,21],[47,6,41,8],[47,7,41,9],[48,6,42,8],[48,10,42,12],[48,14,42,16],[48,15,42,17,"_polling"],[48,23,42,25],[48,27,42,29],[48,28,42,30],[48,32,42,34],[48,33,42,35,"writable"],[48,41,42,43],[48,43,42,45],[49,8,43,12],[49,12,43,16,"total"],[49,17,43,21],[49,20,43,24],[49,21,43,25],[50,8,44,12],[50,12,44,16],[50,16,44,20],[50,17,44,21,"_polling"],[50,25,44,29],[50,27,44,31],[51,10,45,16,"debug"],[51,15,45,21],[51,16,45,22],[51,61,45,67],[51,62,45,68],[52,10,46,16,"total"],[52,15,46,21],[52,17,46,23],[53,10,47,16],[53,14,47,20],[53,15,47,21,"once"],[53,19,47,25],[53,20,47,26],[53,34,47,40],[53,36,47,42],[53,48,47,54],[54,12,48,20,"debug"],[54,17,48,25],[54,18,48,26],[54,46,48,54],[54,47,48,55],[55,12,49,20],[55,14,49,22,"total"],[55,19,49,27],[55,23,49,31,"pause"],[55,28,49,36],[55,29,49,37],[55,30,49,38],[56,10,50,16],[56,11,50,17],[56,12,50,18],[57,8,51,12],[58,8,52,12],[58,12,52,16],[58,13,52,17],[58,17,52,21],[58,18,52,22,"writable"],[58,26,52,30],[58,28,52,32],[59,10,53,16,"debug"],[59,15,53,21],[59,16,53,22],[59,61,53,67],[59,62,53,68],[60,10,54,16,"total"],[60,15,54,21],[60,17,54,23],[61,10,55,16],[61,14,55,20],[61,15,55,21,"once"],[61,19,55,25],[61,20,55,26],[61,27,55,33],[61,29,55,35],[61,41,55,47],[62,12,56,20,"debug"],[62,17,56,25],[62,18,56,26],[62,46,56,54],[62,47,56,55],[63,12,57,20],[63,14,57,22,"total"],[63,19,57,27],[63,23,57,31,"pause"],[63,28,57,36],[63,29,57,37],[63,30,57,38],[64,10,58,16],[64,11,58,17],[64,12,58,18],[65,8,59,12],[66,6,60,8],[66,7,60,9],[66,13,61,13],[67,8,62,12,"pause"],[67,13,62,17],[67,14,62,18],[67,15,62,19],[68,6,63,8],[69,4,64,4],[70,4,65,4],[71,0,66,0],[72,0,67,0],[73,0,68,0],[74,0,69,0],[75,4,70,4,"_poll"],[75,9,70,9,"_poll"],[75,10,70,9],[75,12,70,12],[76,6,71,8,"debug"],[76,11,71,13],[76,12,71,14],[76,21,71,23],[76,22,71,24],[77,6,72,8],[77,10,72,12],[77,11,72,13,"_polling"],[77,19,72,21],[77,22,72,24],[77,26,72,28],[78,6,73,8],[78,10,73,12],[78,11,73,13,"doPoll"],[78,17,73,19],[78,18,73,20],[78,19,73,21],[79,6,74,8],[79,10,74,12],[79,11,74,13,"emitReserved"],[79,23,74,25],[79,24,74,26],[79,30,74,32],[79,31,74,33],[80,4,75,4],[81,4,76,4],[82,0,77,0],[83,0,78,0],[84,0,79,0],[85,0,80,0],[86,4,81,4,"onData"],[86,10,81,10,"onData"],[86,11,81,11,"data"],[86,15,81,15],[86,17,81,17],[87,6,82,8,"debug"],[87,11,82,13],[87,12,82,14],[87,33,82,35],[87,35,82,37,"data"],[87,39,82,41],[87,40,82,42],[88,6,83,8],[88,12,83,14,"callback"],[88,20,83,22],[88,23,83,26,"packet"],[88,29,83,32],[88,33,83,37],[89,8,84,12],[90,8,85,12],[90,12,85,16],[90,21,85,25],[90,26,85,30],[90,30,85,34],[90,31,85,35,"readyState"],[90,41,85,45],[90,45,85,49,"packet"],[90,51,85,55],[90,52,85,56,"type"],[90,56,85,60],[90,61,85,65],[90,67,85,71],[90,69,85,73],[91,10,86,16],[91,14,86,20],[91,15,86,21,"onOpen"],[91,21,86,27],[91,22,86,28],[91,23,86,29],[92,8,87,12],[93,8,88,12],[94,8,89,12],[94,12,89,16],[94,19,89,23],[94,24,89,28,"packet"],[94,30,89,34],[94,31,89,35,"type"],[94,35,89,39],[94,37,89,41],[95,10,90,16],[95,14,90,20],[95,15,90,21,"onClose"],[95,22,90,28],[95,23,90,29],[96,12,90,31,"description"],[96,23,90,42],[96,25,90,44],[97,10,90,77],[97,11,90,78],[97,12,90,79],[98,10,91,16],[98,17,91,23],[98,22,91,28],[99,8,92,12],[100,8,93,12],[101,8,94,12],[101,12,94,16],[101,13,94,17,"onPacket"],[101,21,94,25],[101,22,94,26,"packet"],[101,28,94,32],[101,29,94,33],[102,6,95,8],[102,7,95,9],[103,6,96,8],[104,6,97,8],[104,7,97,9],[104,8,97,10],[104,10,97,12,"engine_io_parser_1"],[104,28,97,30],[104,29,97,31,"decodePayload"],[104,42,97,44],[104,44,97,46,"data"],[104,48,97,50],[104,50,97,52],[104,54,97,56],[104,55,97,57,"socket"],[104,61,97,63],[104,62,97,64,"binaryType"],[104,72,97,74],[104,73,97,75],[104,74,97,76,"forEach"],[104,81,97,83],[104,82,97,84,"callback"],[104,90,97,92],[104,91,97,93],[105,6,98,8],[106,6,99,8],[106,10,99,12],[106,18,99,20],[106,23,99,25],[106,27,99,29],[106,28,99,30,"readyState"],[106,38,99,40],[106,40,99,42],[107,8,100,12],[108,8,101,12],[108,12,101,16],[108,13,101,17,"_polling"],[108,21,101,25],[108,24,101,28],[108,29,101,33],[109,8,102,12],[109,12,102,16],[109,13,102,17,"emitReserved"],[109,25,102,29],[109,26,102,30],[109,40,102,44],[109,41,102,45],[110,8,103,12],[110,12,103,16],[110,18,103,22],[110,23,103,27],[110,27,103,31],[110,28,103,32,"readyState"],[110,38,103,42],[110,40,103,44],[111,10,104,16],[111,14,104,20],[111,15,104,21,"_poll"],[111,20,104,26],[111,21,104,27],[111,22,104,28],[112,8,105,12],[112,9,105,13],[112,15,106,17],[113,10,107,16,"debug"],[113,15,107,21],[113,16,107,22],[113,54,107,60],[113,56,107,62],[113,60,107,66],[113,61,107,67,"readyState"],[113,71,107,77],[113,72,107,78],[114,8,108,12],[115,6,109,8],[116,4,110,4],[117,4,111,4],[118,0,112,0],[119,0,113,0],[120,0,114,0],[121,0,115,0],[122,4,116,4,"doClose"],[122,11,116,11,"doClose"],[122,12,116,11],[122,14,116,14],[123,6,117,8],[123,12,117,14,"close"],[123,17,117,19],[123,20,117,22,"close"],[123,21,117,22],[123,26,117,28],[124,8,118,12,"debug"],[124,13,118,17],[124,14,118,18],[124,36,118,40],[124,37,118,41],[125,8,119,12],[125,12,119,16],[125,13,119,17,"write"],[125,18,119,22],[125,19,119,23],[125,20,119,24],[126,10,119,26,"type"],[126,14,119,30],[126,16,119,32],[127,8,119,40],[127,9,119,41],[127,10,119,42],[127,11,119,43],[128,6,120,8],[128,7,120,9],[129,6,121,8],[129,10,121,12],[129,16,121,18],[129,21,121,23],[129,25,121,27],[129,26,121,28,"readyState"],[129,36,121,38],[129,38,121,40],[130,8,122,12,"debug"],[130,13,122,17],[130,14,122,18],[130,40,122,44],[130,41,122,45],[131,8,123,12,"close"],[131,13,123,17],[131,14,123,18],[131,15,123,19],[132,6,124,8],[132,7,124,9],[132,13,125,13],[133,8,126,12],[134,8,127,12],[135,8,128,12,"debug"],[135,13,128,17],[135,14,128,18],[135,52,128,56],[135,53,128,57],[136,8,129,12],[136,12,129,16],[136,13,129,17,"once"],[136,17,129,21],[136,18,129,22],[136,24,129,28],[136,26,129,30,"close"],[136,31,129,35],[136,32,129,36],[137,6,130,8],[138,4,131,4],[139,4,132,4],[140,0,133,0],[141,0,134,0],[142,0,135,0],[143,0,136,0],[144,0,137,0],[145,4,138,4,"write"],[145,9,138,9,"write"],[145,10,138,10,"packets"],[145,17,138,17],[145,19,138,19],[146,6,139,8],[146,10,139,12],[146,11,139,13,"writable"],[146,19,139,21],[146,22,139,24],[146,27,139,29],[147,6,140,8],[147,7,140,9],[147,8,140,10],[147,10,140,12,"engine_io_parser_1"],[147,28,140,30],[147,29,140,31,"encodePayload"],[147,42,140,44],[147,44,140,46,"packets"],[147,51,140,53],[147,53,140,56,"data"],[147,57,140,60],[147,61,140,65],[148,8,141,12],[148,12,141,16],[148,13,141,17,"doWrite"],[148,20,141,24],[148,21,141,25,"data"],[148,25,141,29],[148,27,141,31],[148,33,141,37],[149,10,142,16],[149,14,142,20],[149,15,142,21,"writable"],[149,23,142,29],[149,26,142,32],[149,30,142,36],[150,10,143,16],[150,14,143,20],[150,15,143,21,"emitReserved"],[150,27,143,33],[150,28,143,34],[150,35,143,41],[150,36,143,42],[151,8,144,12],[151,9,144,13],[151,10,144,14],[152,6,145,8],[152,7,145,9],[152,8,145,10],[153,4,146,4],[154,4,147,4],[155,0,148,0],[156,0,149,0],[157,0,150,0],[158,0,151,0],[159,4,152,4,"uri"],[159,7,152,7,"uri"],[159,8,152,7],[159,10,152,10],[160,6,153,8],[160,12,153,14,"schema"],[160,18,153,20],[160,21,153,23],[160,25,153,27],[160,26,153,28,"opts"],[160,30,153,32],[160,31,153,33,"secure"],[160,37,153,39],[160,40,153,42],[160,47,153,49],[160,50,153,52],[160,56,153,58],[161,6,154,8],[161,12,154,14,"query"],[161,17,154,19],[161,20,154,22],[161,24,154,26],[161,25,154,27,"query"],[161,30,154,32],[161,34,154,36],[161,35,154,37],[161,36,154,38],[162,6,155,8],[163,6,156,8],[163,10,156,12],[163,15,156,17],[163,20,156,22],[163,24,156,26],[163,25,156,27,"opts"],[163,29,156,31],[163,30,156,32,"timestampRequests"],[163,47,156,49],[163,49,156,51],[164,8,157,12,"query"],[164,13,157,17],[164,14,157,18],[164,18,157,22],[164,19,157,23,"opts"],[164,23,157,27],[164,24,157,28,"timestampParam"],[164,38,157,42],[164,39,157,43],[164,42,157,46],[164,43,157,47],[164,44,157,48],[164,46,157,50,"util_js_1"],[164,55,157,59],[164,56,157,60,"randomString"],[164,68,157,72],[164,70,157,74],[164,71,157,75],[165,6,158,8],[166,6,159,8],[166,10,159,12],[166,11,159,13],[166,15,159,17],[166,16,159,18,"supportsBinary"],[166,30,159,32],[166,34,159,36],[166,35,159,37,"query"],[166,40,159,42],[166,41,159,43,"sid"],[166,44,159,46],[166,46,159,48],[167,8,160,12,"query"],[167,13,160,17],[167,14,160,18,"b64"],[167,17,160,21],[167,20,160,24],[167,21,160,25],[168,6,161,8],[169,6,162,8],[169,13,162,15],[169,17,162,19],[169,18,162,20,"createUri"],[169,27,162,29],[169,28,162,30,"schema"],[169,34,162,36],[169,36,162,38,"query"],[169,41,162,43],[169,42,162,44],[170,4,163,4],[171,2,164,0],[172,2,165,0,"exports"],[172,9,165,7],[172,10,165,8,"Polling"],[172,17,165,15],[172,20,165,18,"Polling"],[172,27,165,25],[173,0,165,26],[173,3]],"functionMap":{"names":["<global>","<anonymous>","Polling","Polling#constructor","Polling#get__name","Polling#doOpen","Polling#pause","pause","once$argument_1","Polling#_poll","Polling#onData","callback","Polling#doClose","close","Polling#write","doWrite$argument_1","Polling#uri"],"mappings":"AAA;wDCC;CDE;AEQ;ICC;KDG;IEC;KFE;IGO;KHE;IIO;sBCE;SDI;0CEM;iBFG;mCEK;iBFG;KJM;IOM;KPK;IQM;yBCE;SDY;KRe;IUM;sBCC;SDG;KVW;IYO;uDbE;+BcC;adG;SaC;KZC;IcM;KdW;CFC"},"hasCjsExports":true},"type":"js/module"}]}