{"dependencies":[{"name":"./errors","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":15,"index":30},"end":{"line":3,"column":34,"index":49}}],"key":"GlkDztMSsNRYmp31iO+V/Albin8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  var _require = require(_dependencyMap[0], \"./errors\"),\n    NoVideoInputDevicesError = _require.NoVideoInputDevicesError;\n  function defaultDeviceIdChooser(filteredDevices, videoDevices, facingMode) {\n    if (filteredDevices.length > 0) {\n      return filteredDevices[0].deviceId;\n    }\n    if (videoDevices.length == 1 || facingMode == 'user') {\n      return videoDevices[0].deviceId;\n    }\n    return videoDevices[1].deviceId;\n  }\n  var getFacingModePattern = function getFacingModePattern(facingMode) {\n    return facingMode == 'environment' ? /rear|back|environment/ig : /front|user|face/ig;\n  };\n  function getDeviceId(facingMode) {\n    var chooseDeviceId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultDeviceIdChooser;\n\n    // Get manual deviceId from available devices.\n    return new Promise(function (resolve, reject) {\n      var enumerateDevices = void 0;\n      try {\n        enumerateDevices = navigator.mediaDevices.enumerateDevices();\n      } catch (err) {\n        reject(new NoVideoInputDevicesError());\n      }\n      enumerateDevices.then(function (devices) {\n        // Filter out non-videoinputs\n        var videoDevices = devices.filter(function (device) {\n          return device.kind == 'videoinput';\n        });\n        if (videoDevices.length < 1) {\n          reject(new NoVideoInputDevicesError());\n          return;\n        }\n        var pattern = getFacingModePattern(facingMode);\n\n        // Filter out video devices without the pattern\n        var filteredDevices = videoDevices.filter(function (_ref) {\n          var label = _ref.label;\n          return pattern.test(label);\n        });\n        resolve(chooseDeviceId(filteredDevices, videoDevices, facingMode));\n      });\n    });\n  }\n  module.exports = {\n    getDeviceId: getDeviceId,\n    getFacingModePattern: getFacingModePattern\n  };\n});","lineCount":53,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,6,3,4,"_require"],[4,14,3,12],[4,17,3,15,"require"],[4,24,3,22],[4,25,3,22,"_dependencyMap"],[4,39,3,22],[4,54,3,33],[4,55,3,34],[5,4,4,4,"NoVideoInputDevicesError"],[5,28,4,28],[5,31,4,31,"_require"],[5,39,4,39],[5,40,4,40,"NoVideoInputDevicesError"],[5,64,4,64],[6,2,6,0],[6,11,6,9,"defaultDeviceIdChooser"],[6,33,6,31,"defaultDeviceIdChooser"],[6,34,6,32,"filteredDevices"],[6,49,6,47],[6,51,6,49,"videoDevices"],[6,63,6,61],[6,65,6,63,"facingMode"],[6,75,6,73],[6,77,6,75],[7,4,7,2],[7,8,7,6,"filteredDevices"],[7,23,7,21],[7,24,7,22,"length"],[7,30,7,28],[7,33,7,31],[7,34,7,32],[7,36,7,34],[8,6,8,4],[8,13,8,11,"filteredDevices"],[8,28,8,26],[8,29,8,27],[8,30,8,28],[8,31,8,29],[8,32,8,30,"deviceId"],[8,40,8,38],[9,4,9,2],[10,4,10,2],[10,8,10,6,"videoDevices"],[10,20,10,18],[10,21,10,19,"length"],[10,27,10,25],[10,31,10,29],[10,32,10,30],[10,36,10,34,"facingMode"],[10,46,10,44],[10,50,10,48],[10,56,10,54],[10,58,10,56],[11,6,11,4],[11,13,11,11,"videoDevices"],[11,25,11,23],[11,26,11,24],[11,27,11,25],[11,28,11,26],[11,29,11,27,"deviceId"],[11,37,11,35],[12,4,12,2],[13,4,13,2],[13,11,13,9,"videoDevices"],[13,23,13,21],[13,24,13,22],[13,25,13,23],[13,26,13,24],[13,27,13,25,"deviceId"],[13,35,13,33],[14,2,14,0],[15,2,16,0],[15,6,16,4,"getFacingModePattern"],[15,26,16,24],[15,29,16,27],[15,38,16,36,"getFacingModePattern"],[15,58,16,56,"getFacingModePattern"],[15,59,16,57,"facingMode"],[15,69,16,67],[15,71,16,69],[16,4,17,2],[16,11,17,9,"facingMode"],[16,21,17,19],[16,25,17,23],[16,38,17,36],[16,41,17,39],[16,66,17,64],[16,69,17,67],[16,88,17,86],[17,2,18,0],[17,3,18,1],[18,2,20,0],[18,11,20,9,"getDeviceId"],[18,22,20,20,"getDeviceId"],[18,23,20,21,"facingMode"],[18,33,20,31],[18,35,20,33],[19,4,21,2],[19,8,21,6,"chooseDeviceId"],[19,22,21,20],[19,25,21,23,"arguments"],[19,34,21,32],[19,35,21,33,"length"],[19,41,21,39],[19,44,21,42],[19,45,21,43],[19,49,21,47,"arguments"],[19,58,21,56],[19,59,21,57],[19,60,21,58],[19,61,21,59],[19,66,21,64,"undefined"],[19,75,21,73],[19,78,21,76,"arguments"],[19,87,21,85],[19,88,21,86],[19,89,21,87],[19,90,21,88],[19,93,21,91,"defaultDeviceIdChooser"],[19,115,21,113],[21,4,23,2],[22,4,24,2],[22,11,24,9],[22,15,24,13,"Promise"],[22,22,24,20],[22,23,24,21],[22,33,24,31,"resolve"],[22,40,24,38],[22,42,24,40,"reject"],[22,48,24,46],[22,50,24,48],[23,6,25,4],[23,10,25,8,"enumerateDevices"],[23,26,25,24],[23,29,25,27],[23,34,25,32],[23,35,25,33],[24,6,26,4],[24,10,26,8],[25,8,27,6,"enumerateDevices"],[25,24,27,22],[25,27,27,25,"navigator"],[25,36,27,34],[25,37,27,35,"mediaDevices"],[25,49,27,47],[25,50,27,48,"enumerateDevices"],[25,66,27,64],[25,67,27,65],[25,68,27,66],[26,6,28,4],[26,7,28,5],[26,8,28,6],[26,15,28,13,"err"],[26,18,28,16],[26,20,28,18],[27,8,29,6,"reject"],[27,14,29,12],[27,15,29,13],[27,19,29,17,"NoVideoInputDevicesError"],[27,43,29,41],[27,44,29,42],[27,45,29,43],[27,46,29,44],[28,6,30,4],[29,6,31,4,"enumerateDevices"],[29,22,31,20],[29,23,31,21,"then"],[29,27,31,25],[29,28,31,26],[29,38,31,36,"devices"],[29,45,31,43],[29,47,31,45],[30,8,32,6],[31,8,33,6],[31,12,33,10,"videoDevices"],[31,24,33,22],[31,27,33,25,"devices"],[31,34,33,32],[31,35,33,33,"filter"],[31,41,33,39],[31,42,33,40],[31,52,33,50,"device"],[31,58,33,56],[31,60,33,58],[32,10,34,8],[32,17,34,15,"device"],[32,23,34,21],[32,24,34,22,"kind"],[32,28,34,26],[32,32,34,30],[32,44,34,42],[33,8,35,6],[33,9,35,7],[33,10,35,8],[34,8,37,6],[34,12,37,10,"videoDevices"],[34,24,37,22],[34,25,37,23,"length"],[34,31,37,29],[34,34,37,32],[34,35,37,33],[34,37,37,35],[35,10,38,8,"reject"],[35,16,38,14],[35,17,38,15],[35,21,38,19,"NoVideoInputDevicesError"],[35,45,38,43],[35,46,38,44],[35,47,38,45],[35,48,38,46],[36,10,39,8],[37,8,40,6],[38,8,42,6],[38,12,42,10,"pattern"],[38,19,42,17],[38,22,42,20,"getFacingModePattern"],[38,42,42,40],[38,43,42,41,"facingMode"],[38,53,42,51],[38,54,42,52],[40,8,44,6],[41,8,45,6],[41,12,45,10,"filteredDevices"],[41,27,45,25],[41,30,45,28,"videoDevices"],[41,42,45,40],[41,43,45,41,"filter"],[41,49,45,47],[41,50,45,48],[41,60,45,58,"_ref"],[41,64,45,62],[41,66,45,64],[42,10,46,8],[42,14,46,12,"label"],[42,19,46,17],[42,22,46,20,"_ref"],[42,26,46,24],[42,27,46,25,"label"],[42,32,46,30],[43,10,47,8],[43,17,47,15,"pattern"],[43,24,47,22],[43,25,47,23,"test"],[43,29,47,27],[43,30,47,28,"label"],[43,35,47,33],[43,36,47,34],[44,8,48,6],[44,9,48,7],[44,10,48,8],[45,8,50,6,"resolve"],[45,15,50,13],[45,16,50,14,"chooseDeviceId"],[45,30,50,28],[45,31,50,29,"filteredDevices"],[45,46,50,44],[45,48,50,46,"videoDevices"],[45,60,50,58],[45,62,50,60,"facingMode"],[45,72,50,70],[45,73,50,71],[45,74,50,72],[46,6,51,4],[46,7,51,5],[46,8,51,6],[47,4,52,2],[47,5,52,3],[47,6,52,4],[48,2,53,0],[49,2,55,0,"module"],[49,8,55,6],[49,9,55,7,"exports"],[49,16,55,14],[49,19,55,17],[50,4,55,19,"getDeviceId"],[50,15,55,30],[50,17,55,32,"getDeviceId"],[50,28,55,43],[51,4,55,45,"getFacingModePattern"],[51,24,55,65],[51,26,55,67,"getFacingModePattern"],[52,2,55,88],[52,3,55,89],[53,0,55,90],[53,3]],"functionMap":{"names":["<global>","defaultDeviceIdChooser","getFacingModePattern","getDeviceId","Promise$argument_0","enumerateDevices.then$argument_0","devices.filter$argument_0","videoDevices.filter$argument_0"],"mappings":"AAA;ACK;CDQ;2BEE;CFE;AGE;qBCI;0BCO;wCCE;ODE;gDEU;OFG;KDG;GDC;CHC"},"hasCjsExports":true},"type":"js/module"}]}