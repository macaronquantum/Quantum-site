{"dependencies":[{"name":"ethereum-cryptography/sha256.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":20,"index":247},"end":{"line":4,"column":62,"index":289}}],"key":"wLtcAjRr1x98XcWjkFlZ0mCUMfo=","exportNames":["*"],"imports":1}},{"name":"./bytes.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":19,"index":310},"end":{"line":5,"column":40,"index":331}}],"key":"eokoOkEvDYYQnD7pk9MNYe/uRJE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.commitmentsToVersionedHashes = exports.computeVersionedHash = exports.blobsToProofs = exports.blobsToCommitments = exports.getBlobs = void 0;\n  const sha256_js_1 = require(_dependencyMap[0], \"ethereum-cryptography/sha256.js\");\n  const bytes_js_1 = require(_dependencyMap[1], \"./bytes.js\");\n  /**\n   * These utilities for constructing blobs are borrowed from https://github.com/Inphi/eip4844-interop.git\n   */\n  const BYTES_PER_FIELD_ELEMENT = 32;\n  const FIELD_ELEMENTS_PER_BLOB = 4096;\n  const USEFUL_BYTES_PER_BLOB = 32 * FIELD_ELEMENTS_PER_BLOB;\n  const MAX_BLOBS_PER_TX = 2;\n  const MAX_USEFUL_BYTES_PER_TX = USEFUL_BYTES_PER_BLOB * MAX_BLOBS_PER_TX - 1;\n  const BLOB_SIZE = BYTES_PER_FIELD_ELEMENT * FIELD_ELEMENTS_PER_BLOB;\n  function get_padded(data, blobs_len) {\n    const pdata = new Uint8Array(blobs_len * USEFUL_BYTES_PER_BLOB).fill(0);\n    pdata.set(data);\n    pdata[data.byteLength] = 0x80;\n    return pdata;\n  }\n  function get_blob(data) {\n    const blob = new Uint8Array(BLOB_SIZE);\n    for (let i = 0; i < FIELD_ELEMENTS_PER_BLOB; i++) {\n      const chunk = new Uint8Array(32);\n      chunk.set(data.subarray(i * 31, (i + 1) * 31), 0);\n      blob.set(chunk, i * 32);\n    }\n    return blob;\n  }\n  const getBlobs = input => {\n    const data = (0, bytes_js_1.utf8ToBytes)(input);\n    const len = data.byteLength;\n    if (len === 0) {\n      throw Error('invalid blob data');\n    }\n    if (len > MAX_USEFUL_BYTES_PER_TX) {\n      throw Error('blob data is too large');\n    }\n    const blobs_len = Math.ceil(len / USEFUL_BYTES_PER_BLOB);\n    const pdata = get_padded(data, blobs_len);\n    const blobs = [];\n    for (let i = 0; i < blobs_len; i++) {\n      const chunk = pdata.subarray(i * USEFUL_BYTES_PER_BLOB, (i + 1) * USEFUL_BYTES_PER_BLOB);\n      const blob = get_blob(chunk);\n      blobs.push(blob);\n    }\n    return blobs;\n  };\n  exports.getBlobs = getBlobs;\n  const blobsToCommitments = (kzg, blobs) => {\n    const commitments = [];\n    for (const blob of blobs) {\n      commitments.push(kzg.blobToKzgCommitment(blob));\n    }\n    return commitments;\n  };\n  exports.blobsToCommitments = blobsToCommitments;\n  const blobsToProofs = (kzg, blobs, commitments) => {\n    const proofs = blobs.map((blob, ctx) => kzg.computeBlobKzgProof(blob, commitments[ctx]));\n    return proofs;\n  };\n  exports.blobsToProofs = blobsToProofs;\n  /**\n   * Converts a vector commitment for a given data blob to its versioned hash.  For 4844, this version\n   * number will be 0x01 for KZG vector commitments but could be different if future vector commitment\n   * types are introduced\n   * @param commitment a vector commitment to a blob\n   * @param blobCommitmentVersion the version number corresponding to the type of vector commitment\n   * @returns a versioned hash corresponding to a given blob vector commitment\n   */\n  const computeVersionedHash = (commitment, blobCommitmentVersion) => {\n    const computedVersionedHash = new Uint8Array(32);\n    computedVersionedHash.set([blobCommitmentVersion], 0);\n    computedVersionedHash.set((0, sha256_js_1.sha256)(commitment).subarray(1), 1);\n    return computedVersionedHash;\n  };\n  exports.computeVersionedHash = computeVersionedHash;\n  /**\n   * Generate an array of versioned hashes from corresponding kzg commitments\n   * @param commitments array of kzg commitments\n   * @returns array of versioned hashes\n   * Note: assumes KZG commitments (version 1 version hashes)\n   */\n  const commitmentsToVersionedHashes = commitments => {\n    const hashes = [];\n    for (const commitment of commitments) {\n      hashes.push((0, exports.computeVersionedHash)(commitment, 0x01));\n    }\n    return hashes;\n  };\n  exports.commitmentsToVersionedHashes = commitmentsToVersionedHashes;\n});","lineCount":96,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"commitmentsToVersionedHashes"],[7,38,3,36],[7,41,3,39,"exports"],[7,48,3,46],[7,49,3,47,"computeVersionedHash"],[7,69,3,67],[7,72,3,70,"exports"],[7,79,3,77],[7,80,3,78,"blobsToProofs"],[7,93,3,91],[7,96,3,94,"exports"],[7,103,3,101],[7,104,3,102,"blobsToCommitments"],[7,122,3,120],[7,125,3,123,"exports"],[7,132,3,130],[7,133,3,131,"getBlobs"],[7,141,3,139],[7,144,3,142],[7,149,3,147],[7,150,3,148],[8,2,4,0],[8,8,4,6,"sha256_js_1"],[8,19,4,17],[8,22,4,20,"require"],[8,29,4,27],[8,30,4,27,"_dependencyMap"],[8,44,4,27],[8,82,4,61],[8,83,4,62],[9,2,5,0],[9,8,5,6,"bytes_js_1"],[9,18,5,16],[9,21,5,19,"require"],[9,28,5,26],[9,29,5,26,"_dependencyMap"],[9,43,5,26],[9,60,5,39],[9,61,5,40],[10,2,6,0],[11,0,7,0],[12,0,8,0],[13,2,9,0],[13,8,9,6,"BYTES_PER_FIELD_ELEMENT"],[13,31,9,29],[13,34,9,32],[13,36,9,34],[14,2,10,0],[14,8,10,6,"FIELD_ELEMENTS_PER_BLOB"],[14,31,10,29],[14,34,10,32],[14,38,10,36],[15,2,11,0],[15,8,11,6,"USEFUL_BYTES_PER_BLOB"],[15,29,11,27],[15,32,11,30],[15,34,11,32],[15,37,11,35,"FIELD_ELEMENTS_PER_BLOB"],[15,60,11,58],[16,2,12,0],[16,8,12,6,"MAX_BLOBS_PER_TX"],[16,24,12,22],[16,27,12,25],[16,28,12,26],[17,2,13,0],[17,8,13,6,"MAX_USEFUL_BYTES_PER_TX"],[17,31,13,29],[17,34,13,32,"USEFUL_BYTES_PER_BLOB"],[17,55,13,53],[17,58,13,56,"MAX_BLOBS_PER_TX"],[17,74,13,72],[17,77,13,75],[17,78,13,76],[18,2,14,0],[18,8,14,6,"BLOB_SIZE"],[18,17,14,15],[18,20,14,18,"BYTES_PER_FIELD_ELEMENT"],[18,43,14,41],[18,46,14,44,"FIELD_ELEMENTS_PER_BLOB"],[18,69,14,67],[19,2,15,0],[19,11,15,9,"get_padded"],[19,21,15,19,"get_padded"],[19,22,15,20,"data"],[19,26,15,24],[19,28,15,26,"blobs_len"],[19,37,15,35],[19,39,15,37],[20,4,16,4],[20,10,16,10,"pdata"],[20,15,16,15],[20,18,16,18],[20,22,16,22,"Uint8Array"],[20,32,16,32],[20,33,16,33,"blobs_len"],[20,42,16,42],[20,45,16,45,"USEFUL_BYTES_PER_BLOB"],[20,66,16,66],[20,67,16,67],[20,68,16,68,"fill"],[20,72,16,72],[20,73,16,73],[20,74,16,74],[20,75,16,75],[21,4,17,4,"pdata"],[21,9,17,9],[21,10,17,10,"set"],[21,13,17,13],[21,14,17,14,"data"],[21,18,17,18],[21,19,17,19],[22,4,18,4,"pdata"],[22,9,18,9],[22,10,18,10,"data"],[22,14,18,14],[22,15,18,15,"byteLength"],[22,25,18,25],[22,26,18,26],[22,29,18,29],[22,33,18,33],[23,4,19,4],[23,11,19,11,"pdata"],[23,16,19,16],[24,2,20,0],[25,2,21,0],[25,11,21,9,"get_blob"],[25,19,21,17,"get_blob"],[25,20,21,18,"data"],[25,24,21,22],[25,26,21,24],[26,4,22,4],[26,10,22,10,"blob"],[26,14,22,14],[26,17,22,17],[26,21,22,21,"Uint8Array"],[26,31,22,31],[26,32,22,32,"BLOB_SIZE"],[26,41,22,41],[26,42,22,42],[27,4,23,4],[27,9,23,9],[27,13,23,13,"i"],[27,14,23,14],[27,17,23,17],[27,18,23,18],[27,20,23,20,"i"],[27,21,23,21],[27,24,23,24,"FIELD_ELEMENTS_PER_BLOB"],[27,47,23,47],[27,49,23,49,"i"],[27,50,23,50],[27,52,23,52],[27,54,23,54],[28,6,24,8],[28,12,24,14,"chunk"],[28,17,24,19],[28,20,24,22],[28,24,24,26,"Uint8Array"],[28,34,24,36],[28,35,24,37],[28,37,24,39],[28,38,24,40],[29,6,25,8,"chunk"],[29,11,25,13],[29,12,25,14,"set"],[29,15,25,17],[29,16,25,18,"data"],[29,20,25,22],[29,21,25,23,"subarray"],[29,29,25,31],[29,30,25,32,"i"],[29,31,25,33],[29,34,25,36],[29,36,25,38],[29,38,25,40],[29,39,25,41,"i"],[29,40,25,42],[29,43,25,45],[29,44,25,46],[29,48,25,50],[29,50,25,52],[29,51,25,53],[29,53,25,55],[29,54,25,56],[29,55,25,57],[30,6,26,8,"blob"],[30,10,26,12],[30,11,26,13,"set"],[30,14,26,16],[30,15,26,17,"chunk"],[30,20,26,22],[30,22,26,24,"i"],[30,23,26,25],[30,26,26,28],[30,28,26,30],[30,29,26,31],[31,4,27,4],[32,4,28,4],[32,11,28,11,"blob"],[32,15,28,15],[33,2,29,0],[34,2,30,0],[34,8,30,6,"getBlobs"],[34,16,30,14],[34,19,30,18,"input"],[34,24,30,23],[34,28,30,28],[35,4,31,4],[35,10,31,10,"data"],[35,14,31,14],[35,17,31,17],[35,18,31,18],[35,19,31,19],[35,21,31,21,"bytes_js_1"],[35,31,31,31],[35,32,31,32,"utf8ToBytes"],[35,43,31,43],[35,45,31,45,"input"],[35,50,31,50],[35,51,31,51],[36,4,32,4],[36,10,32,10,"len"],[36,13,32,13],[36,16,32,16,"data"],[36,20,32,20],[36,21,32,21,"byteLength"],[36,31,32,31],[37,4,33,4],[37,8,33,8,"len"],[37,11,33,11],[37,16,33,16],[37,17,33,17],[37,19,33,19],[38,6,34,8],[38,12,34,14,"Error"],[38,17,34,19],[38,18,34,20],[38,37,34,39],[38,38,34,40],[39,4,35,4],[40,4,36,4],[40,8,36,8,"len"],[40,11,36,11],[40,14,36,14,"MAX_USEFUL_BYTES_PER_TX"],[40,37,36,37],[40,39,36,39],[41,6,37,8],[41,12,37,14,"Error"],[41,17,37,19],[41,18,37,20],[41,42,37,44],[41,43,37,45],[42,4,38,4],[43,4,39,4],[43,10,39,10,"blobs_len"],[43,19,39,19],[43,22,39,22,"Math"],[43,26,39,26],[43,27,39,27,"ceil"],[43,31,39,31],[43,32,39,32,"len"],[43,35,39,35],[43,38,39,38,"USEFUL_BYTES_PER_BLOB"],[43,59,39,59],[43,60,39,60],[44,4,40,4],[44,10,40,10,"pdata"],[44,15,40,15],[44,18,40,18,"get_padded"],[44,28,40,28],[44,29,40,29,"data"],[44,33,40,33],[44,35,40,35,"blobs_len"],[44,44,40,44],[44,45,40,45],[45,4,41,4],[45,10,41,10,"blobs"],[45,15,41,15],[45,18,41,18],[45,20,41,20],[46,4,42,4],[46,9,42,9],[46,13,42,13,"i"],[46,14,42,14],[46,17,42,17],[46,18,42,18],[46,20,42,20,"i"],[46,21,42,21],[46,24,42,24,"blobs_len"],[46,33,42,33],[46,35,42,35,"i"],[46,36,42,36],[46,38,42,38],[46,40,42,40],[47,6,43,8],[47,12,43,14,"chunk"],[47,17,43,19],[47,20,43,22,"pdata"],[47,25,43,27],[47,26,43,28,"subarray"],[47,34,43,36],[47,35,43,37,"i"],[47,36,43,38],[47,39,43,41,"USEFUL_BYTES_PER_BLOB"],[47,60,43,62],[47,62,43,64],[47,63,43,65,"i"],[47,64,43,66],[47,67,43,69],[47,68,43,70],[47,72,43,74,"USEFUL_BYTES_PER_BLOB"],[47,93,43,95],[47,94,43,96],[48,6,44,8],[48,12,44,14,"blob"],[48,16,44,18],[48,19,44,21,"get_blob"],[48,27,44,29],[48,28,44,30,"chunk"],[48,33,44,35],[48,34,44,36],[49,6,45,8,"blobs"],[49,11,45,13],[49,12,45,14,"push"],[49,16,45,18],[49,17,45,19,"blob"],[49,21,45,23],[49,22,45,24],[50,4,46,4],[51,4,47,4],[51,11,47,11,"blobs"],[51,16,47,16],[52,2,48,0],[52,3,48,1],[53,2,49,0,"exports"],[53,9,49,7],[53,10,49,8,"getBlobs"],[53,18,49,16],[53,21,49,19,"getBlobs"],[53,29,49,27],[54,2,50,0],[54,8,50,6,"blobsToCommitments"],[54,26,50,24],[54,29,50,27,"blobsToCommitments"],[54,30,50,28,"kzg"],[54,33,50,31],[54,35,50,33,"blobs"],[54,40,50,38],[54,45,50,43],[55,4,51,4],[55,10,51,10,"commitments"],[55,21,51,21],[55,24,51,24],[55,26,51,26],[56,4,52,4],[56,9,52,9],[56,15,52,15,"blob"],[56,19,52,19],[56,23,52,23,"blobs"],[56,28,52,28],[56,30,52,30],[57,6,53,8,"commitments"],[57,17,53,19],[57,18,53,20,"push"],[57,22,53,24],[57,23,53,25,"kzg"],[57,26,53,28],[57,27,53,29,"blobToKzgCommitment"],[57,46,53,48],[57,47,53,49,"blob"],[57,51,53,53],[57,52,53,54],[57,53,53,55],[58,4,54,4],[59,4,55,4],[59,11,55,11,"commitments"],[59,22,55,22],[60,2,56,0],[60,3,56,1],[61,2,57,0,"exports"],[61,9,57,7],[61,10,57,8,"blobsToCommitments"],[61,28,57,26],[61,31,57,29,"blobsToCommitments"],[61,49,57,47],[62,2,58,0],[62,8,58,6,"blobsToProofs"],[62,21,58,19],[62,24,58,22,"blobsToProofs"],[62,25,58,23,"kzg"],[62,28,58,26],[62,30,58,28,"blobs"],[62,35,58,33],[62,37,58,35,"commitments"],[62,48,58,46],[62,53,58,51],[63,4,59,4],[63,10,59,10,"proofs"],[63,16,59,16],[63,19,59,19,"blobs"],[63,24,59,24],[63,25,59,25,"map"],[63,28,59,28],[63,29,59,29],[63,30,59,30,"blob"],[63,34,59,34],[63,36,59,36,"ctx"],[63,39,59,39],[63,44,59,44,"kzg"],[63,47,59,47],[63,48,59,48,"computeBlobKzgProof"],[63,67,59,67],[63,68,59,68,"blob"],[63,72,59,72],[63,74,59,74,"commitments"],[63,85,59,85],[63,86,59,86,"ctx"],[63,89,59,89],[63,90,59,90],[63,91,59,91],[63,92,59,92],[64,4,60,4],[64,11,60,11,"proofs"],[64,17,60,17],[65,2,61,0],[65,3,61,1],[66,2,62,0,"exports"],[66,9,62,7],[66,10,62,8,"blobsToProofs"],[66,23,62,21],[66,26,62,24,"blobsToProofs"],[66,39,62,37],[67,2,63,0],[68,0,64,0],[69,0,65,0],[70,0,66,0],[71,0,67,0],[72,0,68,0],[73,0,69,0],[74,0,70,0],[75,2,71,0],[75,8,71,6,"computeVersionedHash"],[75,28,71,26],[75,31,71,29,"computeVersionedHash"],[75,32,71,30,"commitment"],[75,42,71,40],[75,44,71,42,"blobCommitmentVersion"],[75,65,71,63],[75,70,71,68],[76,4,72,4],[76,10,72,10,"computedVersionedHash"],[76,31,72,31],[76,34,72,34],[76,38,72,38,"Uint8Array"],[76,48,72,48],[76,49,72,49],[76,51,72,51],[76,52,72,52],[77,4,73,4,"computedVersionedHash"],[77,25,73,25],[77,26,73,26,"set"],[77,29,73,29],[77,30,73,30],[77,31,73,31,"blobCommitmentVersion"],[77,52,73,52],[77,53,73,53],[77,55,73,55],[77,56,73,56],[77,57,73,57],[78,4,74,4,"computedVersionedHash"],[78,25,74,25],[78,26,74,26,"set"],[78,29,74,29],[78,30,74,30],[78,31,74,31],[78,32,74,32],[78,34,74,34,"sha256_js_1"],[78,45,74,45],[78,46,74,46,"sha256"],[78,52,74,52],[78,54,74,54,"commitment"],[78,64,74,64],[78,65,74,65],[78,66,74,66,"subarray"],[78,74,74,74],[78,75,74,75],[78,76,74,76],[78,77,74,77],[78,79,74,79],[78,80,74,80],[78,81,74,81],[79,4,75,4],[79,11,75,11,"computedVersionedHash"],[79,32,75,32],[80,2,76,0],[80,3,76,1],[81,2,77,0,"exports"],[81,9,77,7],[81,10,77,8,"computeVersionedHash"],[81,30,77,28],[81,33,77,31,"computeVersionedHash"],[81,53,77,51],[82,2,78,0],[83,0,79,0],[84,0,80,0],[85,0,81,0],[86,0,82,0],[87,0,83,0],[88,2,84,0],[88,8,84,6,"commitmentsToVersionedHashes"],[88,36,84,34],[88,39,84,38,"commitments"],[88,50,84,49],[88,54,84,54],[89,4,85,4],[89,10,85,10,"hashes"],[89,16,85,16],[89,19,85,19],[89,21,85,21],[90,4,86,4],[90,9,86,9],[90,15,86,15,"commitment"],[90,25,86,25],[90,29,86,29,"commitments"],[90,40,86,40],[90,42,86,42],[91,6,87,8,"hashes"],[91,12,87,14],[91,13,87,15,"push"],[91,17,87,19],[91,18,87,20],[91,19,87,21],[91,20,87,22],[91,22,87,24,"exports"],[91,29,87,31],[91,30,87,32,"computeVersionedHash"],[91,50,87,52],[91,52,87,54,"commitment"],[91,62,87,64],[91,64,87,66],[91,68,87,70],[91,69,87,71],[91,70,87,72],[92,4,88,4],[93,4,89,4],[93,11,89,11,"hashes"],[93,17,89,17],[94,2,90,0],[94,3,90,1],[95,2,91,0,"exports"],[95,9,91,7],[95,10,91,8,"commitmentsToVersionedHashes"],[95,38,91,36],[95,41,91,39,"commitmentsToVersionedHashes"],[95,69,91,67],[96,0,91,68],[96,3]],"functionMap":{"names":["<global>","get_padded","get_blob","getBlobs","blobsToCommitments","blobsToProofs","map$argument_0","computeVersionedHash","commitmentsToVersionedHashes"],"mappings":"AAA;ACc;CDK;AEC;CFQ;iBGC;CHkB;2BIE;CJM;sBKE;6BCC,8DD;CLE;6BOU;CPK;qCQQ;CRM"},"hasCjsExports":true},"type":"js/module"}]}