{"dependencies":[{"name":"../wait.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":18,"index":126},"end":{"line":4,"column":39,"index":147}}],"key":"bGo/3hvDEn1t2zADQ+yKWGfh7UI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.withRetry = withRetry;\n  const wait_js_1 = require(_dependencyMap[0], \"../wait.js\");\n  function withRetry(fn, {\n    delay: delay_ = 100,\n    retryCount = 2,\n    shouldRetry = () => true\n  } = {}) {\n    return new Promise((resolve, reject) => {\n      const attemptRetry = async ({\n        count = 0\n      } = {}) => {\n        const retry = async ({\n          error\n        }) => {\n          const delay = typeof delay_ === 'function' ? delay_({\n            count,\n            error\n          }) : delay_;\n          if (delay) await (0, wait_js_1.wait)(delay);\n          attemptRetry({\n            count: count + 1\n          });\n        };\n        try {\n          const data = await fn();\n          resolve(data);\n        } catch (err) {\n          if (count < retryCount && (await shouldRetry({\n            count,\n            error: err\n          }))) return retry({\n            error: err\n          });\n          reject(err);\n        }\n      };\n      attemptRetry();\n    });\n  }\n});","lineCount":46,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"withRetry"],[7,19,3,17],[7,22,3,20,"withRetry"],[7,31,3,29],[8,2,4,0],[8,8,4,6,"wait_js_1"],[8,17,4,15],[8,20,4,18,"require"],[8,27,4,25],[8,28,4,25,"_dependencyMap"],[8,42,4,25],[8,59,4,38],[8,60,4,39],[9,2,5,0],[9,11,5,9,"withRetry"],[9,20,5,18,"withRetry"],[9,21,5,19,"fn"],[9,23,5,21],[9,25,5,23],[10,4,5,25,"delay"],[10,9,5,30],[10,11,5,32,"delay_"],[10,17,5,38],[10,20,5,41],[10,23,5,44],[11,4,5,46,"retryCount"],[11,14,5,56],[11,17,5,59],[11,18,5,60],[12,4,5,62,"shouldRetry"],[12,15,5,73],[12,18,5,76,"shouldRetry"],[12,19,5,76],[12,24,5,82],[13,2,5,88],[13,3,5,89],[13,6,5,92],[13,7,5,93],[13,8,5,94],[13,10,5,96],[14,4,6,4],[14,11,6,11],[14,15,6,15,"Promise"],[14,22,6,22],[14,23,6,23],[14,24,6,24,"resolve"],[14,31,6,31],[14,33,6,33,"reject"],[14,39,6,39],[14,44,6,44],[15,6,7,8],[15,12,7,14,"attemptRetry"],[15,24,7,26],[15,27,7,29],[15,33,7,29,"attemptRetry"],[15,34,7,36],[16,8,7,38,"count"],[16,13,7,43],[16,16,7,46],[17,6,7,48],[17,7,7,49],[17,10,7,52],[17,11,7,53],[17,12,7,54],[17,17,7,59],[18,8,8,12],[18,14,8,18,"retry"],[18,19,8,23],[18,22,8,26],[18,28,8,26,"retry"],[18,29,8,33],[19,10,8,35,"error"],[20,8,8,41],[20,9,8,42],[20,14,8,47],[21,10,9,16],[21,16,9,22,"delay"],[21,21,9,27],[21,24,9,30],[21,31,9,37,"delay_"],[21,37,9,43],[21,42,9,48],[21,52,9,58],[21,55,9,61,"delay_"],[21,61,9,67],[21,62,9,68],[22,12,9,70,"count"],[22,17,9,75],[23,12,9,77,"error"],[24,10,9,83],[24,11,9,84],[24,12,9,85],[24,15,9,88,"delay_"],[24,21,9,94],[25,10,10,16],[25,14,10,20,"delay"],[25,19,10,25],[25,21,11,20],[25,27,11,26],[25,28,11,27],[25,29,11,28],[25,31,11,30,"wait_js_1"],[25,40,11,39],[25,41,11,40,"wait"],[25,45,11,44],[25,47,11,46,"delay"],[25,52,11,51],[25,53,11,52],[26,10,12,16,"attemptRetry"],[26,22,12,28],[26,23,12,29],[27,12,12,31,"count"],[27,17,12,36],[27,19,12,38,"count"],[27,24,12,43],[27,27,12,46],[28,10,12,48],[28,11,12,49],[28,12,12,50],[29,8,13,12],[29,9,13,13],[30,8,14,12],[30,12,14,16],[31,10,15,16],[31,16,15,22,"data"],[31,20,15,26],[31,23,15,29],[31,29,15,35,"fn"],[31,31,15,37],[31,32,15,38],[31,33,15,39],[32,10,16,16,"resolve"],[32,17,16,23],[32,18,16,24,"data"],[32,22,16,28],[32,23,16,29],[33,8,17,12],[33,9,17,13],[33,10,18,12],[33,17,18,19,"err"],[33,20,18,22],[33,22,18,24],[34,10,19,16],[34,14,19,20,"count"],[34,19,19,25],[34,22,19,28,"retryCount"],[34,32,19,38],[34,37,20,21],[34,43,20,27,"shouldRetry"],[34,54,20,38],[34,55,20,39],[35,12,20,41,"count"],[35,17,20,46],[36,12,20,48,"error"],[36,17,20,53],[36,19,20,55,"err"],[37,10,20,59],[37,11,20,60],[37,12,20,61],[37,13,20,62],[37,15,21,20],[37,22,21,27,"retry"],[37,27,21,32],[37,28,21,33],[38,12,21,35,"error"],[38,17,21,40],[38,19,21,42,"err"],[39,10,21,46],[39,11,21,47],[39,12,21,48],[40,10,22,16,"reject"],[40,16,22,22],[40,17,22,23,"err"],[40,20,22,26],[40,21,22,27],[41,8,23,12],[42,6,24,8],[42,7,24,9],[43,6,25,8,"attemptRetry"],[43,18,25,20],[43,19,25,21],[43,20,25,22],[44,4,26,4],[44,5,26,5],[44,6,26,6],[45,2,27,0],[46,0,27,1],[46,3]],"functionMap":{"names":["<global>","withRetry","<anonymous>","Promise$argument_0","attemptRetry","retry"],"mappings":"AAA;ACI,4EC,UD;uBEC;6BCC;0BCC;aDK;SDW;KFE;CDC"},"hasCjsExports":true},"type":"js/module"}]}