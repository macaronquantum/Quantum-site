{"dependencies":[{"name":"./utils","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":16,"index":307},"end":{"line":7,"column":34,"index":325}}],"key":"Arg6QRuIuy5D/jfcnxX1qJiHjX8=","exportNames":["*"],"imports":1}},{"name":"./xoshiro","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":34,"index":361},"end":{"line":8,"column":54,"index":381}}],"key":"gJjAthOmYHL+W2nNQVdKltOAM2s=","exportNames":["*"],"imports":1}},{"name":"@keystonehq/alias-sampling","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":9,"column":41,"index":425},"end":{"line":9,"column":78,"index":462}}],"key":"1H1VMp55CsoqF6YV5dTB7CuKAm4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var __importDefault = this && this.__importDefault || function (mod) {\n    return mod && mod.__esModule ? mod : {\n      \"default\": mod\n    };\n  };\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.chooseFragments = exports.shuffle = exports.chooseDegree = void 0;\n  const utils_1 = require(_dependencyMap[0], \"./utils\");\n  const xoshiro_1 = __importDefault(require(_dependencyMap[1], \"./xoshiro\"));\n  const alias_sampling_1 = __importDefault(require(_dependencyMap[2], \"@keystonehq/alias-sampling\"));\n  const chooseDegree = (seqLenth, rng) => {\n    const degreeProbabilities = [...new Array(seqLenth)].map((_, index) => 1 / (index + 1));\n    const degreeChooser = alias_sampling_1.default(degreeProbabilities, undefined, rng.nextDouble);\n    return degreeChooser.next() + 1;\n  };\n  exports.chooseDegree = chooseDegree;\n  const shuffle = (items, rng) => {\n    let remaining = [...items];\n    let result = [];\n    while (remaining.length > 0) {\n      let index = rng.nextInt(0, remaining.length - 1);\n      let item = remaining[index];\n      // remaining.erase(remaining.begin() + index);\n      remaining.splice(index, 1);\n      result.push(item);\n    }\n    return result;\n  };\n  exports.shuffle = shuffle;\n  const chooseFragments = (seqNum, seqLength, checksum) => {\n    // The first `seqLenth` parts are the \"pure\" fragments, not mixed with any\n    // others. This means that if you only generate the first `seqLenth` parts,\n    // then you have all the parts you need to decode the message.\n    if (seqNum <= seqLength) {\n      return [seqNum - 1];\n    } else {\n      const seed = Buffer.concat([utils_1.intToBytes(seqNum), utils_1.intToBytes(checksum)]);\n      const rng = new xoshiro_1.default(seed);\n      const degree = exports.chooseDegree(seqLength, rng);\n      const indexes = [...new Array(seqLength)].map((_, index) => index);\n      const shuffledIndexes = exports.shuffle(indexes, rng);\n      return shuffledIndexes.slice(0, degree);\n    }\n  };\n  exports.chooseFragments = chooseFragments;\n});","lineCount":51,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0],[4,6,2,4,"__importDefault"],[4,21,2,19],[4,24,2,23],[4,28,2,27],[4,32,2,31],[4,36,2,35],[4,37,2,36,"__importDefault"],[4,52,2,51],[4,56,2,56],[4,66,2,66,"mod"],[4,69,2,69],[4,71,2,71],[5,4,3,4],[5,11,3,12,"mod"],[5,14,3,15],[5,18,3,19,"mod"],[5,21,3,22],[5,22,3,23,"__esModule"],[5,32,3,33],[5,35,3,37,"mod"],[5,38,3,40],[5,41,3,43],[6,6,3,45],[6,15,3,54],[6,17,3,56,"mod"],[7,4,3,60],[7,5,3,61],[8,2,4,0],[8,3,4,1],[9,2,5,0,"Object"],[9,8,5,6],[9,9,5,7,"defineProperty"],[9,23,5,21],[9,24,5,22,"exports"],[9,31,5,29],[9,33,5,31],[9,45,5,43],[9,47,5,45],[10,4,5,47,"value"],[10,9,5,52],[10,11,5,54],[11,2,5,59],[11,3,5,60],[11,4,5,61],[12,2,6,0,"exports"],[12,9,6,7],[12,10,6,8,"chooseFragments"],[12,25,6,23],[12,28,6,26,"exports"],[12,35,6,33],[12,36,6,34,"shuffle"],[12,43,6,41],[12,46,6,44,"exports"],[12,53,6,51],[12,54,6,52,"chooseDegree"],[12,66,6,64],[12,69,6,67],[12,74,6,72],[12,75,6,73],[13,2,7,0],[13,8,7,6,"utils_1"],[13,15,7,13],[13,18,7,16,"require"],[13,25,7,23],[13,26,7,23,"_dependencyMap"],[13,40,7,23],[13,54,7,33],[13,55,7,34],[14,2,8,0],[14,8,8,6,"xoshiro_1"],[14,17,8,15],[14,20,8,18,"__importDefault"],[14,35,8,33],[14,36,8,34,"require"],[14,43,8,41],[14,44,8,41,"_dependencyMap"],[14,58,8,41],[14,74,8,53],[14,75,8,54],[14,76,8,55],[15,2,9,0],[15,8,9,6,"alias_sampling_1"],[15,24,9,22],[15,27,9,25,"__importDefault"],[15,42,9,40],[15,43,9,41,"require"],[15,50,9,48],[15,51,9,48,"_dependencyMap"],[15,65,9,48],[15,98,9,77],[15,99,9,78],[15,100,9,79],[16,2,10,0],[16,8,10,6,"chooseDegree"],[16,20,10,18],[16,23,10,21,"chooseDegree"],[16,24,10,22,"seqLenth"],[16,32,10,30],[16,34,10,32,"rng"],[16,37,10,35],[16,42,10,40],[17,4,11,4],[17,10,11,10,"degreeProbabilities"],[17,29,11,29],[17,32,11,32],[17,33,11,33],[17,36,11,36],[17,40,11,40,"Array"],[17,45,11,45],[17,46,11,46,"seqLenth"],[17,54,11,54],[17,55,11,55],[17,56,11,56],[17,57,11,57,"map"],[17,60,11,60],[17,61,11,61],[17,62,11,62,"_"],[17,63,11,63],[17,65,11,65,"index"],[17,70,11,70],[17,75,11,75],[17,76,11,76],[17,80,11,80,"index"],[17,85,11,85],[17,88,11,88],[17,89,11,89],[17,90,11,90],[17,91,11,91],[18,4,12,4],[18,10,12,10,"degreeChooser"],[18,23,12,23],[18,26,12,26,"alias_sampling_1"],[18,42,12,42],[18,43,12,43,"default"],[18,50,12,50],[18,51,12,51,"degreeProbabilities"],[18,70,12,70],[18,72,12,72,"undefined"],[18,81,12,81],[18,83,12,83,"rng"],[18,86,12,86],[18,87,12,87,"nextDouble"],[18,97,12,97],[18,98,12,98],[19,4,13,4],[19,11,13,11,"degreeChooser"],[19,24,13,24],[19,25,13,25,"next"],[19,29,13,29],[19,30,13,30],[19,31,13,31],[19,34,13,34],[19,35,13,35],[20,2,14,0],[20,3,14,1],[21,2,15,0,"exports"],[21,9,15,7],[21,10,15,8,"chooseDegree"],[21,22,15,20],[21,25,15,23,"chooseDegree"],[21,37,15,35],[22,2,16,0],[22,8,16,6,"shuffle"],[22,15,16,13],[22,18,16,16,"shuffle"],[22,19,16,17,"items"],[22,24,16,22],[22,26,16,24,"rng"],[22,29,16,27],[22,34,16,32],[23,4,17,4],[23,8,17,8,"remaining"],[23,17,17,17],[23,20,17,20],[23,21,17,21],[23,24,17,24,"items"],[23,29,17,29],[23,30,17,30],[24,4,18,4],[24,8,18,8,"result"],[24,14,18,14],[24,17,18,17],[24,19,18,19],[25,4,19,4],[25,11,19,11,"remaining"],[25,20,19,20],[25,21,19,21,"length"],[25,27,19,27],[25,30,19,30],[25,31,19,31],[25,33,19,33],[26,6,20,8],[26,10,20,12,"index"],[26,15,20,17],[26,18,20,20,"rng"],[26,21,20,23],[26,22,20,24,"nextInt"],[26,29,20,31],[26,30,20,32],[26,31,20,33],[26,33,20,35,"remaining"],[26,42,20,44],[26,43,20,45,"length"],[26,49,20,51],[26,52,20,54],[26,53,20,55],[26,54,20,56],[27,6,21,8],[27,10,21,12,"item"],[27,14,21,16],[27,17,21,19,"remaining"],[27,26,21,28],[27,27,21,29,"index"],[27,32,21,34],[27,33,21,35],[28,6,22,8],[29,6,23,8,"remaining"],[29,15,23,17],[29,16,23,18,"splice"],[29,22,23,24],[29,23,23,25,"index"],[29,28,23,30],[29,30,23,32],[29,31,23,33],[29,32,23,34],[30,6,24,8,"result"],[30,12,24,14],[30,13,24,15,"push"],[30,17,24,19],[30,18,24,20,"item"],[30,22,24,24],[30,23,24,25],[31,4,25,4],[32,4,26,4],[32,11,26,11,"result"],[32,17,26,17],[33,2,27,0],[33,3,27,1],[34,2,28,0,"exports"],[34,9,28,7],[34,10,28,8,"shuffle"],[34,17,28,15],[34,20,28,18,"shuffle"],[34,27,28,25],[35,2,29,0],[35,8,29,6,"chooseFragments"],[35,23,29,21],[35,26,29,24,"chooseFragments"],[35,27,29,25,"seqNum"],[35,33,29,31],[35,35,29,33,"seqLength"],[35,44,29,42],[35,46,29,44,"checksum"],[35,54,29,52],[35,59,29,57],[36,4,30,4],[37,4,31,4],[38,4,32,4],[39,4,33,4],[39,8,33,8,"seqNum"],[39,14,33,14],[39,18,33,18,"seqLength"],[39,27,33,27],[39,29,33,29],[40,6,34,8],[40,13,34,15],[40,14,34,16,"seqNum"],[40,20,34,22],[40,23,34,25],[40,24,34,26],[40,25,34,27],[41,4,35,4],[41,5,35,5],[41,11,36,9],[42,6,37,8],[42,12,37,14,"seed"],[42,16,37,18],[42,19,37,21,"Buffer"],[42,25,37,27],[42,26,37,28,"concat"],[42,32,37,34],[42,33,37,35],[42,34,37,36,"utils_1"],[42,41,37,43],[42,42,37,44,"intToBytes"],[42,52,37,54],[42,53,37,55,"seqNum"],[42,59,37,61],[42,60,37,62],[42,62,37,64,"utils_1"],[42,69,37,71],[42,70,37,72,"intToBytes"],[42,80,37,82],[42,81,37,83,"checksum"],[42,89,37,91],[42,90,37,92],[42,91,37,93],[42,92,37,94],[43,6,38,8],[43,12,38,14,"rng"],[43,15,38,17],[43,18,38,20],[43,22,38,24,"xoshiro_1"],[43,31,38,33],[43,32,38,34,"default"],[43,39,38,41],[43,40,38,42,"seed"],[43,44,38,46],[43,45,38,47],[44,6,39,8],[44,12,39,14,"degree"],[44,18,39,20],[44,21,39,23,"exports"],[44,28,39,30],[44,29,39,31,"chooseDegree"],[44,41,39,43],[44,42,39,44,"seqLength"],[44,51,39,53],[44,53,39,55,"rng"],[44,56,39,58],[44,57,39,59],[45,6,40,8],[45,12,40,14,"indexes"],[45,19,40,21],[45,22,40,24],[45,23,40,25],[45,26,40,28],[45,30,40,32,"Array"],[45,35,40,37],[45,36,40,38,"seqLength"],[45,45,40,47],[45,46,40,48],[45,47,40,49],[45,48,40,50,"map"],[45,51,40,53],[45,52,40,54],[45,53,40,55,"_"],[45,54,40,56],[45,56,40,58,"index"],[45,61,40,63],[45,66,40,68,"index"],[45,71,40,73],[45,72,40,74],[46,6,41,8],[46,12,41,14,"shuffledIndexes"],[46,27,41,29],[46,30,41,32,"exports"],[46,37,41,39],[46,38,41,40,"shuffle"],[46,45,41,47],[46,46,41,48,"indexes"],[46,53,41,55],[46,55,41,57,"rng"],[46,58,41,60],[46,59,41,61],[47,6,42,8],[47,13,42,15,"shuffledIndexes"],[47,28,42,30],[47,29,42,31,"slice"],[47,34,42,36],[47,35,42,37],[47,36,42,38],[47,38,42,40,"degree"],[47,44,42,46],[47,45,42,47],[48,4,43,4],[49,2,44,0],[49,3,44,1],[50,2,45,0,"exports"],[50,9,45,7],[50,10,45,8,"chooseFragments"],[50,25,45,23],[50,28,45,26,"chooseFragments"],[50,43,45,41],[51,0,45,42],[51,3]],"functionMap":{"names":["<global>","<anonymous>","chooseDegree","map$argument_0","shuffle","chooseFragments"],"mappings":"AAA;wDCC;CDE;qBEM;6DCC,6BD;CFG;gBIE;CJW;wBKE;sDFW,mBE;CLI"},"hasCjsExports":true},"type":"js/module"}]}