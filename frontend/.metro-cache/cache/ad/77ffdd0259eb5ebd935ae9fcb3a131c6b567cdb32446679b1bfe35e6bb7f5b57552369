{"dependencies":[{"name":"uuid","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":13,"index":28},"end":{"line":3,"column":28,"index":43}}],"key":"jDVWfT8IaDtrIKMfZusH6IH9Zlc=","exportNames":["*"],"imports":1}},{"name":"../../generateRequest","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":24,"index":72},"end":{"line":4,"column":56,"index":104}}],"key":"oaYZszHZ4JsVBCrMWnpecsoi8U0=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  const uuid = require(_dependencyMap[0], \"uuid\").v4;\n  const generateRequest = require(_dependencyMap[1], \"../../generateRequest\");\n\n  /**\n   * Constructor for a Jayson Browser Client that does not depend any node.js core libraries\n   * @class ClientBrowser\n   * @param {Function} callServer Method that calls the server, receives the stringified request and a regular node-style callback\n   * @param {Object} [options]\n   * @param {Function} [options.reviver] Reviver function for JSON\n   * @param {Function} [options.replacer] Replacer function for JSON\n   * @param {Number} [options.version=2] JSON-RPC version to use (1|2)\n   * @param {Function} [options.generator] Function to use for generating request IDs\n   *  @param {Boolean} [options.notificationIdNull=false] When true, version 2 requests will set id to null instead of omitting it\n   * @return {ClientBrowser}\n   */\n  const ClientBrowser = function (callServer, options) {\n    if (!(this instanceof ClientBrowser)) {\n      return new ClientBrowser(callServer, options);\n    }\n    if (!options) {\n      options = {};\n    }\n    this.options = {\n      reviver: typeof options.reviver !== 'undefined' ? options.reviver : null,\n      replacer: typeof options.replacer !== 'undefined' ? options.replacer : null,\n      generator: typeof options.generator !== 'undefined' ? options.generator : function () {\n        return uuid();\n      },\n      version: typeof options.version !== 'undefined' ? options.version : 2,\n      notificationIdNull: typeof options.notificationIdNull === 'boolean' ? options.notificationIdNull : false\n    };\n    this.callServer = callServer;\n  };\n  module.exports = ClientBrowser;\n\n  /**\n   *  Creates a request and dispatches it if given a callback.\n   *  @param {String|Array} method A batch request if passed an Array, or a method name if passed a String\n   *  @param {Array|Object} [params] Parameters for the method\n   *  @param {String|Number} [id] Optional id. If undefined an id will be generated. If null it creates a notification request\n   *  @param {Function} [callback] Request callback. If specified, executes the request rather than only returning it.\n   *  @throws {TypeError} Invalid parameters\n   *  @return {Object} JSON-RPC 1.0 or 2.0 compatible request\n   */\n  ClientBrowser.prototype.request = function (method, params, id, callback) {\n    const self = this;\n    let request = null;\n\n    // is this a batch request?\n    const isBatch = Array.isArray(method) && typeof params === 'function';\n    if (this.options.version === 1 && isBatch) {\n      throw new TypeError('JSON-RPC 1.0 does not support batching');\n    }\n\n    // is this a raw request?\n    const isRaw = !isBatch && method && typeof method === 'object' && typeof params === 'function';\n    if (isBatch || isRaw) {\n      callback = params;\n      request = method;\n    } else {\n      if (typeof id === 'function') {\n        callback = id;\n        // specifically undefined because \"null\" is a notification request\n        id = undefined;\n      }\n      const hasCallback = typeof callback === 'function';\n      try {\n        request = generateRequest(method, params, id, {\n          generator: this.options.generator,\n          version: this.options.version,\n          notificationIdNull: this.options.notificationIdNull\n        });\n      } catch (err) {\n        if (hasCallback) {\n          callback(err);\n          return;\n        }\n        throw err;\n      }\n\n      // no callback means we should just return a raw request\n      if (!hasCallback) {\n        return request;\n      }\n    }\n    let message;\n    try {\n      message = JSON.stringify(request, this.options.replacer);\n    } catch (err) {\n      callback(err);\n      return;\n    }\n    this.callServer(message, function (err, response) {\n      self._parseResponse(err, response, callback);\n    });\n\n    // always return the raw request\n    return request;\n  };\n\n  /**\n   * Parses a response from a server\n   * @param {Object} err Error to pass on that is unrelated to the actual response\n   * @param {String} responseText JSON-RPC 1.0 or 2.0 response\n   * @param {Function} callback Callback that will receive different arguments depending on the amount of parameters\n   * @private\n   */\n  ClientBrowser.prototype._parseResponse = function (err, responseText, callback) {\n    if (err) {\n      callback(err);\n      return;\n    }\n    if (!responseText) {\n      // empty response text, assume that is correct because it could be a\n      // notification which jayson does not give any body for\n      callback();\n      return;\n    }\n    let response;\n    try {\n      response = JSON.parse(responseText, this.options.reviver);\n    } catch (err) {\n      callback(err);\n      return;\n    }\n    if (callback.length === 3) {\n      // if callback length is 3, we split callback arguments on error and response\n\n      // is batch response?\n      if (Array.isArray(response)) {\n        // necessary to split strictly on validity according to spec here\n        const isError = function (res) {\n          return typeof res.error !== 'undefined';\n        };\n        const isNotError = function (res) {\n          return !isError(res);\n        };\n        callback(null, response.filter(isError), response.filter(isNotError));\n        return;\n      } else {\n        // split regardless of validity\n        callback(null, response.error, response.result);\n        return;\n      }\n    }\n    callback(null, response);\n  };\n});","lineCount":151,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,8,3,6,"uuid"],[4,12,3,10],[4,15,3,13,"require"],[4,22,3,20],[4,23,3,20,"_dependencyMap"],[4,37,3,20],[4,48,3,27],[4,49,3,28],[4,50,3,29,"v4"],[4,52,3,31],[5,2,4,0],[5,8,4,6,"generateRequest"],[5,23,4,21],[5,26,4,24,"require"],[5,33,4,31],[5,34,4,31,"_dependencyMap"],[5,48,4,31],[5,76,4,55],[5,77,4,56],[7,2,6,0],[8,0,7,0],[9,0,8,0],[10,0,9,0],[11,0,10,0],[12,0,11,0],[13,0,12,0],[14,0,13,0],[15,0,14,0],[16,0,15,0],[17,0,16,0],[18,0,17,0],[19,2,18,0],[19,8,18,6,"ClientBrowser"],[19,21,18,19],[19,24,18,22],[19,33,18,22,"ClientBrowser"],[19,34,18,31,"callServer"],[19,44,18,41],[19,46,18,43,"options"],[19,53,18,50],[19,55,18,52],[20,4,19,2],[20,8,19,5],[20,10,19,7],[20,14,19,11],[20,26,19,23,"ClientBrowser"],[20,39,19,36],[20,40,19,37],[20,42,19,39],[21,6,20,4],[21,13,20,11],[21,17,20,15,"ClientBrowser"],[21,30,20,28],[21,31,20,29,"callServer"],[21,41,20,39],[21,43,20,41,"options"],[21,50,20,48],[21,51,20,49],[22,4,21,2],[23,4,23,2],[23,8,23,6],[23,9,23,7,"options"],[23,16,23,14],[23,18,23,16],[24,6,24,4,"options"],[24,13,24,11],[24,16,24,14],[24,17,24,15],[24,18,24,16],[25,4,25,2],[26,4,27,2],[26,8,27,6],[26,9,27,7,"options"],[26,16,27,14],[26,19,27,17],[27,6,28,4,"reviver"],[27,13,28,11],[27,15,28,13],[27,22,28,20,"options"],[27,29,28,27],[27,30,28,28,"reviver"],[27,37,28,35],[27,42,28,40],[27,53,28,51],[27,56,28,54,"options"],[27,63,28,61],[27,64,28,62,"reviver"],[27,71,28,69],[27,74,28,72],[27,78,28,76],[28,6,29,4,"replacer"],[28,14,29,12],[28,16,29,14],[28,23,29,21,"options"],[28,30,29,28],[28,31,29,29,"replacer"],[28,39,29,37],[28,44,29,42],[28,55,29,53],[28,58,29,56,"options"],[28,65,29,63],[28,66,29,64,"replacer"],[28,74,29,72],[28,77,29,75],[28,81,29,79],[29,6,30,4,"generator"],[29,15,30,13],[29,17,30,15],[29,24,30,22,"options"],[29,31,30,29],[29,32,30,30,"generator"],[29,41,30,39],[29,46,30,44],[29,57,30,55],[29,60,30,58,"options"],[29,67,30,65],[29,68,30,66,"generator"],[29,77,30,75],[29,80,30,78],[29,92,30,89],[30,8,30,91],[30,15,30,98,"uuid"],[30,19,30,102],[30,20,30,103],[30,21,30,104],[31,6,30,106],[31,7,30,107],[32,6,31,4,"version"],[32,13,31,11],[32,15,31,13],[32,22,31,20,"options"],[32,29,31,27],[32,30,31,28,"version"],[32,37,31,35],[32,42,31,40],[32,53,31,51],[32,56,31,54,"options"],[32,63,31,61],[32,64,31,62,"version"],[32,71,31,69],[32,74,31,72],[32,75,31,73],[33,6,32,4,"notificationIdNull"],[33,24,32,22],[33,26,32,24],[33,33,32,31,"options"],[33,40,32,38],[33,41,32,39,"notificationIdNull"],[33,59,32,57],[33,64,32,62],[33,73,32,71],[33,76,32,74,"options"],[33,83,32,81],[33,84,32,82,"notificationIdNull"],[33,102,32,100],[33,105,32,103],[34,4,33,2],[34,5,33,3],[35,4,35,2],[35,8,35,6],[35,9,35,7,"callServer"],[35,19,35,17],[35,22,35,20,"callServer"],[35,32,35,30],[36,2,36,0],[36,3,36,1],[37,2,38,0,"module"],[37,8,38,6],[37,9,38,7,"exports"],[37,16,38,14],[37,19,38,17,"ClientBrowser"],[37,32,38,30],[39,2,40,0],[40,0,41,0],[41,0,42,0],[42,0,43,0],[43,0,44,0],[44,0,45,0],[45,0,46,0],[46,0,47,0],[47,0,48,0],[48,2,49,0,"ClientBrowser"],[48,15,49,13],[48,16,49,14,"prototype"],[48,25,49,23],[48,26,49,24,"request"],[48,33,49,31],[48,36,49,34],[48,46,49,43,"method"],[48,52,49,49],[48,54,49,51,"params"],[48,60,49,57],[48,62,49,59,"id"],[48,64,49,61],[48,66,49,63,"callback"],[48,74,49,71],[48,76,49,73],[49,4,50,2],[49,10,50,8,"self"],[49,14,50,12],[49,17,50,15],[49,21,50,19],[50,4,51,2],[50,8,51,6,"request"],[50,15,51,13],[50,18,51,16],[50,22,51,20],[52,4,53,2],[53,4,54,2],[53,10,54,8,"isBatch"],[53,17,54,15],[53,20,54,18,"Array"],[53,25,54,23],[53,26,54,24,"isArray"],[53,33,54,31],[53,34,54,32,"method"],[53,40,54,38],[53,41,54,39],[53,45,54,43],[53,52,54,50,"params"],[53,58,54,56],[53,63,54,61],[53,73,54,71],[54,4,56,2],[54,8,56,6],[54,12,56,10],[54,13,56,11,"options"],[54,20,56,18],[54,21,56,19,"version"],[54,28,56,26],[54,33,56,31],[54,34,56,32],[54,38,56,36,"isBatch"],[54,45,56,43],[54,47,56,45],[55,6,57,4],[55,12,57,10],[55,16,57,14,"TypeError"],[55,25,57,23],[55,26,57,24],[55,66,57,64],[55,67,57,65],[56,4,58,2],[58,4,60,2],[59,4,61,2],[59,10,61,8,"isRaw"],[59,15,61,13],[59,18,61,16],[59,19,61,17,"isBatch"],[59,26,61,24],[59,30,61,28,"method"],[59,36,61,34],[59,40,61,38],[59,47,61,45,"method"],[59,53,61,51],[59,58,61,56],[59,66,61,64],[59,70,61,68],[59,77,61,75,"params"],[59,83,61,81],[59,88,61,86],[59,98,61,96],[60,4,63,2],[60,8,63,5,"isBatch"],[60,15,63,12],[60,19,63,16,"isRaw"],[60,24,63,21],[60,26,63,23],[61,6,64,4,"callback"],[61,14,64,12],[61,17,64,15,"params"],[61,23,64,21],[62,6,65,4,"request"],[62,13,65,11],[62,16,65,14,"method"],[62,22,65,20],[63,4,66,2],[63,5,66,3],[63,11,66,9],[64,6,67,4],[64,10,67,7],[64,17,67,14,"id"],[64,19,67,16],[64,24,67,21],[64,34,67,31],[64,36,67,33],[65,8,68,6,"callback"],[65,16,68,14],[65,19,68,17,"id"],[65,21,68,19],[66,8,69,6],[67,8,70,6,"id"],[67,10,70,8],[67,13,70,11,"undefined"],[67,22,70,20],[68,6,71,4],[69,6,73,4],[69,12,73,10,"hasCallback"],[69,23,73,21],[69,26,73,24],[69,33,73,31,"callback"],[69,41,73,39],[69,46,73,44],[69,56,73,54],[70,6,75,4],[70,10,75,8],[71,8,76,6,"request"],[71,15,76,13],[71,18,76,16,"generateRequest"],[71,33,76,31],[71,34,76,32,"method"],[71,40,76,38],[71,42,76,40,"params"],[71,48,76,46],[71,50,76,48,"id"],[71,52,76,50],[71,54,76,52],[72,10,77,8,"generator"],[72,19,77,17],[72,21,77,19],[72,25,77,23],[72,26,77,24,"options"],[72,33,77,31],[72,34,77,32,"generator"],[72,43,77,41],[73,10,78,8,"version"],[73,17,78,15],[73,19,78,17],[73,23,78,21],[73,24,78,22,"options"],[73,31,78,29],[73,32,78,30,"version"],[73,39,78,37],[74,10,79,8,"notificationIdNull"],[74,28,79,26],[74,30,79,28],[74,34,79,32],[74,35,79,33,"options"],[74,42,79,40],[74,43,79,41,"notificationIdNull"],[75,8,80,6],[75,9,80,7],[75,10,80,8],[76,6,81,4],[76,7,81,5],[76,8,81,6],[76,15,81,12,"err"],[76,18,81,15],[76,20,81,17],[77,8,82,6],[77,12,82,9,"hasCallback"],[77,23,82,20],[77,25,82,22],[78,10,83,8,"callback"],[78,18,83,16],[78,19,83,17,"err"],[78,22,83,20],[78,23,83,21],[79,10,84,8],[80,8,85,6],[81,8,86,6],[81,14,86,12,"err"],[81,17,86,15],[82,6,87,4],[84,6,89,4],[85,6,90,4],[85,10,90,7],[85,11,90,8,"hasCallback"],[85,22,90,19],[85,24,90,21],[86,8,91,6],[86,15,91,13,"request"],[86,22,91,20],[87,6,92,4],[88,4,94,2],[89,4,96,2],[89,8,96,6,"message"],[89,15,96,13],[90,4,97,2],[90,8,97,6],[91,6,98,4,"message"],[91,13,98,11],[91,16,98,14,"JSON"],[91,20,98,18],[91,21,98,19,"stringify"],[91,30,98,28],[91,31,98,29,"request"],[91,38,98,36],[91,40,98,38],[91,44,98,42],[91,45,98,43,"options"],[91,52,98,50],[91,53,98,51,"replacer"],[91,61,98,59],[91,62,98,60],[92,4,99,2],[92,5,99,3],[92,6,99,4],[92,13,99,10,"err"],[92,16,99,13],[92,18,99,15],[93,6,100,4,"callback"],[93,14,100,12],[93,15,100,13,"err"],[93,18,100,16],[93,19,100,17],[94,6,101,4],[95,4,102,2],[96,4,104,2],[96,8,104,6],[96,9,104,7,"callServer"],[96,19,104,17],[96,20,104,18,"message"],[96,27,104,25],[96,29,104,27],[96,39,104,36,"err"],[96,42,104,39],[96,44,104,41,"response"],[96,52,104,49],[96,54,104,51],[97,6,105,4,"self"],[97,10,105,8],[97,11,105,9,"_parseResponse"],[97,25,105,23],[97,26,105,24,"err"],[97,29,105,27],[97,31,105,29,"response"],[97,39,105,37],[97,41,105,39,"callback"],[97,49,105,47],[97,50,105,48],[98,4,106,2],[98,5,106,3],[98,6,106,4],[100,4,108,2],[101,4,109,2],[101,11,109,9,"request"],[101,18,109,16],[102,2,110,0],[102,3,110,1],[104,2,112,0],[105,0,113,0],[106,0,114,0],[107,0,115,0],[108,0,116,0],[109,0,117,0],[110,0,118,0],[111,2,119,0,"ClientBrowser"],[111,15,119,13],[111,16,119,14,"prototype"],[111,25,119,23],[111,26,119,24,"_parseResponse"],[111,40,119,38],[111,43,119,41],[111,53,119,50,"err"],[111,56,119,53],[111,58,119,55,"responseText"],[111,70,119,67],[111,72,119,69,"callback"],[111,80,119,77],[111,82,119,79],[112,4,120,2],[112,8,120,5,"err"],[112,11,120,8],[112,13,120,10],[113,6,121,4,"callback"],[113,14,121,12],[113,15,121,13,"err"],[113,18,121,16],[113,19,121,17],[114,6,122,4],[115,4,123,2],[116,4,125,2],[116,8,125,5],[116,9,125,6,"responseText"],[116,21,125,18],[116,23,125,20],[117,6,126,4],[118,6,127,4],[119,6,128,4,"callback"],[119,14,128,12],[119,15,128,13],[119,16,128,14],[120,6,129,4],[121,4,130,2],[122,4,132,2],[122,8,132,6,"response"],[122,16,132,14],[123,4,133,2],[123,8,133,6],[124,6,134,4,"response"],[124,14,134,12],[124,17,134,15,"JSON"],[124,21,134,19],[124,22,134,20,"parse"],[124,27,134,25],[124,28,134,26,"responseText"],[124,40,134,38],[124,42,134,40],[124,46,134,44],[124,47,134,45,"options"],[124,54,134,52],[124,55,134,53,"reviver"],[124,62,134,60],[124,63,134,61],[125,4,135,2],[125,5,135,3],[125,6,135,4],[125,13,135,10,"err"],[125,16,135,13],[125,18,135,15],[126,6,136,4,"callback"],[126,14,136,12],[126,15,136,13,"err"],[126,18,136,16],[126,19,136,17],[127,6,137,4],[128,4,138,2],[129,4,140,2],[129,8,140,5,"callback"],[129,16,140,13],[129,17,140,14,"length"],[129,23,140,20],[129,28,140,25],[129,29,140,26],[129,31,140,28],[130,6,141,4],[132,6,143,4],[133,6,144,4],[133,10,144,7,"Array"],[133,15,144,12],[133,16,144,13,"isArray"],[133,23,144,20],[133,24,144,21,"response"],[133,32,144,29],[133,33,144,30],[133,35,144,32],[134,8,146,6],[135,8,147,6],[135,14,147,12,"isError"],[135,21,147,19],[135,24,147,22],[135,33,147,22,"isError"],[135,34,147,31,"res"],[135,37,147,34],[135,39,147,36],[136,10,148,8],[136,17,148,15],[136,24,148,22,"res"],[136,27,148,25],[136,28,148,26,"error"],[136,33,148,31],[136,38,148,36],[136,49,148,47],[137,8,149,6],[137,9,149,7],[138,8,151,6],[138,14,151,12,"isNotError"],[138,24,151,22],[138,27,151,25],[138,36,151,25,"isNotError"],[138,37,151,35,"res"],[138,40,151,38],[138,42,151,40],[139,10,152,8],[139,17,152,15],[139,18,152,16,"isError"],[139,25,152,23],[139,26,152,24,"res"],[139,29,152,27],[139,30,152,28],[140,8,153,6],[140,9,153,7],[141,8,155,6,"callback"],[141,16,155,14],[141,17,155,15],[141,21,155,19],[141,23,155,21,"response"],[141,31,155,29],[141,32,155,30,"filter"],[141,38,155,36],[141,39,155,37,"isError"],[141,46,155,44],[141,47,155,45],[141,49,155,47,"response"],[141,57,155,55],[141,58,155,56,"filter"],[141,64,155,62],[141,65,155,63,"isNotError"],[141,75,155,73],[141,76,155,74],[141,77,155,75],[142,8,156,6],[143,6,157,4],[143,7,157,5],[143,13,157,11],[144,8,159,6],[145,8,160,6,"callback"],[145,16,160,14],[145,17,160,15],[145,21,160,19],[145,23,160,21,"response"],[145,31,160,29],[145,32,160,30,"error"],[145,37,160,35],[145,39,160,37,"response"],[145,47,160,45],[145,48,160,46,"result"],[145,54,160,52],[145,55,160,53],[146,8,161,6],[147,6,162,4],[148,4,164,2],[149,4,166,2,"callback"],[149,12,166,10],[149,13,166,11],[149,17,166,15],[149,19,166,17,"response"],[149,27,166,25],[149,28,166,26],[150,2,167,0],[150,3,167,1],[151,0,167,2],[151,3]],"functionMap":{"names":["<global>","ClientBrowser","<anonymous>","ClientBrowser.prototype.request","callServer$argument_1","ClientBrowser.prototype._parseResponse","isError","isNotError"],"mappings":"AAA;sBCiB;8ECY,6BD;CDM;kCGa;2BCuD;GDE;CHI;yCKS;sBC4B;ODE;yBEE;OFE;CLc"},"hasCjsExports":true},"type":"js/module"}]}