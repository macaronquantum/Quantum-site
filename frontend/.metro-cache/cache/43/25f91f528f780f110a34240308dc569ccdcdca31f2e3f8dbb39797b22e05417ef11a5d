{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"log\", {\n    enumerable: true,\n    get: function () {\n      return log;\n    }\n  });\n  Object.defineProperty(exports, \"trace\", {\n    enumerable: true,\n    get: function () {\n      return trace;\n    }\n  });\n  Object.defineProperty(exports, \"LocalTracer\", {\n    enumerable: true,\n    get: function () {\n      return LocalTracer;\n    }\n  });\n  Object.defineProperty(exports, \"listen\", {\n    enumerable: true,\n    get: function () {\n      return listen;\n    }\n  });\n  let id = 0;\n  const subscribers = [];\n  /**\n   * Logs something\n   *\n   * @param type a namespaced identifier of the log (it is not a level like \"debug\", \"error\" but more like \"apdu-in\", \"apdu-out\", etc...)\n   * @param message a clear message of the log associated to the type\n   */\n  const log = (type, message, data) => {\n    const obj = {\n      type,\n      id: String(++id),\n      date: new Date()\n    };\n    if (message) obj.message = message;\n    if (data) obj.data = data;\n    dispatch(obj);\n  };\n  /**\n   * A simple tracer function, only expanding the existing log function\n   *\n   * Its goal is to capture more context than a log function.\n   * This is simple for now, but can be improved later.\n   *\n   * @param context Anything representing the context where the log occurred\n   */\n  const trace = ({\n    type,\n    message,\n    data,\n    context\n  }) => {\n    const obj = {\n      type,\n      id: String(++id),\n      date: new Date()\n    };\n    if (message) obj.message = message;\n    if (data) obj.data = data;\n    if (context) obj.context = context;\n    dispatch(obj);\n  };\n  /**\n   * A simple tracer class, that can be used to avoid repetition when using the `trace` function\n   *\n   * Its goal is to capture more context than a log function.\n   * This is simple for now, but can be improved later.\n   *\n   * @param type A given type (not level) for the current local tracer (\"hw\", \"withDevice\", etc.)\n   * @param context Anything representing the context where the log occurred\n   */\n  class LocalTracer {\n    constructor(type, context) {\n      this.type = type;\n      this.context = context;\n    }\n    trace(message, data) {\n      trace({\n        type: this.type,\n        message,\n        data,\n        context: this.context\n      });\n    }\n    getContext() {\n      return this.context;\n    }\n    setContext(context) {\n      this.context = context;\n    }\n    updateContext(contextToAdd) {\n      this.context = {\n        ...this.context,\n        ...contextToAdd\n      };\n    }\n    getType() {\n      return this.type;\n    }\n    setType(type) {\n      this.type = type;\n    }\n    /**\n     * Create a new instance of the LocalTracer with an updated `type`\n     *\n     * It does not mutate the calling instance, but returns a new LocalTracer,\n     * following a simple builder pattern.\n     */\n    withType(type) {\n      return new LocalTracer(type, this.context);\n    }\n    /**\n     * Create a new instance of the LocalTracer with a new `context`\n     *\n     * It does not mutate the calling instance, but returns a new LocalTracer,\n     * following a simple builder pattern.\n     *\n     * @param context A TraceContext, that can undefined to reset the context\n     */\n    withContext(context) {\n      return new LocalTracer(this.type, context);\n    }\n    /**\n     * Create a new instance of the LocalTracer with an updated `context`,\n     * on which an additional context is merged with the existing one.\n     *\n     * It does not mutate the calling instance, but returns a new LocalTracer,\n     * following a simple builder pattern.\n     */\n    withUpdatedContext(contextToAdd) {\n      return new LocalTracer(this.type, {\n        ...this.context,\n        ...contextToAdd\n      });\n    }\n  }\n  /**\n   * Adds a subscribers to the emitted logs.\n   *\n   * @param cb that is called for each future log() with the Log object\n   * @return a function that can be called to unsubscribe the listener\n   */\n  const listen = cb => {\n    subscribers.push(cb);\n    return () => {\n      const i = subscribers.indexOf(cb);\n      if (i !== -1) {\n        // equivalent of subscribers.splice(i, 1) // https://twitter.com/Rich_Harris/status/1125850391155965952\n        subscribers[i] = subscribers[subscribers.length - 1];\n        subscribers.pop();\n      }\n    };\n  };\n  function dispatch(log) {\n    for (let i = 0; i < subscribers.length; i++) {\n      try {\n        subscribers[i](log);\n      } catch (e) {\n        console.error(e);\n      }\n    }\n  }\n  if (typeof window !== \"undefined\") {\n    window.__ledgerLogsListen = listen;\n  }\n});","lineCount":176,"map":[[7,2,9,0,"Object"],[7,8,9,0],[7,9,9,0,"defineProperty"],[7,23,9,0],[7,24,9,0,"exports"],[7,31,9,0],[8,4,9,0,"enumerable"],[8,14,9,0],[9,4,9,0,"get"],[9,7,9,0],[9,18,9,0,"get"],[9,19,9,0],[10,6,9,0],[10,13,9,0,"log"],[10,16,9,0],[11,4,9,0],[12,2,9,0],[13,2,29,0,"Object"],[13,8,29,0],[13,9,29,0,"defineProperty"],[13,23,29,0],[13,24,29,0,"exports"],[13,31,29,0],[14,4,29,0,"enumerable"],[14,14,29,0],[15,4,29,0,"get"],[15,7,29,0],[15,18,29,0,"get"],[15,19,29,0],[16,6,29,0],[16,13,29,0,"trace"],[16,18,29,0],[17,4,29,0],[18,2,29,0],[19,2,52,0,"Object"],[19,8,52,0],[19,9,52,0,"defineProperty"],[19,23,52,0],[19,24,52,0,"exports"],[19,31,52,0],[20,4,52,0,"enumerable"],[20,14,52,0],[21,4,52,0,"get"],[21,7,52,0],[21,18,52,0,"get"],[21,19,52,0],[22,6,52,0],[22,13,52,0,"LocalTracer"],[22,24,52,0],[23,4,52,0],[24,2,52,0],[25,2,119,0,"Object"],[25,8,119,0],[25,9,119,0,"defineProperty"],[25,23,119,0],[25,24,119,0,"exports"],[25,31,119,0],[26,4,119,0,"enumerable"],[26,14,119,0],[27,4,119,0,"get"],[27,7,119,0],[27,18,119,0,"get"],[27,19,119,0],[28,6,119,0],[28,13,119,0,"listen"],[28,19,119,0],[29,4,119,0],[30,2,119,0],[31,2,1,0],[31,6,1,4,"id"],[31,8,1,6],[31,11,1,9],[31,12,1,10],[32,2,2,0],[32,8,2,6,"subscribers"],[32,19,2,17],[32,22,2,20],[32,24,2,22],[33,2,3,0],[34,0,4,0],[35,0,5,0],[36,0,6,0],[37,0,7,0],[38,0,8,0],[39,2,9,7],[39,8,9,13,"log"],[39,11,9,16],[39,14,9,19,"log"],[39,15,9,20,"type"],[39,19,9,24],[39,21,9,26,"message"],[39,28,9,33],[39,30,9,35,"data"],[39,34,9,39],[39,39,9,44],[40,4,10,4],[40,10,10,10,"obj"],[40,13,10,13],[40,16,10,16],[41,6,11,8,"type"],[41,10,11,12],[42,6,12,8,"id"],[42,8,12,10],[42,10,12,12,"String"],[42,16,12,18],[42,17,12,19],[42,19,12,21,"id"],[42,21,12,23],[42,22,12,24],[43,6,13,8,"date"],[43,10,13,12],[43,12,13,14],[43,16,13,18,"Date"],[43,20,13,22],[43,21,13,23],[44,4,14,4],[44,5,14,5],[45,4,15,4],[45,8,15,8,"message"],[45,15,15,15],[45,17,16,8,"obj"],[45,20,16,11],[45,21,16,12,"message"],[45,28,16,19],[45,31,16,22,"message"],[45,38,16,29],[46,4,17,4],[46,8,17,8,"data"],[46,12,17,12],[46,14,18,8,"obj"],[46,17,18,11],[46,18,18,12,"data"],[46,22,18,16],[46,25,18,19,"data"],[46,29,18,23],[47,4,19,4,"dispatch"],[47,12,19,12],[47,13,19,13,"obj"],[47,16,19,16],[47,17,19,17],[48,2,20,0],[48,3,20,1],[49,2,21,0],[50,0,22,0],[51,0,23,0],[52,0,24,0],[53,0,25,0],[54,0,26,0],[55,0,27,0],[56,0,28,0],[57,2,29,7],[57,8,29,13,"trace"],[57,13,29,18],[57,16,29,21,"trace"],[57,17,29,22],[58,4,29,24,"type"],[58,8,29,28],[59,4,29,30,"message"],[59,11,29,37],[60,4,29,39,"data"],[60,8,29,43],[61,4,29,45,"context"],[62,2,29,54],[62,3,29,55],[62,8,29,60],[63,4,30,4],[63,10,30,10,"obj"],[63,13,30,13],[63,16,30,16],[64,6,31,8,"type"],[64,10,31,12],[65,6,32,8,"id"],[65,8,32,10],[65,10,32,12,"String"],[65,16,32,18],[65,17,32,19],[65,19,32,21,"id"],[65,21,32,23],[65,22,32,24],[66,6,33,8,"date"],[66,10,33,12],[66,12,33,14],[66,16,33,18,"Date"],[66,20,33,22],[66,21,33,23],[67,4,34,4],[67,5,34,5],[68,4,35,4],[68,8,35,8,"message"],[68,15,35,15],[68,17,36,8,"obj"],[68,20,36,11],[68,21,36,12,"message"],[68,28,36,19],[68,31,36,22,"message"],[68,38,36,29],[69,4,37,4],[69,8,37,8,"data"],[69,12,37,12],[69,14,38,8,"obj"],[69,17,38,11],[69,18,38,12,"data"],[69,22,38,16],[69,25,38,19,"data"],[69,29,38,23],[70,4,39,4],[70,8,39,8,"context"],[70,15,39,15],[70,17,40,8,"obj"],[70,20,40,11],[70,21,40,12,"context"],[70,28,40,19],[70,31,40,22,"context"],[70,38,40,29],[71,4,41,4,"dispatch"],[71,12,41,12],[71,13,41,13,"obj"],[71,16,41,16],[71,17,41,17],[72,2,42,0],[72,3,42,1],[73,2,43,0],[74,0,44,0],[75,0,45,0],[76,0,46,0],[77,0,47,0],[78,0,48,0],[79,0,49,0],[80,0,50,0],[81,0,51,0],[82,2,52,7],[82,8,52,13,"LocalTracer"],[82,19,52,24],[82,20,52,25],[83,4,55,4,"constructor"],[83,15,55,15,"constructor"],[83,16,55,16,"type"],[83,20,55,20],[83,22,55,22,"context"],[83,29,55,29],[83,31,55,31],[84,6,56,8],[84,10,56,12],[84,11,56,13,"type"],[84,15,56,17],[84,18,56,20,"type"],[84,22,56,24],[85,6,57,8],[85,10,57,12],[85,11,57,13,"context"],[85,18,57,20],[85,21,57,23,"context"],[85,28,57,30],[86,4,58,4],[87,4,59,4,"trace"],[87,9,59,9,"trace"],[87,10,59,10,"message"],[87,17,59,17],[87,19,59,19,"data"],[87,23,59,23],[87,25,59,25],[88,6,60,8,"trace"],[88,11,60,13],[88,12,60,14],[89,8,61,12,"type"],[89,12,61,16],[89,14,61,18],[89,18,61,22],[89,19,61,23,"type"],[89,23,61,27],[90,8,62,12,"message"],[90,15,62,19],[91,8,63,12,"data"],[91,12,63,16],[92,8,64,12,"context"],[92,15,64,19],[92,17,64,21],[92,21,64,25],[92,22,64,26,"context"],[93,6,65,8],[93,7,65,9],[93,8,65,10],[94,4,66,4],[95,4,67,4,"getContext"],[95,14,67,14,"getContext"],[95,15,67,14],[95,17,67,17],[96,6,68,8],[96,13,68,15],[96,17,68,19],[96,18,68,20,"context"],[96,25,68,27],[97,4,69,4],[98,4,70,4,"setContext"],[98,14,70,14,"setContext"],[98,15,70,15,"context"],[98,22,70,22],[98,24,70,24],[99,6,71,8],[99,10,71,12],[99,11,71,13,"context"],[99,18,71,20],[99,21,71,23,"context"],[99,28,71,30],[100,4,72,4],[101,4,73,4,"updateContext"],[101,17,73,17,"updateContext"],[101,18,73,18,"contextToAdd"],[101,30,73,30],[101,32,73,32],[102,6,74,8],[102,10,74,12],[102,11,74,13,"context"],[102,18,74,20],[102,21,74,23],[103,8,74,25],[103,11,74,28],[103,15,74,32],[103,16,74,33,"context"],[103,23,74,40],[104,8,74,42],[104,11,74,45,"contextToAdd"],[105,6,74,58],[105,7,74,59],[106,4,75,4],[107,4,76,4,"getType"],[107,11,76,11,"getType"],[107,12,76,11],[107,14,76,14],[108,6,77,8],[108,13,77,15],[108,17,77,19],[108,18,77,20,"type"],[108,22,77,24],[109,4,78,4],[110,4,79,4,"setType"],[110,11,79,11,"setType"],[110,12,79,12,"type"],[110,16,79,16],[110,18,79,18],[111,6,80,8],[111,10,80,12],[111,11,80,13,"type"],[111,15,80,17],[111,18,80,20,"type"],[111,22,80,24],[112,4,81,4],[113,4,82,4],[114,0,83,0],[115,0,84,0],[116,0,85,0],[117,0,86,0],[118,0,87,0],[119,4,88,4,"withType"],[119,12,88,12,"withType"],[119,13,88,13,"type"],[119,17,88,17],[119,19,88,19],[120,6,89,8],[120,13,89,15],[120,17,89,19,"LocalTracer"],[120,28,89,30],[120,29,89,31,"type"],[120,33,89,35],[120,35,89,37],[120,39,89,41],[120,40,89,42,"context"],[120,47,89,49],[120,48,89,50],[121,4,90,4],[122,4,91,4],[123,0,92,0],[124,0,93,0],[125,0,94,0],[126,0,95,0],[127,0,96,0],[128,0,97,0],[129,0,98,0],[130,4,99,4,"withContext"],[130,15,99,15,"withContext"],[130,16,99,16,"context"],[130,23,99,23],[130,25,99,25],[131,6,100,8],[131,13,100,15],[131,17,100,19,"LocalTracer"],[131,28,100,30],[131,29,100,31],[131,33,100,35],[131,34,100,36,"type"],[131,38,100,40],[131,40,100,42,"context"],[131,47,100,49],[131,48,100,50],[132,4,101,4],[133,4,102,4],[134,0,103,0],[135,0,104,0],[136,0,105,0],[137,0,106,0],[138,0,107,0],[139,0,108,0],[140,4,109,4,"withUpdatedContext"],[140,22,109,22,"withUpdatedContext"],[140,23,109,23,"contextToAdd"],[140,35,109,35],[140,37,109,37],[141,6,110,8],[141,13,110,15],[141,17,110,19,"LocalTracer"],[141,28,110,30],[141,29,110,31],[141,33,110,35],[141,34,110,36,"type"],[141,38,110,40],[141,40,110,42],[142,8,110,44],[142,11,110,47],[142,15,110,51],[142,16,110,52,"context"],[142,23,110,59],[143,8,110,61],[143,11,110,64,"contextToAdd"],[144,6,110,77],[144,7,110,78],[144,8,110,79],[145,4,111,4],[146,2,112,0],[147,2,113,0],[148,0,114,0],[149,0,115,0],[150,0,116,0],[151,0,117,0],[152,0,118,0],[153,2,119,7],[153,8,119,13,"listen"],[153,14,119,19],[153,17,119,23,"cb"],[153,19,119,25],[153,23,119,30],[154,4,120,4,"subscribers"],[154,15,120,15],[154,16,120,16,"push"],[154,20,120,20],[154,21,120,21,"cb"],[154,23,120,23],[154,24,120,24],[155,4,121,4],[155,11,121,11],[155,17,121,17],[156,6,122,8],[156,12,122,14,"i"],[156,13,122,15],[156,16,122,18,"subscribers"],[156,27,122,29],[156,28,122,30,"indexOf"],[156,35,122,37],[156,36,122,38,"cb"],[156,38,122,40],[156,39,122,41],[157,6,123,8],[157,10,123,12,"i"],[157,11,123,13],[157,16,123,18],[157,17,123,19],[157,18,123,20],[157,20,123,22],[158,8,124,12],[159,8,125,12,"subscribers"],[159,19,125,23],[159,20,125,24,"i"],[159,21,125,25],[159,22,125,26],[159,25,125,29,"subscribers"],[159,36,125,40],[159,37,125,41,"subscribers"],[159,48,125,52],[159,49,125,53,"length"],[159,55,125,59],[159,58,125,62],[159,59,125,63],[159,60,125,64],[160,8,126,12,"subscribers"],[160,19,126,23],[160,20,126,24,"pop"],[160,23,126,27],[160,24,126,28],[160,25,126,29],[161,6,127,8],[162,4,128,4],[162,5,128,5],[163,2,129,0],[163,3,129,1],[164,2,130,0],[164,11,130,9,"dispatch"],[164,19,130,17,"dispatch"],[164,20,130,18,"log"],[164,23,130,21],[164,25,130,23],[165,4,131,4],[165,9,131,9],[165,13,131,13,"i"],[165,14,131,14],[165,17,131,17],[165,18,131,18],[165,20,131,20,"i"],[165,21,131,21],[165,24,131,24,"subscribers"],[165,35,131,35],[165,36,131,36,"length"],[165,42,131,42],[165,44,131,44,"i"],[165,45,131,45],[165,47,131,47],[165,49,131,49],[166,6,132,8],[166,10,132,12],[167,8,133,12,"subscribers"],[167,19,133,23],[167,20,133,24,"i"],[167,21,133,25],[167,22,133,26],[167,23,133,27,"log"],[167,26,133,30],[167,27,133,31],[168,6,134,8],[168,7,134,9],[168,8,135,8],[168,15,135,15,"e"],[168,16,135,16],[168,18,135,18],[169,8,136,12,"console"],[169,15,136,19],[169,16,136,20,"error"],[169,21,136,25],[169,22,136,26,"e"],[169,23,136,27],[169,24,136,28],[170,6,137,8],[171,4,138,4],[172,2,139,0],[173,2,140,0],[173,6,140,4],[173,13,140,11,"window"],[173,19,140,17],[173,24,140,22],[173,35,140,33],[173,37,140,35],[174,4,141,4,"window"],[174,10,141,10],[174,11,141,11,"__ledgerLogsListen"],[174,29,141,29],[174,32,141,32,"listen"],[174,38,141,38],[175,2,142,0],[176,0,142,1],[176,3]],"functionMap":{"names":["<global>","log","trace","LocalTracer","LocalTracer#constructor","LocalTracer#trace","LocalTracer#getContext","LocalTracer#setContext","LocalTracer#updateContext","LocalTracer#getType","LocalTracer#setType","LocalTracer#withType","LocalTracer#withContext","LocalTracer#withUpdatedContext","listen","<anonymous>","dispatch"],"mappings":"AAA;mBCQ;CDW;qBES;CFa;OGU;ICG;KDG;IEC;KFO;IGC;KHE;IIC;KJE;IKC;KLE;IMC;KNE;IOC;KPE;IQO;KRE;ISS;KTE;IUQ;KVE;CHC;sBcO;WCE;KDO;CdC;AgBC;ChBS"},"hasCjsExports":false},"type":"js/module"}]}