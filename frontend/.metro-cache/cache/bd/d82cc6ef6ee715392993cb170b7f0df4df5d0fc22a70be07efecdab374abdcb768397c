{"dependencies":[{"name":"../../errors/request.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":58,"index":58}}],"key":"2pE/btc+6/9ceuRiPNwUYrtm86Y=","exportNames":["*"],"imports":1}},{"name":"../../errors/transport.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":59},"end":{"line":2,"column":62,"index":121}}],"key":"805IfQHE3SROi/84maXj3cvj+EI=","exportNames":["*"],"imports":1}},{"name":"../../utils/promise/createBatchScheduler.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":122},"end":{"line":3,"column":83,"index":205}}],"key":"/Yf25OoMeA3M6cndxs4LL4Yizt0=","exportNames":["*"],"imports":1}},{"name":"../../utils/rpc/http.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":206},"end":{"line":4,"column":60,"index":266}}],"key":"Pa6VDHrHANzzrWIx2Z/yQBDfvIk=","exportNames":["*"],"imports":1}},{"name":"./createTransport.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":267},"end":{"line":5,"column":56,"index":323}}],"key":"IMAs7VdCtDa1Nl7Tey+wGJLFCUk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.http = http;\n  var _errorsRequestJs = require(_dependencyMap[0], \"../../errors/request.js\");\n  var _errorsTransportJs = require(_dependencyMap[1], \"../../errors/transport.js\");\n  var _utilsPromiseCreateBatchSchedulerJs = require(_dependencyMap[2], \"../../utils/promise/createBatchScheduler.js\");\n  var _utilsRpcHttpJs = require(_dependencyMap[3], \"../../utils/rpc/http.js\");\n  var _createTransportJs = require(_dependencyMap[4], \"./createTransport.js\");\n  /**\n   * @description Creates a HTTP transport that connects to a JSON-RPC API.\n   */\n  function http(/** URL of the JSON-RPC API. Defaults to the chain's public RPC URL. */\n  url, config = {}) {\n    const {\n      batch,\n      fetchOptions,\n      key = 'http',\n      methods,\n      name = 'HTTP JSON-RPC',\n      onFetchRequest,\n      onFetchResponse,\n      retryDelay\n    } = config;\n    return ({\n      chain,\n      retryCount: retryCount_,\n      timeout: timeout_\n    }) => {\n      const {\n        batchSize = 1000,\n        wait = 0\n      } = typeof batch === 'object' ? batch : {};\n      const retryCount = config.retryCount ?? retryCount_;\n      const timeout = timeout_ ?? config.timeout ?? 10_000;\n      const url_ = url || chain?.rpcUrls.default.http[0];\n      if (!url_) throw new _errorsTransportJs.UrlRequiredError();\n      const rpcClient = (0, _utilsRpcHttpJs.getHttpRpcClient)(url_, {\n        fetchOptions,\n        onRequest: onFetchRequest,\n        onResponse: onFetchResponse,\n        timeout\n      });\n      return (0, _createTransportJs.createTransport)({\n        key,\n        methods,\n        name,\n        async request({\n          method,\n          params\n        }) {\n          const body = {\n            method,\n            params\n          };\n          const {\n            schedule\n          } = (0, _utilsPromiseCreateBatchSchedulerJs.createBatchScheduler)({\n            id: url_,\n            wait,\n            shouldSplitBatch(requests) {\n              return requests.length > batchSize;\n            },\n            fn: body => rpcClient.request({\n              body\n            }),\n            sort: (a, b) => a.id - b.id\n          });\n          const fn = async body => batch ? schedule(body) : [await rpcClient.request({\n            body\n          })];\n          const [{\n            error,\n            result\n          }] = await fn(body);\n          if (error) throw new _errorsRequestJs.RpcRequestError({\n            body,\n            error,\n            url: url_\n          });\n          return result;\n        },\n        retryCount,\n        retryDelay,\n        timeout,\n        type: 'http'\n      }, {\n        fetchOptions,\n        url: url_\n      });\n    };\n  }\n});","lineCount":96,"map":[[7,2,9,0,"exports"],[7,9,9,0],[7,10,9,0,"http"],[7,14,9,0],[7,17,9,0,"http"],[7,21,9,0],[8,2,1,0],[8,6,1,0,"_errorsRequestJs"],[8,22,1,0],[8,25,1,0,"require"],[8,32,1,0],[8,33,1,0,"_dependencyMap"],[8,47,1,0],[9,2,2,0],[9,6,2,0,"_errorsTransportJs"],[9,24,2,0],[9,27,2,0,"require"],[9,34,2,0],[9,35,2,0,"_dependencyMap"],[9,49,2,0],[10,2,3,0],[10,6,3,0,"_utilsPromiseCreateBatchSchedulerJs"],[10,41,3,0],[10,44,3,0,"require"],[10,51,3,0],[10,52,3,0,"_dependencyMap"],[10,66,3,0],[11,2,4,0],[11,6,4,0,"_utilsRpcHttpJs"],[11,21,4,0],[11,24,4,0,"require"],[11,31,4,0],[11,32,4,0,"_dependencyMap"],[11,46,4,0],[12,2,5,0],[12,6,5,0,"_createTransportJs"],[12,24,5,0],[12,27,5,0,"require"],[12,34,5,0],[12,35,5,0,"_dependencyMap"],[12,49,5,0],[13,2,6,0],[14,0,7,0],[15,0,8,0],[16,2,9,7],[16,11,9,16,"http"],[16,15,9,20,"http"],[16,16,10,0],[17,2,11,0,"url"],[17,5,11,3],[17,7,11,5,"config"],[17,13,11,11],[17,16,11,14],[17,17,11,15],[17,18,11,16],[17,20,11,18],[18,4,12,4],[18,10,12,10],[19,6,12,12,"batch"],[19,11,12,17],[20,6,12,19,"fetchOptions"],[20,18,12,31],[21,6,12,33,"key"],[21,9,12,36],[21,12,12,39],[21,18,12,45],[22,6,12,47,"methods"],[22,13,12,54],[23,6,12,56,"name"],[23,10,12,60],[23,13,12,63],[23,28,12,78],[24,6,12,80,"onFetchRequest"],[24,20,12,94],[25,6,12,96,"onFetchResponse"],[25,21,12,111],[26,6,12,113,"retryDelay"],[27,4,12,125],[27,5,12,126],[27,8,12,129,"config"],[27,14,12,135],[28,4,13,4],[28,11,13,11],[28,12,13,12],[29,6,13,14,"chain"],[29,11,13,19],[30,6,13,21,"retryCount"],[30,16,13,31],[30,18,13,33,"retryCount_"],[30,29,13,44],[31,6,13,46,"timeout"],[31,13,13,53],[31,15,13,55,"timeout_"],[32,4,13,64],[32,5,13,65],[32,10,13,70],[33,6,14,8],[33,12,14,14],[34,8,14,16,"batchSize"],[34,17,14,25],[34,20,14,28],[34,24,14,32],[35,8,14,34,"wait"],[35,12,14,38],[35,15,14,41],[36,6,14,43],[36,7,14,44],[36,10,14,47],[36,17,14,54,"batch"],[36,22,14,59],[36,27,14,64],[36,35,14,72],[36,38,14,75,"batch"],[36,43,14,80],[36,46,14,83],[36,47,14,84],[36,48,14,85],[37,6,15,8],[37,12,15,14,"retryCount"],[37,22,15,24],[37,25,15,27,"config"],[37,31,15,33],[37,32,15,34,"retryCount"],[37,42,15,44],[37,46,15,48,"retryCount_"],[37,57,15,59],[38,6,16,8],[38,12,16,14,"timeout"],[38,19,16,21],[38,22,16,24,"timeout_"],[38,30,16,32],[38,34,16,36,"config"],[38,40,16,42],[38,41,16,43,"timeout"],[38,48,16,50],[38,52,16,54],[38,58,16,60],[39,6,17,8],[39,12,17,14,"url_"],[39,16,17,18],[39,19,17,21,"url"],[39,22,17,24],[39,26,17,28,"chain"],[39,31,17,33],[39,33,17,35,"rpcUrls"],[39,40,17,42],[39,41,17,43,"default"],[39,48,17,50],[39,49,17,51,"http"],[39,53,17,55],[39,54,17,56],[39,55,17,57],[39,56,17,58],[40,6,18,8],[40,10,18,12],[40,11,18,13,"url_"],[40,15,18,17],[40,17,19,12],[40,23,19,18],[40,27,19,22,"UrlRequiredError"],[40,45,19,38],[40,46,19,38,"UrlRequiredError"],[40,62,19,38],[40,63,19,39],[40,64,19,40],[41,6,20,8],[41,12,20,14,"rpcClient"],[41,21,20,23],[41,24,20,26],[41,28,20,26,"getHttpRpcClient"],[41,43,20,42],[41,44,20,42,"getHttpRpcClient"],[41,60,20,42],[41,62,20,43,"url_"],[41,66,20,47],[41,68,20,49],[42,8,21,12,"fetchOptions"],[42,20,21,24],[43,8,22,12,"onRequest"],[43,17,22,21],[43,19,22,23,"onFetchRequest"],[43,33,22,37],[44,8,23,12,"onResponse"],[44,18,23,22],[44,20,23,24,"onFetchResponse"],[44,35,23,39],[45,8,24,12,"timeout"],[46,6,25,8],[46,7,25,9],[46,8,25,10],[47,6,26,8],[47,13,26,15],[47,17,26,15,"createTransport"],[47,35,26,30],[47,36,26,30,"createTransport"],[47,51,26,30],[47,53,26,31],[48,8,27,12,"key"],[48,11,27,15],[49,8,28,12,"methods"],[49,15,28,19],[50,8,29,12,"name"],[50,12,29,16],[51,8,30,12],[51,14,30,18,"request"],[51,21,30,25,"request"],[51,22,30,26],[52,10,30,28,"method"],[52,16,30,34],[53,10,30,36,"params"],[54,8,30,43],[54,9,30,44],[54,11,30,46],[55,10,31,16],[55,16,31,22,"body"],[55,20,31,26],[55,23,31,29],[56,12,31,31,"method"],[56,18,31,37],[57,12,31,39,"params"],[58,10,31,46],[58,11,31,47],[59,10,32,16],[59,16,32,22],[60,12,32,24,"schedule"],[61,10,32,33],[61,11,32,34],[61,14,32,37],[61,18,32,37,"createBatchScheduler"],[61,53,32,57],[61,54,32,57,"createBatchScheduler"],[61,74,32,57],[61,76,32,58],[62,12,33,20,"id"],[62,14,33,22],[62,16,33,24,"url_"],[62,20,33,28],[63,12,34,20,"wait"],[63,16,34,24],[64,12,35,20,"shouldSplitBatch"],[64,28,35,36,"shouldSplitBatch"],[64,29,35,37,"requests"],[64,37,35,45],[64,39,35,47],[65,14,36,24],[65,21,36,31,"requests"],[65,29,36,39],[65,30,36,40,"length"],[65,36,36,46],[65,39,36,49,"batchSize"],[65,48,36,58],[66,12,37,20],[66,13,37,21],[67,12,38,20,"fn"],[67,14,38,22],[67,16,38,25,"body"],[67,20,38,29],[67,24,38,34,"rpcClient"],[67,33,38,43],[67,34,38,44,"request"],[67,41,38,51],[67,42,38,52],[68,14,39,24,"body"],[69,12,40,20],[69,13,40,21],[69,14,40,22],[70,12,41,20,"sort"],[70,16,41,24],[70,18,41,26,"sort"],[70,19,41,27,"a"],[70,20,41,28],[70,22,41,30,"b"],[70,23,41,31],[70,28,41,36,"a"],[70,29,41,37],[70,30,41,38,"id"],[70,32,41,40],[70,35,41,43,"b"],[70,36,41,44],[70,37,41,45,"id"],[71,10,42,16],[71,11,42,17],[71,12,42,18],[72,10,43,16],[72,16,43,22,"fn"],[72,18,43,24],[72,21,43,27],[72,27,43,34,"body"],[72,31,43,38],[72,35,43,43,"batch"],[72,40,43,48],[72,43,44,22,"schedule"],[72,51,44,30],[72,52,44,31,"body"],[72,56,44,35],[72,57,44,36],[72,60,45,22],[72,61,46,24],[72,67,46,30,"rpcClient"],[72,76,46,39],[72,77,46,40,"request"],[72,84,46,47],[72,85,46,48],[73,12,47,28,"body"],[74,10,48,24],[74,11,48,25],[74,12,48,26],[74,13,49,21],[75,10,50,16],[75,16,50,22],[75,17,50,23],[76,12,50,25,"error"],[76,17,50,30],[77,12,50,32,"result"],[78,10,50,39],[78,11,50,40],[78,12,50,41],[78,15,50,44],[78,21,50,50,"fn"],[78,23,50,52],[78,24,50,53,"body"],[78,28,50,57],[78,29,50,58],[79,10,51,16],[79,14,51,20,"error"],[79,19,51,25],[79,21,52,20],[79,27,52,26],[79,31,52,30,"RpcRequestError"],[79,47,52,45],[79,48,52,45,"RpcRequestError"],[79,63,52,45],[79,64,52,46],[80,12,53,24,"body"],[80,16,53,28],[81,12,54,24,"error"],[81,17,54,29],[82,12,55,24,"url"],[82,15,55,27],[82,17,55,29,"url_"],[83,10,56,20],[83,11,56,21],[83,12,56,22],[84,10,57,16],[84,17,57,23,"result"],[84,23,57,29],[85,8,58,12],[85,9,58,13],[86,8,59,12,"retryCount"],[86,18,59,22],[87,8,60,12,"retryDelay"],[87,18,60,22],[88,8,61,12,"timeout"],[88,15,61,19],[89,8,62,12,"type"],[89,12,62,16],[89,14,62,18],[90,6,63,8],[90,7,63,9],[90,9,63,11],[91,8,64,12,"fetchOptions"],[91,20,64,24],[92,8,65,12,"url"],[92,11,65,15],[92,13,65,17,"url_"],[93,6,66,8],[93,7,66,9],[93,8,66,10],[94,4,67,4],[94,5,67,5],[95,2,68,0],[96,0,68,1],[96,3]],"functionMap":{"names":["<global>","http","<anonymous>","createTransport$argument_0.request","createBatchScheduler$argument_0.shouldSplitBatch","createBatchScheduler$argument_0.fn","createBatchScheduler$argument_0.sort","fn"],"mappings":"AAA;OCQ;WCI;YCiB;oBCK;qBDE;wBEC;sBFE;0BGC,qBH;2BIE;qBJM;aDS;KDS;CDC"},"hasCjsExports":false},"type":"js/module"}]}