{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.responseCache = exports.promiseCache = void 0;\n  exports.getCache = getCache;\n  exports.withCache = withCache;\n  exports.promiseCache = new Map();\n  exports.responseCache = new Map();\n  function getCache(cacheKey) {\n    const buildCache = (cacheKey, cache) => ({\n      clear: () => cache.delete(cacheKey),\n      get: () => cache.get(cacheKey),\n      set: data => cache.set(cacheKey, data)\n    });\n    const promise = buildCache(cacheKey, exports.promiseCache);\n    const response = buildCache(cacheKey, exports.responseCache);\n    return {\n      clear: () => {\n        promise.clear();\n        response.clear();\n      },\n      promise,\n      response\n    };\n  }\n  async function withCache(fn, {\n    cacheKey,\n    cacheTime = Number.POSITIVE_INFINITY\n  }) {\n    const cache = getCache(cacheKey);\n    const response = cache.response.get();\n    if (response && cacheTime > 0) {\n      const age = new Date().getTime() - response.created.getTime();\n      if (age < cacheTime) return response.data;\n    }\n    let promise = cache.promise.get();\n    if (!promise) {\n      promise = fn();\n      cache.promise.set(promise);\n    }\n    try {\n      const data = await promise;\n      cache.response.set({\n        created: new Date(),\n        data\n      });\n      return data;\n    } finally {\n      cache.promise.clear();\n    }\n  }\n});","lineCount":55,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"responseCache"],[7,23,3,21],[7,26,3,24,"exports"],[7,33,3,31],[7,34,3,32,"promiseCache"],[7,46,3,44],[7,49,3,47],[7,54,3,52],[7,55,3,53],[8,2,4,0,"exports"],[8,9,4,7],[8,10,4,8,"getCache"],[8,18,4,16],[8,21,4,19,"getCache"],[8,29,4,27],[9,2,5,0,"exports"],[9,9,5,7],[9,10,5,8,"withCache"],[9,19,5,17],[9,22,5,20,"withCache"],[9,31,5,29],[10,2,6,0,"exports"],[10,9,6,7],[10,10,6,8,"promiseCache"],[10,22,6,20],[10,25,6,23],[10,29,6,27,"Map"],[10,32,6,30],[10,33,6,31],[10,34,6,32],[11,2,7,0,"exports"],[11,9,7,7],[11,10,7,8,"responseCache"],[11,23,7,21],[11,26,7,24],[11,30,7,28,"Map"],[11,33,7,31],[11,34,7,32],[11,35,7,33],[12,2,8,0],[12,11,8,9,"getCache"],[12,19,8,17,"getCache"],[12,20,8,18,"cacheKey"],[12,28,8,26],[12,30,8,28],[13,4,9,4],[13,10,9,10,"buildCache"],[13,20,9,20],[13,23,9,23,"buildCache"],[13,24,9,24,"cacheKey"],[13,32,9,32],[13,34,9,34,"cache"],[13,39,9,39],[13,45,9,45],[14,6,10,8,"clear"],[14,11,10,13],[14,13,10,15,"clear"],[14,14,10,15],[14,19,10,21,"cache"],[14,24,10,26],[14,25,10,27,"delete"],[14,31,10,33],[14,32,10,34,"cacheKey"],[14,40,10,42],[14,41,10,43],[15,6,11,8,"get"],[15,9,11,11],[15,11,11,13,"get"],[15,12,11,13],[15,17,11,19,"cache"],[15,22,11,24],[15,23,11,25,"get"],[15,26,11,28],[15,27,11,29,"cacheKey"],[15,35,11,37],[15,36,11,38],[16,6,12,8,"set"],[16,9,12,11],[16,11,12,14,"data"],[16,15,12,18],[16,19,12,23,"cache"],[16,24,12,28],[16,25,12,29,"set"],[16,28,12,32],[16,29,12,33,"cacheKey"],[16,37,12,41],[16,39,12,43,"data"],[16,43,12,47],[17,4,13,4],[17,5,13,5],[17,6,13,6],[18,4,14,4],[18,10,14,10,"promise"],[18,17,14,17],[18,20,14,20,"buildCache"],[18,30,14,30],[18,31,14,31,"cacheKey"],[18,39,14,39],[18,41,14,41,"exports"],[18,48,14,48],[18,49,14,49,"promiseCache"],[18,61,14,61],[18,62,14,62],[19,4,15,4],[19,10,15,10,"response"],[19,18,15,18],[19,21,15,21,"buildCache"],[19,31,15,31],[19,32,15,32,"cacheKey"],[19,40,15,40],[19,42,15,42,"exports"],[19,49,15,49],[19,50,15,50,"responseCache"],[19,63,15,63],[19,64,15,64],[20,4,16,4],[20,11,16,11],[21,6,17,8,"clear"],[21,11,17,13],[21,13,17,15,"clear"],[21,14,17,15],[21,19,17,21],[22,8,18,12,"promise"],[22,15,18,19],[22,16,18,20,"clear"],[22,21,18,25],[22,22,18,26],[22,23,18,27],[23,8,19,12,"response"],[23,16,19,20],[23,17,19,21,"clear"],[23,22,19,26],[23,23,19,27],[23,24,19,28],[24,6,20,8],[24,7,20,9],[25,6,21,8,"promise"],[25,13,21,15],[26,6,22,8,"response"],[27,4,23,4],[27,5,23,5],[28,2,24,0],[29,2,25,0],[29,17,25,15,"withCache"],[29,26,25,24,"withCache"],[29,27,25,25,"fn"],[29,29,25,27],[29,31,25,29],[30,4,25,31,"cacheKey"],[30,12,25,39],[31,4,25,41,"cacheTime"],[31,13,25,50],[31,16,25,53,"Number"],[31,22,25,59],[31,23,25,60,"POSITIVE_INFINITY"],[32,2,25,78],[32,3,25,79],[32,5,25,81],[33,4,26,4],[33,10,26,10,"cache"],[33,15,26,15],[33,18,26,18,"getCache"],[33,26,26,26],[33,27,26,27,"cacheKey"],[33,35,26,35],[33,36,26,36],[34,4,27,4],[34,10,27,10,"response"],[34,18,27,18],[34,21,27,21,"cache"],[34,26,27,26],[34,27,27,27,"response"],[34,35,27,35],[34,36,27,36,"get"],[34,39,27,39],[34,40,27,40],[34,41,27,41],[35,4,28,4],[35,8,28,8,"response"],[35,16,28,16],[35,20,28,20,"cacheTime"],[35,29,28,29],[35,32,28,32],[35,33,28,33],[35,35,28,35],[36,6,29,8],[36,12,29,14,"age"],[36,15,29,17],[36,18,29,20],[36,22,29,24,"Date"],[36,26,29,28],[36,27,29,29],[36,28,29,30],[36,29,29,31,"getTime"],[36,36,29,38],[36,37,29,39],[36,38,29,40],[36,41,29,43,"response"],[36,49,29,51],[36,50,29,52,"created"],[36,57,29,59],[36,58,29,60,"getTime"],[36,65,29,67],[36,66,29,68],[36,67,29,69],[37,6,30,8],[37,10,30,12,"age"],[37,13,30,15],[37,16,30,18,"cacheTime"],[37,25,30,27],[37,27,31,12],[37,34,31,19,"response"],[37,42,31,27],[37,43,31,28,"data"],[37,47,31,32],[38,4,32,4],[39,4,33,4],[39,8,33,8,"promise"],[39,15,33,15],[39,18,33,18,"cache"],[39,23,33,23],[39,24,33,24,"promise"],[39,31,33,31],[39,32,33,32,"get"],[39,35,33,35],[39,36,33,36],[39,37,33,37],[40,4,34,4],[40,8,34,8],[40,9,34,9,"promise"],[40,16,34,16],[40,18,34,18],[41,6,35,8,"promise"],[41,13,35,15],[41,16,35,18,"fn"],[41,18,35,20],[41,19,35,21],[41,20,35,22],[42,6,36,8,"cache"],[42,11,36,13],[42,12,36,14,"promise"],[42,19,36,21],[42,20,36,22,"set"],[42,23,36,25],[42,24,36,26,"promise"],[42,31,36,33],[42,32,36,34],[43,4,37,4],[44,4,38,4],[44,8,38,8],[45,6,39,8],[45,12,39,14,"data"],[45,16,39,18],[45,19,39,21],[45,25,39,27,"promise"],[45,32,39,34],[46,6,40,8,"cache"],[46,11,40,13],[46,12,40,14,"response"],[46,20,40,22],[46,21,40,23,"set"],[46,24,40,26],[46,25,40,27],[47,8,40,29,"created"],[47,15,40,36],[47,17,40,38],[47,21,40,42,"Date"],[47,25,40,46],[47,26,40,47],[47,27,40,48],[48,8,40,50,"data"],[49,6,40,55],[49,7,40,56],[49,8,40,57],[50,6,41,8],[50,13,41,15,"data"],[50,17,41,19],[51,4,42,4],[51,5,42,5],[51,14,43,12],[52,6,44,8,"cache"],[52,11,44,13],[52,12,44,14,"promise"],[52,19,44,21],[52,20,44,22,"clear"],[52,25,44,27],[52,26,44,28],[52,27,44,29],[53,4,45,4],[54,2,46,0],[55,0,46,1],[55,3]],"functionMap":{"names":["<global>","getCache","buildCache","clear","get","set","withCache"],"mappings":"AAA;ACO;uBCC;eCC,4BD;aEC,yBF;aGC,mCH;MDC;eEI;SFG;CDI;AMC;CNqB"},"hasCjsExports":true},"type":"js/module"}]}