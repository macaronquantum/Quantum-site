{"dependencies":[{"name":"../../errors/request.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":84,"index":84}}],"key":"2pE/btc+6/9ceuRiPNwUYrtm86Y=","exportNames":["*"],"imports":1}},{"name":"./socket.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":85},"end":{"line":2,"column":50,"index":135}}],"key":"eFXiJ3xGWi9z9IR2MpLa1oE6lVc=","exportNames":["*"],"imports":1}},{"name":"isows","data":{"asyncType":"async","isESMImport":true,"locs":[{"start":{"line":7,"column":36,"index":383},"end":{"line":7,"column":51,"index":398}}],"key":"QtQ48QtBnZwN5dw4VoxUxf1ZWZU=","exportNames":["*"],"imports":1}},{"name":"expo/internal/async-require-module","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":36,"index":383},"end":{"line":7,"column":56,"index":403}}],"key":"y8mhXL4zKvSVvgnacXXOn0UU+QQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.getWebSocketRpcClient = getWebSocketRpcClient;\n  var _errorsRequestJs = require(_dependencyMap[0], \"../../errors/request.js\");\n  var _socketJs = require(_dependencyMap[1], \"./socket.js\");\n  async function getWebSocketRpcClient(url, options = {}) {\n    const {\n      keepAlive,\n      reconnect\n    } = options;\n    return (0, _socketJs.getSocketRpcClient)({\n      async getSocket({\n        onClose,\n        onError,\n        onOpen,\n        onResponse\n      }) {\n        const WebSocket = await require(_dependencyMap[3], \"expo/internal/async-require-module\")(_dependencyMap[2], _dependencyMap.paths, \"isows\").then(module => module.WebSocket);\n        const socket = new WebSocket(url);\n        function onClose_() {\n          socket.removeEventListener('close', onClose_);\n          socket.removeEventListener('message', onMessage);\n          socket.removeEventListener('error', onError);\n          socket.removeEventListener('open', onOpen);\n          onClose();\n        }\n        function onMessage({\n          data\n        }) {\n          onResponse(JSON.parse(data));\n        }\n        // Setup event listeners for RPC & subscription responses.\n        socket.addEventListener('close', onClose_);\n        socket.addEventListener('message', onMessage);\n        socket.addEventListener('error', onError);\n        socket.addEventListener('open', onOpen);\n        // Wait for the socket to open.\n        if (socket.readyState === WebSocket.CONNECTING) {\n          await new Promise((resolve, reject) => {\n            if (!socket) return;\n            socket.onopen = resolve;\n            socket.onerror = reject;\n          });\n        }\n        const {\n          close: close_\n        } = socket;\n        return Object.assign(socket, {\n          close() {\n            close_.bind(socket)();\n            onClose_();\n          },\n          ping() {\n            try {\n              if (socket.readyState === socket.CLOSED || socket.readyState === socket.CLOSING) throw new _errorsRequestJs.WebSocketRequestError({\n                url: socket.url,\n                cause: new _errorsRequestJs.SocketClosedError({\n                  url: socket.url\n                })\n              });\n              const body = {\n                jsonrpc: '2.0',\n                method: 'net_version',\n                params: []\n              };\n              socket.send(JSON.stringify(body));\n            } catch (error) {\n              onError(error);\n            }\n          },\n          request({\n            body\n          }) {\n            if (socket.readyState === socket.CLOSED || socket.readyState === socket.CLOSING) throw new _errorsRequestJs.WebSocketRequestError({\n              body,\n              url: socket.url,\n              cause: new _errorsRequestJs.SocketClosedError({\n                url: socket.url\n              })\n            });\n            return socket.send(JSON.stringify(body));\n          }\n        });\n      },\n      keepAlive,\n      reconnect,\n      url\n    });\n  }\n});","lineCount":94,"map":[[7,2,3,0,"exports"],[7,9,3,0],[7,10,3,0,"getWebSocketRpcClient"],[7,31,3,0],[7,34,3,0,"getWebSocketRpcClient"],[7,55,3,0],[8,2,1,0],[8,6,1,0,"_errorsRequestJs"],[8,22,1,0],[8,25,1,0,"require"],[8,32,1,0],[8,33,1,0,"_dependencyMap"],[8,47,1,0],[9,2,2,0],[9,6,2,0,"_socketJs"],[9,15,2,0],[9,18,2,0,"require"],[9,25,2,0],[9,26,2,0,"_dependencyMap"],[9,40,2,0],[10,2,3,7],[10,17,3,22,"getWebSocketRpcClient"],[10,38,3,43,"getWebSocketRpcClient"],[10,39,3,44,"url"],[10,42,3,47],[10,44,3,49,"options"],[10,51,3,56],[10,54,3,59],[10,55,3,60],[10,56,3,61],[10,58,3,63],[11,4,4,4],[11,10,4,10],[12,6,4,12,"keepAlive"],[12,15,4,21],[13,6,4,23,"reconnect"],[14,4,4,33],[14,5,4,34],[14,8,4,37,"options"],[14,15,4,44],[15,4,5,4],[15,11,5,11],[15,15,5,11,"getSocketRpcClient"],[15,24,5,29],[15,25,5,29,"getSocketRpcClient"],[15,43,5,29],[15,45,5,30],[16,6,6,8],[16,12,6,14,"getSocket"],[16,21,6,23,"getSocket"],[16,22,6,24],[17,8,6,26,"onClose"],[17,15,6,33],[18,8,6,35,"onError"],[18,15,6,42],[19,8,6,44,"onOpen"],[19,14,6,50],[20,8,6,52,"onResponse"],[21,6,6,63],[21,7,6,64],[21,9,6,66],[22,8,7,12],[22,14,7,18,"WebSocket"],[22,23,7,27],[22,26,7,30],[22,32,7,36,"require"],[22,39,7,36],[22,40,7,36,"_dependencyMap"],[22,54,7,36],[22,97,7,36,"_dependencyMap"],[22,111,7,36],[22,116,7,36,"_dependencyMap"],[22,130,7,36],[22,131,7,36,"paths"],[22,136,7,36],[22,147,7,52,"then"],[22,151,7,56],[22,152,7,58,"module"],[22,158,7,64],[22,162,7,69,"module"],[22,168,7,75],[22,169,7,76,"WebSocket"],[22,178,7,85],[22,179,7,86],[23,8,8,12],[23,14,8,18,"socket"],[23,20,8,24],[23,23,8,27],[23,27,8,31,"WebSocket"],[23,36,8,40],[23,37,8,41,"url"],[23,40,8,44],[23,41,8,45],[24,8,9,12],[24,17,9,21,"onClose_"],[24,25,9,29,"onClose_"],[24,26,9,29],[24,28,9,32],[25,10,10,16,"socket"],[25,16,10,22],[25,17,10,23,"removeEventListener"],[25,36,10,42],[25,37,10,43],[25,44,10,50],[25,46,10,52,"onClose_"],[25,54,10,60],[25,55,10,61],[26,10,11,16,"socket"],[26,16,11,22],[26,17,11,23,"removeEventListener"],[26,36,11,42],[26,37,11,43],[26,46,11,52],[26,48,11,54,"onMessage"],[26,57,11,63],[26,58,11,64],[27,10,12,16,"socket"],[27,16,12,22],[27,17,12,23,"removeEventListener"],[27,36,12,42],[27,37,12,43],[27,44,12,50],[27,46,12,52,"onError"],[27,53,12,59],[27,54,12,60],[28,10,13,16,"socket"],[28,16,13,22],[28,17,13,23,"removeEventListener"],[28,36,13,42],[28,37,13,43],[28,43,13,49],[28,45,13,51,"onOpen"],[28,51,13,57],[28,52,13,58],[29,10,14,16,"onClose"],[29,17,14,23],[29,18,14,24],[29,19,14,25],[30,8,15,12],[31,8,16,12],[31,17,16,21,"onMessage"],[31,26,16,30,"onMessage"],[31,27,16,31],[32,10,16,33,"data"],[33,8,16,38],[33,9,16,39],[33,11,16,41],[34,10,17,16,"onResponse"],[34,20,17,26],[34,21,17,27,"JSON"],[34,25,17,31],[34,26,17,32,"parse"],[34,31,17,37],[34,32,17,38,"data"],[34,36,17,42],[34,37,17,43],[34,38,17,44],[35,8,18,12],[36,8,19,12],[37,8,20,12,"socket"],[37,14,20,18],[37,15,20,19,"addEventListener"],[37,31,20,35],[37,32,20,36],[37,39,20,43],[37,41,20,45,"onClose_"],[37,49,20,53],[37,50,20,54],[38,8,21,12,"socket"],[38,14,21,18],[38,15,21,19,"addEventListener"],[38,31,21,35],[38,32,21,36],[38,41,21,45],[38,43,21,47,"onMessage"],[38,52,21,56],[38,53,21,57],[39,8,22,12,"socket"],[39,14,22,18],[39,15,22,19,"addEventListener"],[39,31,22,35],[39,32,22,36],[39,39,22,43],[39,41,22,45,"onError"],[39,48,22,52],[39,49,22,53],[40,8,23,12,"socket"],[40,14,23,18],[40,15,23,19,"addEventListener"],[40,31,23,35],[40,32,23,36],[40,38,23,42],[40,40,23,44,"onOpen"],[40,46,23,50],[40,47,23,51],[41,8,24,12],[42,8,25,12],[42,12,25,16,"socket"],[42,18,25,22],[42,19,25,23,"readyState"],[42,29,25,33],[42,34,25,38,"WebSocket"],[42,43,25,47],[42,44,25,48,"CONNECTING"],[42,54,25,58],[42,56,25,60],[43,10,26,16],[43,16,26,22],[43,20,26,26,"Promise"],[43,27,26,33],[43,28,26,34],[43,29,26,35,"resolve"],[43,36,26,42],[43,38,26,44,"reject"],[43,44,26,50],[43,49,26,55],[44,12,27,20],[44,16,27,24],[44,17,27,25,"socket"],[44,23,27,31],[44,25,28,24],[45,12,29,20,"socket"],[45,18,29,26],[45,19,29,27,"onopen"],[45,25,29,33],[45,28,29,36,"resolve"],[45,35,29,43],[46,12,30,20,"socket"],[46,18,30,26],[46,19,30,27,"onerror"],[46,26,30,34],[46,29,30,37,"reject"],[46,35,30,43],[47,10,31,16],[47,11,31,17],[47,12,31,18],[48,8,32,12],[49,8,33,12],[49,14,33,18],[50,10,33,20,"close"],[50,15,33,25],[50,17,33,27,"close_"],[51,8,33,34],[51,9,33,35],[51,12,33,38,"socket"],[51,18,33,44],[52,8,34,12],[52,15,34,19,"Object"],[52,21,34,25],[52,22,34,26,"assign"],[52,28,34,32],[52,29,34,33,"socket"],[52,35,34,39],[52,37,34,41],[53,10,35,16,"close"],[53,15,35,21,"close"],[53,16,35,21],[53,18,35,24],[54,12,36,20,"close_"],[54,18,36,26],[54,19,36,27,"bind"],[54,23,36,31],[54,24,36,32,"socket"],[54,30,36,38],[54,31,36,39],[54,32,36,40],[54,33,36,41],[55,12,37,20,"onClose_"],[55,20,37,28],[55,21,37,29],[55,22,37,30],[56,10,38,16],[56,11,38,17],[57,10,39,16,"ping"],[57,14,39,20,"ping"],[57,15,39,20],[57,17,39,23],[58,12,40,20],[58,16,40,24],[59,14,41,24],[59,18,41,28,"socket"],[59,24,41,34],[59,25,41,35,"readyState"],[59,35,41,45],[59,40,41,50,"socket"],[59,46,41,56],[59,47,41,57,"CLOSED"],[59,53,41,63],[59,57,42,28,"socket"],[59,63,42,34],[59,64,42,35,"readyState"],[59,74,42,45],[59,79,42,50,"socket"],[59,85,42,56],[59,86,42,57,"CLOSING"],[59,93,42,64],[59,95,43,28],[59,101,43,34],[59,105,43,38,"WebSocketRequestError"],[59,121,43,59],[59,122,43,59,"WebSocketRequestError"],[59,143,43,59],[59,144,43,60],[60,16,44,32,"url"],[60,19,44,35],[60,21,44,37,"socket"],[60,27,44,43],[60,28,44,44,"url"],[60,31,44,47],[61,16,45,32,"cause"],[61,21,45,37],[61,23,45,39],[61,27,45,43,"SocketClosedError"],[61,43,45,60],[61,44,45,60,"SocketClosedError"],[61,61,45,60],[61,62,45,61],[62,18,45,63,"url"],[62,21,45,66],[62,23,45,68,"socket"],[62,29,45,74],[62,30,45,75,"url"],[63,16,45,79],[63,17,45,80],[64,14,46,28],[64,15,46,29],[64,16,46,30],[65,14,47,24],[65,20,47,30,"body"],[65,24,47,34],[65,27,47,37],[66,16,48,28,"jsonrpc"],[66,23,48,35],[66,25,48,37],[66,30,48,42],[67,16,49,28,"method"],[67,22,49,34],[67,24,49,36],[67,37,49,49],[68,16,50,28,"params"],[68,22,50,34],[68,24,50,36],[69,14,51,24],[69,15,51,25],[70,14,52,24,"socket"],[70,20,52,30],[70,21,52,31,"send"],[70,25,52,35],[70,26,52,36,"JSON"],[70,30,52,40],[70,31,52,41,"stringify"],[70,40,52,50],[70,41,52,51,"body"],[70,45,52,55],[70,46,52,56],[70,47,52,57],[71,12,53,20],[71,13,53,21],[71,14,54,20],[71,21,54,27,"error"],[71,26,54,32],[71,28,54,34],[72,14,55,24,"onError"],[72,21,55,31],[72,22,55,32,"error"],[72,27,55,37],[72,28,55,38],[73,12,56,20],[74,10,57,16],[74,11,57,17],[75,10,58,16,"request"],[75,17,58,23,"request"],[75,18,58,24],[76,12,58,26,"body"],[77,10,58,31],[77,11,58,32],[77,13,58,34],[78,12,59,20],[78,16,59,24,"socket"],[78,22,59,30],[78,23,59,31,"readyState"],[78,33,59,41],[78,38,59,46,"socket"],[78,44,59,52],[78,45,59,53,"CLOSED"],[78,51,59,59],[78,55,60,24,"socket"],[78,61,60,30],[78,62,60,31,"readyState"],[78,72,60,41],[78,77,60,46,"socket"],[78,83,60,52],[78,84,60,53,"CLOSING"],[78,91,60,60],[78,93,61,24],[78,99,61,30],[78,103,61,34,"WebSocketRequestError"],[78,119,61,55],[78,120,61,55,"WebSocketRequestError"],[78,141,61,55],[78,142,61,56],[79,14,62,28,"body"],[79,18,62,32],[80,14,63,28,"url"],[80,17,63,31],[80,19,63,33,"socket"],[80,25,63,39],[80,26,63,40,"url"],[80,29,63,43],[81,14,64,28,"cause"],[81,19,64,33],[81,21,64,35],[81,25,64,39,"SocketClosedError"],[81,41,64,56],[81,42,64,56,"SocketClosedError"],[81,59,64,56],[81,60,64,57],[82,16,64,59,"url"],[82,19,64,62],[82,21,64,64,"socket"],[82,27,64,70],[82,28,64,71,"url"],[83,14,64,75],[83,15,64,76],[84,12,65,24],[84,13,65,25],[84,14,65,26],[85,12,66,20],[85,19,66,27,"socket"],[85,25,66,33],[85,26,66,34,"send"],[85,30,66,38],[85,31,66,39,"JSON"],[85,35,66,43],[85,36,66,44,"stringify"],[85,45,66,53],[85,46,66,54,"body"],[85,50,66,58],[85,51,66,59],[85,52,66,60],[86,10,67,16],[87,8,68,12],[87,9,68,13],[87,10,68,14],[88,6,69,8],[88,7,69,9],[89,6,70,8,"keepAlive"],[89,15,70,17],[90,6,71,8,"reconnect"],[90,15,71,17],[91,6,72,8,"url"],[92,4,73,4],[92,5,73,5],[92,6,73,6],[93,2,74,0],[94,0,74,1],[94,3]],"functionMap":{"names":["<global>","getWebSocketRpcClient","getSocketRpcClient$argument_0.getSocket","import.then$argument_0","onClose_","onMessage","Promise$argument_0","Object.assign$argument_1.close","Object.assign$argument_1.ping","Object.assign$argument_1.request"],"mappings":"AAA;OCE;QCG;yDCC,4BD;YEE;aFM;YGC;aHE;kCIQ;iBJK;gBKI;iBLG;gBMC;iBNkB;gBOC;iBPS;SDE;CDK"},"hasCjsExports":false},"type":"js/module"}]}