{"dependencies":[{"name":"@trezor/utils","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":16,"index":137},"end":{"line":7,"column":40,"index":161}}],"key":"G7HknzTAEB2ojZW8P0CsMCjZ1DA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.AbstractMessageChannel = void 0;\n  const utils_1 = require(_dependencyMap[0], \"@trezor/utils\");\n  class AbstractMessageChannel extends utils_1.TypedEmitter {\n    messagePromises = {};\n    messagesQueue = [];\n    messageID = 0;\n    isConnected = false;\n    handshakeMaxRetries = 5;\n    handshakeRetryInterval = 2000;\n    constructor({\n      sendFn,\n      channel,\n      logger,\n      lazyHandshake = false,\n      legacyMode = false\n    }) {\n      super();\n      this.channel = channel;\n      this.sendFn = sendFn;\n      this.lazyHandshake = lazyHandshake;\n      this.legacyMode = legacyMode;\n      this.logger = logger;\n    }\n    init() {\n      if (!this.handshakeFinished) {\n        this.handshakeFinished = (0, utils_1.createDeferred)();\n        if (this.legacyMode) {\n          setTimeout(() => {\n            this.handshakeFinished?.resolve();\n          }, 500);\n        }\n        if (!this.lazyHandshake) {\n          this.handshakeWithPeer();\n        }\n      }\n      return this.handshakeFinished.promise;\n    }\n    handshakeWithPeer() {\n      this.logger?.log(this.channel.here, 'handshake');\n      return (0, utils_1.scheduleAction)(async () => {\n        this.postMessage({\n          type: 'channel-handshake-request',\n          data: {\n            success: true,\n            payload: undefined\n          }\n        }, {\n          usePromise: false,\n          useQueue: false\n        });\n        await this.handshakeFinished?.promise;\n      }, {\n        attempts: this.handshakeMaxRetries,\n        timeout: this.handshakeRetryInterval\n      }).then(() => {\n        this.logger?.log(this.channel.here, 'handshake confirmed');\n        this.messagesQueue.forEach(message => {\n          message.channel = this.channel;\n          this.sendFn(message);\n        });\n        this.messagesQueue = [];\n      }).catch(() => {\n        this.handshakeFinished?.reject(new Error('handshake failed'));\n        this.handshakeFinished = undefined;\n      });\n    }\n    onMessage(_message) {\n      let message = _message;\n      if (this.legacyMode && message.type === undefined && 'data' in message && typeof message.data === 'object' && message.data !== null && 'type' in message.data && typeof message.data.type === 'string') {\n        message = message.data;\n      }\n      const {\n        channel,\n        id,\n        type,\n        ...data\n      } = message;\n      if (!this.legacyMode) {\n        if (!channel?.peer || channel.peer !== this.channel.here) {\n          return;\n        }\n        if (!channel?.here || this.channel.peer !== channel.here) {\n          return;\n        }\n      }\n      if (type === 'channel-handshake-request') {\n        this.postMessage({\n          type: 'channel-handshake-confirm',\n          data: {\n            success: true,\n            payload: undefined\n          }\n        }, {\n          usePromise: false,\n          useQueue: false\n        });\n        if (this.lazyHandshake) {\n          this.handshakeWithPeer();\n        }\n        return;\n      }\n      if (type === 'channel-handshake-confirm') {\n        this.handshakeFinished?.resolve(undefined);\n        return;\n      }\n      if (this.messagePromises[id]) {\n        this.messagePromises[id].resolve({\n          id,\n          ...data\n        });\n        delete this.messagePromises[id];\n      }\n      const messagePromisesLength = Object.keys(this.messagePromises).length;\n      if (messagePromisesLength > 5) {\n        this.logger?.warn(`too many message promises (${messagePromisesLength}). this feels unexpected!`);\n      }\n      this.emit('message', message);\n    }\n    postMessage(message, {\n      usePromise = true,\n      useQueue = true\n    } = {}) {\n      message.channel = this.channel;\n      if (!usePromise) {\n        try {\n          this.sendFn(message);\n        } catch {\n          if (useQueue) {\n            this.messagesQueue.push(message);\n          }\n        }\n        return;\n      }\n      this.messageID++;\n      message.id = this.messageID;\n      this.messagePromises[message.id] = (0, utils_1.createDeferred)();\n      try {\n        this.sendFn(message);\n      } catch {\n        if (useQueue) {\n          this.messagesQueue.push(message);\n        }\n      }\n      return this.messagePromises[message.id].promise;\n    }\n    resolveMessagePromises(resolvePayload) {\n      Object.keys(this.messagePromises).forEach(id => this.messagePromises[id].resolve({\n        id,\n        payload: resolvePayload\n      }));\n    }\n    clear() {\n      this.handshakeFinished = undefined;\n    }\n  }\n  exports.AbstractMessageChannel = AbstractMessageChannel;\n});","lineCount":163,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0,"Object"],[4,8,3,6],[4,9,3,7,"defineProperty"],[4,23,3,21],[4,24,3,22,"exports"],[4,31,3,29],[4,33,3,31],[4,45,3,43],[4,47,3,45],[5,4,4,2,"value"],[5,9,4,7],[5,11,4,9],[6,2,5,0],[6,3,5,1],[6,4,5,2],[7,2,6,0,"exports"],[7,9,6,7],[7,10,6,8,"AbstractMessageChannel"],[7,32,6,30],[7,35,6,33],[7,40,6,38],[7,41,6,39],[8,2,7,0],[8,8,7,6,"utils_1"],[8,15,7,13],[8,18,7,16,"require"],[8,25,7,23],[8,26,7,23,"_dependencyMap"],[8,40,7,23],[8,60,7,39],[8,61,7,40],[9,2,8,0],[9,8,8,6,"AbstractMessageChannel"],[9,30,8,28],[9,39,8,37,"utils_1"],[9,46,8,44],[9,47,8,45,"TypedEmitter"],[9,59,8,57],[9,60,8,58],[10,4,9,2,"messagePromises"],[10,19,9,17],[10,22,9,20],[10,23,9,21],[10,24,9,22],[11,4,10,2,"messagesQueue"],[11,17,10,15],[11,20,10,18],[11,22,10,20],[12,4,11,2,"messageID"],[12,13,11,11],[12,16,11,14],[12,17,11,15],[13,4,12,2,"isConnected"],[13,15,12,13],[13,18,12,16],[13,23,12,21],[14,4,13,2,"handshakeMaxRetries"],[14,23,13,21],[14,26,13,24],[14,27,13,25],[15,4,14,2,"handshakeRetryInterval"],[15,26,14,24],[15,29,14,27],[15,33,14,31],[16,4,21,2,"constructor"],[16,15,21,13,"constructor"],[16,16,21,14],[17,6,22,4,"sendFn"],[17,12,22,10],[18,6,23,4,"channel"],[18,13,23,11],[19,6,24,4,"logger"],[19,12,24,10],[20,6,25,4,"lazyHandshake"],[20,19,25,17],[20,22,25,20],[20,27,25,25],[21,6,26,4,"legacyMode"],[21,16,26,14],[21,19,26,17],[22,4,27,2],[22,5,27,3],[22,7,27,5],[23,6,28,4],[23,11,28,9],[23,12,28,10],[23,13,28,11],[24,6,29,4],[24,10,29,8],[24,11,29,9,"channel"],[24,18,29,16],[24,21,29,19,"channel"],[24,28,29,26],[25,6,30,4],[25,10,30,8],[25,11,30,9,"sendFn"],[25,17,30,15],[25,20,30,18,"sendFn"],[25,26,30,24],[26,6,31,4],[26,10,31,8],[26,11,31,9,"lazyHandshake"],[26,24,31,22],[26,27,31,25,"lazyHandshake"],[26,40,31,38],[27,6,32,4],[27,10,32,8],[27,11,32,9,"legacyMode"],[27,21,32,19],[27,24,32,22,"legacyMode"],[27,34,32,32],[28,6,33,4],[28,10,33,8],[28,11,33,9,"logger"],[28,17,33,15],[28,20,33,18,"logger"],[28,26,33,24],[29,4,34,2],[30,4,35,2,"init"],[30,8,35,6,"init"],[30,9,35,6],[30,11,35,9],[31,6,36,4],[31,10,36,8],[31,11,36,9],[31,15,36,13],[31,16,36,14,"handshakeFinished"],[31,33,36,31],[31,35,36,33],[32,8,37,6],[32,12,37,10],[32,13,37,11,"handshakeFinished"],[32,30,37,28],[32,33,37,31],[32,34,37,32],[32,35,37,33],[32,37,37,35,"utils_1"],[32,44,37,42],[32,45,37,43,"createDeferred"],[32,59,37,57],[32,61,37,59],[32,62,37,60],[33,8,38,6],[33,12,38,10],[33,16,38,14],[33,17,38,15,"legacyMode"],[33,27,38,25],[33,29,38,27],[34,10,39,8,"setTimeout"],[34,20,39,18],[34,21,39,19],[34,27,39,25],[35,12,40,10],[35,16,40,14],[35,17,40,15,"handshakeFinished"],[35,34,40,32],[35,36,40,34,"resolve"],[35,43,40,41],[35,44,40,42],[35,45,40,43],[36,10,41,8],[36,11,41,9],[36,13,41,11],[36,16,41,14],[36,17,41,15],[37,8,42,6],[38,8,43,6],[38,12,43,10],[38,13,43,11],[38,17,43,15],[38,18,43,16,"lazyHandshake"],[38,31,43,29],[38,33,43,31],[39,10,44,8],[39,14,44,12],[39,15,44,13,"handshakeWithPeer"],[39,32,44,30],[39,33,44,31],[39,34,44,32],[40,8,45,6],[41,6,46,4],[42,6,47,4],[42,13,47,11],[42,17,47,15],[42,18,47,16,"handshakeFinished"],[42,35,47,33],[42,36,47,34,"promise"],[42,43,47,41],[43,4,48,2],[44,4,49,2,"handshakeWithPeer"],[44,21,49,19,"handshakeWithPeer"],[44,22,49,19],[44,24,49,22],[45,6,50,4],[45,10,50,8],[45,11,50,9,"logger"],[45,17,50,15],[45,19,50,17,"log"],[45,22,50,20],[45,23,50,21],[45,27,50,25],[45,28,50,26,"channel"],[45,35,50,33],[45,36,50,34,"here"],[45,40,50,38],[45,42,50,40],[45,53,50,51],[45,54,50,52],[46,6,51,4],[46,13,51,11],[46,14,51,12],[46,15,51,13],[46,17,51,15,"utils_1"],[46,24,51,22],[46,25,51,23,"scheduleAction"],[46,39,51,37],[46,41,51,39],[46,53,51,51],[47,8,52,6],[47,12,52,10],[47,13,52,11,"postMessage"],[47,24,52,22],[47,25,52,23],[48,10,53,8,"type"],[48,14,53,12],[48,16,53,14],[48,43,53,41],[49,10,54,8,"data"],[49,14,54,12],[49,16,54,14],[50,12,55,10,"success"],[50,19,55,17],[50,21,55,19],[50,25,55,23],[51,12,56,10,"payload"],[51,19,56,17],[51,21,56,19,"undefined"],[52,10,57,8],[53,8,58,6],[53,9,58,7],[53,11,58,9],[54,10,59,8,"usePromise"],[54,20,59,18],[54,22,59,20],[54,27,59,25],[55,10,60,8,"useQueue"],[55,18,60,16],[55,20,60,18],[56,8,61,6],[56,9,61,7],[56,10,61,8],[57,8,62,6],[57,14,62,12],[57,18,62,16],[57,19,62,17,"handshakeFinished"],[57,36,62,34],[57,38,62,36,"promise"],[57,45,62,43],[58,6,63,4],[58,7,63,5],[58,9,63,7],[59,8,64,6,"attempts"],[59,16,64,14],[59,18,64,16],[59,22,64,20],[59,23,64,21,"handshakeMaxRetries"],[59,42,64,40],[60,8,65,6,"timeout"],[60,15,65,13],[60,17,65,15],[60,21,65,19],[60,22,65,20,"handshakeRetryInterval"],[61,6,66,4],[61,7,66,5],[61,8,66,6],[61,9,66,7,"then"],[61,13,66,11],[61,14,66,12],[61,20,66,18],[62,8,67,6],[62,12,67,10],[62,13,67,11,"logger"],[62,19,67,17],[62,21,67,19,"log"],[62,24,67,22],[62,25,67,23],[62,29,67,27],[62,30,67,28,"channel"],[62,37,67,35],[62,38,67,36,"here"],[62,42,67,40],[62,44,67,42],[62,65,67,63],[62,66,67,64],[63,8,68,6],[63,12,68,10],[63,13,68,11,"messagesQueue"],[63,26,68,24],[63,27,68,25,"forEach"],[63,34,68,32],[63,35,68,33,"message"],[63,42,68,40],[63,46,68,44],[64,10,69,8,"message"],[64,17,69,15],[64,18,69,16,"channel"],[64,25,69,23],[64,28,69,26],[64,32,69,30],[64,33,69,31,"channel"],[64,40,69,38],[65,10,70,8],[65,14,70,12],[65,15,70,13,"sendFn"],[65,21,70,19],[65,22,70,20,"message"],[65,29,70,27],[65,30,70,28],[66,8,71,6],[66,9,71,7],[66,10,71,8],[67,8,72,6],[67,12,72,10],[67,13,72,11,"messagesQueue"],[67,26,72,24],[67,29,72,27],[67,31,72,29],[68,6,73,4],[68,7,73,5],[68,8,73,6],[68,9,73,7,"catch"],[68,14,73,12],[68,15,73,13],[68,21,73,19],[69,8,74,6],[69,12,74,10],[69,13,74,11,"handshakeFinished"],[69,30,74,28],[69,32,74,30,"reject"],[69,38,74,36],[69,39,74,37],[69,43,74,41,"Error"],[69,48,74,46],[69,49,74,47],[69,67,74,65],[69,68,74,66],[69,69,74,67],[70,8,75,6],[70,12,75,10],[70,13,75,11,"handshakeFinished"],[70,30,75,28],[70,33,75,31,"undefined"],[70,42,75,40],[71,6,76,4],[71,7,76,5],[71,8,76,6],[72,4,77,2],[73,4,78,2,"onMessage"],[73,13,78,11,"onMessage"],[73,14,78,12,"_message"],[73,22,78,20],[73,24,78,22],[74,6,79,4],[74,10,79,8,"message"],[74,17,79,15],[74,20,79,18,"_message"],[74,28,79,26],[75,6,80,4],[75,10,80,8],[75,14,80,12],[75,15,80,13,"legacyMode"],[75,25,80,23],[75,29,80,27,"message"],[75,36,80,34],[75,37,80,35,"type"],[75,41,80,39],[75,46,80,44,"undefined"],[75,55,80,53],[75,59,80,57],[75,65,80,63],[75,69,80,67,"message"],[75,76,80,74],[75,80,80,78],[75,87,80,85,"message"],[75,94,80,92],[75,95,80,93,"data"],[75,99,80,97],[75,104,80,102],[75,112,80,110],[75,116,80,114,"message"],[75,123,80,121],[75,124,80,122,"data"],[75,128,80,126],[75,133,80,131],[75,137,80,135],[75,141,80,139],[75,147,80,145],[75,151,80,149,"message"],[75,158,80,156],[75,159,80,157,"data"],[75,163,80,161],[75,167,80,165],[75,174,80,172,"message"],[75,181,80,179],[75,182,80,180,"data"],[75,186,80,184],[75,187,80,185,"type"],[75,191,80,189],[75,196,80,194],[75,204,80,202],[75,206,80,204],[76,8,81,6,"message"],[76,15,81,13],[76,18,81,16,"message"],[76,25,81,23],[76,26,81,24,"data"],[76,30,81,28],[77,6,82,4],[78,6,83,4],[78,12,83,10],[79,8,84,6,"channel"],[79,15,84,13],[80,8,85,6,"id"],[80,10,85,8],[81,8,86,6,"type"],[81,12,86,10],[82,8,87,6],[82,11,87,9,"data"],[83,6,88,4],[83,7,88,5],[83,10,88,8,"message"],[83,17,88,15],[84,6,89,4],[84,10,89,8],[84,11,89,9],[84,15,89,13],[84,16,89,14,"legacyMode"],[84,26,89,24],[84,28,89,26],[85,8,90,6],[85,12,90,10],[85,13,90,11,"channel"],[85,20,90,18],[85,22,90,20,"peer"],[85,26,90,24],[85,30,90,28,"channel"],[85,37,90,35],[85,38,90,36,"peer"],[85,42,90,40],[85,47,90,45],[85,51,90,49],[85,52,90,50,"channel"],[85,59,90,57],[85,60,90,58,"here"],[85,64,90,62],[85,66,90,64],[86,10,91,8],[87,8,92,6],[88,8,93,6],[88,12,93,10],[88,13,93,11,"channel"],[88,20,93,18],[88,22,93,20,"here"],[88,26,93,24],[88,30,93,28],[88,34,93,32],[88,35,93,33,"channel"],[88,42,93,40],[88,43,93,41,"peer"],[88,47,93,45],[88,52,93,50,"channel"],[88,59,93,57],[88,60,93,58,"here"],[88,64,93,62],[88,66,93,64],[89,10,94,8],[90,8,95,6],[91,6,96,4],[92,6,97,4],[92,10,97,8,"type"],[92,14,97,12],[92,19,97,17],[92,46,97,44],[92,48,97,46],[93,8,98,6],[93,12,98,10],[93,13,98,11,"postMessage"],[93,24,98,22],[93,25,98,23],[94,10,99,8,"type"],[94,14,99,12],[94,16,99,14],[94,43,99,41],[95,10,100,8,"data"],[95,14,100,12],[95,16,100,14],[96,12,101,10,"success"],[96,19,101,17],[96,21,101,19],[96,25,101,23],[97,12,102,10,"payload"],[97,19,102,17],[97,21,102,19,"undefined"],[98,10,103,8],[99,8,104,6],[99,9,104,7],[99,11,104,9],[100,10,105,8,"usePromise"],[100,20,105,18],[100,22,105,20],[100,27,105,25],[101,10,106,8,"useQueue"],[101,18,106,16],[101,20,106,18],[102,8,107,6],[102,9,107,7],[102,10,107,8],[103,8,108,6],[103,12,108,10],[103,16,108,14],[103,17,108,15,"lazyHandshake"],[103,30,108,28],[103,32,108,30],[104,10,109,8],[104,14,109,12],[104,15,109,13,"handshakeWithPeer"],[104,32,109,30],[104,33,109,31],[104,34,109,32],[105,8,110,6],[106,8,111,6],[107,6,112,4],[108,6,113,4],[108,10,113,8,"type"],[108,14,113,12],[108,19,113,17],[108,46,113,44],[108,48,113,46],[109,8,114,6],[109,12,114,10],[109,13,114,11,"handshakeFinished"],[109,30,114,28],[109,32,114,30,"resolve"],[109,39,114,37],[109,40,114,38,"undefined"],[109,49,114,47],[109,50,114,48],[110,8,115,6],[111,6,116,4],[112,6,117,4],[112,10,117,8],[112,14,117,12],[112,15,117,13,"messagePromises"],[112,30,117,28],[112,31,117,29,"id"],[112,33,117,31],[112,34,117,32],[112,36,117,34],[113,8,118,6],[113,12,118,10],[113,13,118,11,"messagePromises"],[113,28,118,26],[113,29,118,27,"id"],[113,31,118,29],[113,32,118,30],[113,33,118,31,"resolve"],[113,40,118,38],[113,41,118,39],[114,10,119,8,"id"],[114,12,119,10],[115,10,120,8],[115,13,120,11,"data"],[116,8,121,6],[116,9,121,7],[116,10,121,8],[117,8,122,6],[117,15,122,13],[117,19,122,17],[117,20,122,18,"messagePromises"],[117,35,122,33],[117,36,122,34,"id"],[117,38,122,36],[117,39,122,37],[118,6,123,4],[119,6,124,4],[119,12,124,10,"messagePromisesLength"],[119,33,124,31],[119,36,124,34,"Object"],[119,42,124,40],[119,43,124,41,"keys"],[119,47,124,45],[119,48,124,46],[119,52,124,50],[119,53,124,51,"messagePromises"],[119,68,124,66],[119,69,124,67],[119,70,124,68,"length"],[119,76,124,74],[120,6,125,4],[120,10,125,8,"messagePromisesLength"],[120,31,125,29],[120,34,125,32],[120,35,125,33],[120,37,125,35],[121,8,126,6],[121,12,126,10],[121,13,126,11,"logger"],[121,19,126,17],[121,21,126,19,"warn"],[121,25,126,23],[121,26,126,24],[121,56,126,54,"messagePromisesLength"],[121,77,126,75],[121,104,126,102],[121,105,126,103],[122,6,127,4],[123,6,128,4],[123,10,128,8],[123,11,128,9,"emit"],[123,15,128,13],[123,16,128,14],[123,25,128,23],[123,27,128,25,"message"],[123,34,128,32],[123,35,128,33],[124,4,129,2],[125,4,130,2,"postMessage"],[125,15,130,13,"postMessage"],[125,16,130,14,"message"],[125,23,130,21],[125,25,130,23],[126,6,131,4,"usePromise"],[126,16,131,14],[126,19,131,17],[126,23,131,21],[127,6,132,4,"useQueue"],[127,14,132,12],[127,17,132,15],[128,4,133,2],[128,5,133,3],[128,8,133,6],[128,9,133,7],[128,10,133,8],[128,12,133,10],[129,6,134,4,"message"],[129,13,134,11],[129,14,134,12,"channel"],[129,21,134,19],[129,24,134,22],[129,28,134,26],[129,29,134,27,"channel"],[129,36,134,34],[130,6,135,4],[130,10,135,8],[130,11,135,9,"usePromise"],[130,21,135,19],[130,23,135,21],[131,8,136,6],[131,12,136,10],[132,10,137,8],[132,14,137,12],[132,15,137,13,"sendFn"],[132,21,137,19],[132,22,137,20,"message"],[132,29,137,27],[132,30,137,28],[133,8,138,6],[133,9,138,7],[133,10,138,8],[133,16,138,14],[134,10,139,8],[134,14,139,12,"useQueue"],[134,22,139,20],[134,24,139,22],[135,12,140,10],[135,16,140,14],[135,17,140,15,"messagesQueue"],[135,30,140,28],[135,31,140,29,"push"],[135,35,140,33],[135,36,140,34,"message"],[135,43,140,41],[135,44,140,42],[136,10,141,8],[137,8,142,6],[138,8,143,6],[139,6,144,4],[140,6,145,4],[140,10,145,8],[140,11,145,9,"messageID"],[140,20,145,18],[140,22,145,20],[141,6,146,4,"message"],[141,13,146,11],[141,14,146,12,"id"],[141,16,146,14],[141,19,146,17],[141,23,146,21],[141,24,146,22,"messageID"],[141,33,146,31],[142,6,147,4],[142,10,147,8],[142,11,147,9,"messagePromises"],[142,26,147,24],[142,27,147,25,"message"],[142,34,147,32],[142,35,147,33,"id"],[142,37,147,35],[142,38,147,36],[142,41,147,39],[142,42,147,40],[142,43,147,41],[142,45,147,43,"utils_1"],[142,52,147,50],[142,53,147,51,"createDeferred"],[142,67,147,65],[142,69,147,67],[142,70,147,68],[143,6,148,4],[143,10,148,8],[144,8,149,6],[144,12,149,10],[144,13,149,11,"sendFn"],[144,19,149,17],[144,20,149,18,"message"],[144,27,149,25],[144,28,149,26],[145,6,150,4],[145,7,150,5],[145,8,150,6],[145,14,150,12],[146,8,151,6],[146,12,151,10,"useQueue"],[146,20,151,18],[146,22,151,20],[147,10,152,8],[147,14,152,12],[147,15,152,13,"messagesQueue"],[147,28,152,26],[147,29,152,27,"push"],[147,33,152,31],[147,34,152,32,"message"],[147,41,152,39],[147,42,152,40],[148,8,153,6],[149,6,154,4],[150,6,155,4],[150,13,155,11],[150,17,155,15],[150,18,155,16,"messagePromises"],[150,33,155,31],[150,34,155,32,"message"],[150,41,155,39],[150,42,155,40,"id"],[150,44,155,42],[150,45,155,43],[150,46,155,44,"promise"],[150,53,155,51],[151,4,156,2],[152,4,157,2,"resolveMessagePromises"],[152,26,157,24,"resolveMessagePromises"],[152,27,157,25,"resolvePayload"],[152,41,157,39],[152,43,157,41],[153,6,158,4,"Object"],[153,12,158,10],[153,13,158,11,"keys"],[153,17,158,15],[153,18,158,16],[153,22,158,20],[153,23,158,21,"messagePromises"],[153,38,158,36],[153,39,158,37],[153,40,158,38,"forEach"],[153,47,158,45],[153,48,158,46,"id"],[153,50,158,48],[153,54,158,52],[153,58,158,56],[153,59,158,57,"messagePromises"],[153,74,158,72],[153,75,158,73,"id"],[153,77,158,75],[153,78,158,76],[153,79,158,77,"resolve"],[153,86,158,84],[153,87,158,85],[154,8,159,6,"id"],[154,10,159,8],[155,8,160,6,"payload"],[155,15,160,13],[155,17,160,15,"resolvePayload"],[156,6,161,4],[156,7,161,5],[156,8,161,6],[156,9,161,7],[157,4,162,2],[158,4,163,2,"clear"],[158,9,163,7,"clear"],[158,10,163,7],[158,12,163,10],[159,6,164,4],[159,10,164,8],[159,11,164,9,"handshakeFinished"],[159,28,164,26],[159,31,164,29,"undefined"],[159,40,164,38],[160,4,165,2],[161,2,166,0],[162,2,167,0,"exports"],[162,9,167,7],[162,10,167,8,"AbstractMessageChannel"],[162,32,167,30],[162,35,167,33,"AbstractMessageChannel"],[162,57,167,55],[163,0,167,56],[163,3]],"functionMap":{"names":["<global>","AbstractMessageChannel","AbstractMessageChannel#constructor","AbstractMessageChannel#init","setTimeout$argument_0","AbstractMessageChannel#handshakeWithPeer","<anonymous>","then$argument_0","messagesQueue.forEach$argument_0","then._catch$argument_0","AbstractMessageChannel#onMessage","AbstractMessageChannel#postMessage","AbstractMessageChannel#resolveMessagePromises","Object.keys.forEach$argument_0","AbstractMessageChannel#clear"],"mappings":"AAA;ACO;ECa;GDa;EEC;mBCI;SDE;GFO;EIC;uCCE;KDY;YEG;iCCE;ODG;KFE,QI;KJG;GJC;ESC;GTmD;EUC;GV0B;EWC;8CCC;MDG;GXC;EaC;GbE;CDC"},"hasCjsExports":true},"type":"js/module"}]}