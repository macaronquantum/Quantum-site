{"dependencies":[{"name":"../../utils/getAction.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":23,"index":161},"end":{"line":4,"column":58,"index":196}}],"key":"d685V9n1u7O1oRJ2ZbnkuLpcslA=","exportNames":["*"],"imports":1}},{"name":"../../utils/observe.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":21,"index":219},"end":{"line":5,"column":54,"index":252}}],"key":"NlEDsinWPPoPV3uHdXDCPvBuxx8=","exportNames":["*"],"imports":1}},{"name":"../../utils/poll.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":18,"index":272},"end":{"line":6,"column":48,"index":302}}],"key":"VGDCY0JetsesgNJKn2v/Q97mlvo=","exportNames":["*"],"imports":1}},{"name":"../../utils/stringify.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":23,"index":327},"end":{"line":7,"column":58,"index":362}}],"key":"o4d2CDgTn514XnsqOYcryKEOe1A=","exportNames":["*"],"imports":1}},{"name":"./createPendingTransactionFilter.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":44,"index":408},"end":{"line":8,"column":90,"index":454}}],"key":"1LuOdCLk4tkPtJ/W2xfqrSQ4Xho=","exportNames":["*"],"imports":1}},{"name":"./getFilterChanges.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":9,"column":30,"index":486},"end":{"line":9,"column":62,"index":518}}],"key":"GUIk7VL7OKREeYj4rJfECzzhnZQ=","exportNames":["*"],"imports":1}},{"name":"./uninstallFilter.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":10,"column":29,"index":549},"end":{"line":10,"column":60,"index":580}}],"key":"24TFPkjx+osNgjqGLLaNULbtZHY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.watchPendingTransactions = watchPendingTransactions;\n  const getAction_js_1 = require(_dependencyMap[0], \"../../utils/getAction.js\");\n  const observe_js_1 = require(_dependencyMap[1], \"../../utils/observe.js\");\n  const poll_js_1 = require(_dependencyMap[2], \"../../utils/poll.js\");\n  const stringify_js_1 = require(_dependencyMap[3], \"../../utils/stringify.js\");\n  const createPendingTransactionFilter_js_1 = require(_dependencyMap[4], \"./createPendingTransactionFilter.js\");\n  const getFilterChanges_js_1 = require(_dependencyMap[5], \"./getFilterChanges.js\");\n  const uninstallFilter_js_1 = require(_dependencyMap[6], \"./uninstallFilter.js\");\n  function watchPendingTransactions(client, {\n    batch = true,\n    onError,\n    onTransactions,\n    poll: poll_,\n    pollingInterval = client.pollingInterval\n  }) {\n    const enablePolling = typeof poll_ !== 'undefined' ? poll_ : client.transport.type !== 'webSocket';\n    const pollPendingTransactions = () => {\n      const observerId = (0, stringify_js_1.stringify)(['watchPendingTransactions', client.uid, batch, pollingInterval]);\n      return (0, observe_js_1.observe)(observerId, {\n        onTransactions,\n        onError\n      }, emit => {\n        let filter;\n        const unwatch = (0, poll_js_1.poll)(async () => {\n          try {\n            if (!filter) {\n              try {\n                filter = await (0, getAction_js_1.getAction)(client, createPendingTransactionFilter_js_1.createPendingTransactionFilter, 'createPendingTransactionFilter')({});\n                return;\n              } catch (err) {\n                unwatch();\n                throw err;\n              }\n            }\n            const hashes = await (0, getAction_js_1.getAction)(client, getFilterChanges_js_1.getFilterChanges, 'getFilterChanges')({\n              filter\n            });\n            if (hashes.length === 0) return;\n            if (batch) emit.onTransactions(hashes);else for (const hash of hashes) emit.onTransactions([hash]);\n          } catch (err) {\n            emit.onError?.(err);\n          }\n        }, {\n          emitOnBegin: true,\n          interval: pollingInterval\n        });\n        return async () => {\n          if (filter) await (0, getAction_js_1.getAction)(client, uninstallFilter_js_1.uninstallFilter, 'uninstallFilter')({\n            filter\n          });\n          unwatch();\n        };\n      });\n    };\n    const subscribePendingTransactions = () => {\n      let active = true;\n      let unsubscribe = () => active = false;\n      (async () => {\n        try {\n          const {\n            unsubscribe: unsubscribe_\n          } = await client.transport.subscribe({\n            params: ['newPendingTransactions'],\n            onData(data) {\n              if (!active) return;\n              const transaction = data.result;\n              onTransactions([transaction]);\n            },\n            onError(error) {\n              onError?.(error);\n            }\n          });\n          unsubscribe = unsubscribe_;\n          if (!active) unsubscribe();\n        } catch (err) {\n          onError?.(err);\n        }\n      })();\n      return () => unsubscribe();\n    };\n    return enablePolling ? pollPendingTransactions() : subscribePendingTransactions();\n  }\n});","lineCount":89,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"watchPendingTransactions"],[7,34,3,32],[7,37,3,35,"watchPendingTransactions"],[7,61,3,59],[8,2,4,0],[8,8,4,6,"getAction_js_1"],[8,22,4,20],[8,25,4,23,"require"],[8,32,4,30],[8,33,4,30,"_dependencyMap"],[8,47,4,30],[8,78,4,57],[8,79,4,58],[9,2,5,0],[9,8,5,6,"observe_js_1"],[9,20,5,18],[9,23,5,21,"require"],[9,30,5,28],[9,31,5,28,"_dependencyMap"],[9,45,5,28],[9,74,5,53],[9,75,5,54],[10,2,6,0],[10,8,6,6,"poll_js_1"],[10,17,6,15],[10,20,6,18,"require"],[10,27,6,25],[10,28,6,25,"_dependencyMap"],[10,42,6,25],[10,68,6,47],[10,69,6,48],[11,2,7,0],[11,8,7,6,"stringify_js_1"],[11,22,7,20],[11,25,7,23,"require"],[11,32,7,30],[11,33,7,30,"_dependencyMap"],[11,47,7,30],[11,78,7,57],[11,79,7,58],[12,2,8,0],[12,8,8,6,"createPendingTransactionFilter_js_1"],[12,43,8,41],[12,46,8,44,"require"],[12,53,8,51],[12,54,8,51,"_dependencyMap"],[12,68,8,51],[12,110,8,89],[12,111,8,90],[13,2,9,0],[13,8,9,6,"getFilterChanges_js_1"],[13,29,9,27],[13,32,9,30,"require"],[13,39,9,37],[13,40,9,37,"_dependencyMap"],[13,54,9,37],[13,82,9,61],[13,83,9,62],[14,2,10,0],[14,8,10,6,"uninstallFilter_js_1"],[14,28,10,26],[14,31,10,29,"require"],[14,38,10,36],[14,39,10,36,"_dependencyMap"],[14,53,10,36],[14,80,10,59],[14,81,10,60],[15,2,11,0],[15,11,11,9,"watchPendingTransactions"],[15,35,11,33,"watchPendingTransactions"],[15,36,11,34,"client"],[15,42,11,40],[15,44,11,42],[16,4,11,44,"batch"],[16,9,11,49],[16,12,11,52],[16,16,11,56],[17,4,11,58,"onError"],[17,11,11,65],[18,4,11,67,"onTransactions"],[18,18,11,81],[19,4,11,83,"poll"],[19,8,11,87],[19,10,11,89,"poll_"],[19,15,11,94],[20,4,11,96,"pollingInterval"],[20,19,11,111],[20,22,11,114,"client"],[20,28,11,120],[20,29,11,121,"pollingInterval"],[21,2,11,138],[21,3,11,139],[21,5,11,141],[22,4,12,4],[22,10,12,10,"enablePolling"],[22,23,12,23],[22,26,12,26],[22,33,12,33,"poll_"],[22,38,12,38],[22,43,12,43],[22,54,12,54],[22,57,12,57,"poll_"],[22,62,12,62],[22,65,12,65,"client"],[22,71,12,71],[22,72,12,72,"transport"],[22,81,12,81],[22,82,12,82,"type"],[22,86,12,86],[22,91,12,91],[22,102,12,102],[23,4,13,4],[23,10,13,10,"pollPendingTransactions"],[23,33,13,33],[23,36,13,36,"pollPendingTransactions"],[23,37,13,36],[23,42,13,42],[24,6,14,8],[24,12,14,14,"observerId"],[24,22,14,24],[24,25,14,27],[24,26,14,28],[24,27,14,29],[24,29,14,31,"stringify_js_1"],[24,43,14,45],[24,44,14,46,"stringify"],[24,53,14,55],[24,55,14,57],[24,56,15,12],[24,82,15,38],[24,84,16,12,"client"],[24,90,16,18],[24,91,16,19,"uid"],[24,94,16,22],[24,96,17,12,"batch"],[24,101,17,17],[24,103,18,12,"pollingInterval"],[24,118,18,27],[24,119,19,9],[24,120,19,10],[25,6,20,8],[25,13,20,15],[25,14,20,16],[25,15,20,17],[25,17,20,19,"observe_js_1"],[25,29,20,31],[25,30,20,32,"observe"],[25,37,20,39],[25,39,20,41,"observerId"],[25,49,20,51],[25,51,20,53],[26,8,20,55,"onTransactions"],[26,22,20,69],[27,8,20,71,"onError"],[28,6,20,79],[28,7,20,80],[28,9,20,83,"emit"],[28,13,20,87],[28,17,20,92],[29,8,21,12],[29,12,21,16,"filter"],[29,18,21,22],[30,8,22,12],[30,14,22,18,"unwatch"],[30,21,22,25],[30,24,22,28],[30,25,22,29],[30,26,22,30],[30,28,22,32,"poll_js_1"],[30,37,22,41],[30,38,22,42,"poll"],[30,42,22,46],[30,44,22,48],[30,56,22,60],[31,10,23,16],[31,14,23,20],[32,12,24,20],[32,16,24,24],[32,17,24,25,"filter"],[32,23,24,31],[32,25,24,33],[33,14,25,24],[33,18,25,28],[34,16,26,28,"filter"],[34,22,26,34],[34,25,26,37],[34,31,26,43],[34,32,26,44],[34,33,26,45],[34,35,26,47,"getAction_js_1"],[34,49,26,61],[34,50,26,62,"getAction"],[34,59,26,71],[34,61,26,73,"client"],[34,67,26,79],[34,69,26,81,"createPendingTransactionFilter_js_1"],[34,104,26,116],[34,105,26,117,"createPendingTransactionFilter"],[34,135,26,147],[34,137,26,149],[34,169,26,181],[34,170,26,182],[34,171,26,183],[34,172,26,184],[34,173,26,185],[34,174,26,186],[35,16,27,28],[36,14,28,24],[36,15,28,25],[36,16,29,24],[36,23,29,31,"err"],[36,26,29,34],[36,28,29,36],[37,16,30,28,"unwatch"],[37,23,30,35],[37,24,30,36],[37,25,30,37],[38,16,31,28],[38,22,31,34,"err"],[38,25,31,37],[39,14,32,24],[40,12,33,20],[41,12,34,20],[41,18,34,26,"hashes"],[41,24,34,32],[41,27,34,35],[41,33,34,41],[41,34,34,42],[41,35,34,43],[41,37,34,45,"getAction_js_1"],[41,51,34,59],[41,52,34,60,"getAction"],[41,61,34,69],[41,63,34,71,"client"],[41,69,34,77],[41,71,34,79,"getFilterChanges_js_1"],[41,92,34,100],[41,93,34,101,"getFilterChanges"],[41,109,34,117],[41,111,34,119],[41,129,34,137],[41,130,34,138],[41,131,34,139],[42,14,34,141,"filter"],[43,12,34,148],[43,13,34,149],[43,14,34,150],[44,12,35,20],[44,16,35,24,"hashes"],[44,22,35,30],[44,23,35,31,"length"],[44,29,35,37],[44,34,35,42],[44,35,35,43],[44,37,36,24],[45,12,37,20],[45,16,37,24,"batch"],[45,21,37,29],[45,23,38,24,"emit"],[45,27,38,28],[45,28,38,29,"onTransactions"],[45,42,38,43],[45,43,38,44,"hashes"],[45,49,38,50],[45,50,38,51],[45,51,38,52],[45,56,40,24],[45,61,40,29],[45,67,40,35,"hash"],[45,71,40,39],[45,75,40,43,"hashes"],[45,81,40,49],[45,83,41,28,"emit"],[45,87,41,32],[45,88,41,33,"onTransactions"],[45,102,41,47],[45,103,41,48],[45,104,41,49,"hash"],[45,108,41,53],[45,109,41,54],[45,110,41,55],[46,10,42,16],[46,11,42,17],[46,12,43,16],[46,19,43,23,"err"],[46,22,43,26],[46,24,43,28],[47,12,44,20,"emit"],[47,16,44,24],[47,17,44,25,"onError"],[47,24,44,32],[47,27,44,35,"err"],[47,30,44,38],[47,31,44,39],[48,10,45,16],[49,8,46,12],[49,9,46,13],[49,11,46,15],[50,10,47,16,"emitOnBegin"],[50,21,47,27],[50,23,47,29],[50,27,47,33],[51,10,48,16,"interval"],[51,18,48,24],[51,20,48,26,"pollingInterval"],[52,8,49,12],[52,9,49,13],[52,10,49,14],[53,8,50,12],[53,15,50,19],[53,27,50,31],[54,10,51,16],[54,14,51,20,"filter"],[54,20,51,26],[54,22,52,20],[54,28,52,26],[54,29,52,27],[54,30,52,28],[54,32,52,30,"getAction_js_1"],[54,46,52,44],[54,47,52,45,"getAction"],[54,56,52,54],[54,58,52,56,"client"],[54,64,52,62],[54,66,52,64,"uninstallFilter_js_1"],[54,86,52,84],[54,87,52,85,"uninstallFilter"],[54,102,52,100],[54,104,52,102],[54,121,52,119],[54,122,52,120],[54,123,52,121],[55,12,52,123,"filter"],[56,10,52,130],[56,11,52,131],[56,12,52,132],[57,10,53,16,"unwatch"],[57,17,53,23],[57,18,53,24],[57,19,53,25],[58,8,54,12],[58,9,54,13],[59,6,55,8],[59,7,55,9],[59,8,55,10],[60,4,56,4],[60,5,56,5],[61,4,57,4],[61,10,57,10,"subscribePendingTransactions"],[61,38,57,38],[61,41,57,41,"subscribePendingTransactions"],[61,42,57,41],[61,47,57,47],[62,6,58,8],[62,10,58,12,"active"],[62,16,58,18],[62,19,58,21],[62,23,58,25],[63,6,59,8],[63,10,59,12,"unsubscribe"],[63,21,59,23],[63,24,59,26,"unsubscribe"],[63,25,59,26],[63,30,59,33,"active"],[63,36,59,39],[63,39,59,42],[63,44,59,48],[64,6,60,8],[64,7,60,9],[64,19,60,21],[65,8,61,12],[65,12,61,16],[66,10,62,16],[66,16,62,22],[67,12,62,24,"unsubscribe"],[67,23,62,35],[67,25,62,37,"unsubscribe_"],[68,10,62,50],[68,11,62,51],[68,14,62,54],[68,20,62,60,"client"],[68,26,62,66],[68,27,62,67,"transport"],[68,36,62,76],[68,37,62,77,"subscribe"],[68,46,62,86],[68,47,62,87],[69,12,63,20,"params"],[69,18,63,26],[69,20,63,28],[69,21,63,29],[69,45,63,53],[69,46,63,54],[70,12,64,20,"onData"],[70,18,64,26,"onData"],[70,19,64,27,"data"],[70,23,64,31],[70,25,64,33],[71,14,65,24],[71,18,65,28],[71,19,65,29,"active"],[71,25,65,35],[71,27,66,28],[72,14,67,24],[72,20,67,30,"transaction"],[72,31,67,41],[72,34,67,44,"data"],[72,38,67,48],[72,39,67,49,"result"],[72,45,67,55],[73,14,68,24,"onTransactions"],[73,28,68,38],[73,29,68,39],[73,30,68,40,"transaction"],[73,41,68,51],[73,42,68,52],[73,43,68,53],[74,12,69,20],[74,13,69,21],[75,12,70,20,"onError"],[75,19,70,27,"onError"],[75,20,70,28,"error"],[75,25,70,33],[75,27,70,35],[76,14,71,24,"onError"],[76,21,71,31],[76,24,71,34,"error"],[76,29,71,39],[76,30,71,40],[77,12,72,20],[78,10,73,16],[78,11,73,17],[78,12,73,18],[79,10,74,16,"unsubscribe"],[79,21,74,27],[79,24,74,30,"unsubscribe_"],[79,36,74,42],[80,10,75,16],[80,14,75,20],[80,15,75,21,"active"],[80,21,75,27],[80,23,76,20,"unsubscribe"],[80,34,76,31],[80,35,76,32],[80,36,76,33],[81,8,77,12],[81,9,77,13],[81,10,78,12],[81,17,78,19,"err"],[81,20,78,22],[81,22,78,24],[82,10,79,16,"onError"],[82,17,79,23],[82,20,79,26,"err"],[82,23,79,29],[82,24,79,30],[83,8,80,12],[84,6,81,8],[84,7,81,9],[84,9,81,11],[84,10,81,12],[85,6,82,8],[85,13,82,15],[85,19,82,21,"unsubscribe"],[85,30,82,32],[85,31,82,33],[85,32,82,34],[86,4,83,4],[86,5,83,5],[87,4,84,4],[87,11,84,11,"enablePolling"],[87,24,84,24],[87,27,85,10,"pollPendingTransactions"],[87,50,85,33],[87,51,85,34],[87,52,85,35],[87,55,86,10,"subscribePendingTransactions"],[87,83,86,38],[87,84,86,39],[87,85,86,40],[88,2,87,0],[89,0,87,1],[89,3]],"functionMap":{"names":["<global>","watchPendingTransactions","pollPendingTransactions","<anonymous>","subscribePendingTransactions","unsubscribe","client.transport.subscribe$argument_0.onData","client.transport.subscribe$argument_0.onError"],"mappings":"AAA;ACU;oCCE;kFCO;SDmC;KDC;yCGC;0BCE,sBD;SDC;oBGI;qBHK;oBIC;qBJE;SCS;eDC,mBC;KHC;CDI"},"hasCjsExports":true},"type":"js/module"}]}