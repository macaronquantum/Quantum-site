{"dependencies":[{"name":"../../ours/primordials","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":66,"column":41,"index":3538},"end":{"line":66,"column":74,"index":3571}}],"key":"NYjhRIk1YfVwfaQSeITMV+mboSc=","exportNames":["*"],"imports":1}},{"name":"../../ours/errors","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":68,"column":39,"index":3638},"end":{"line":68,"column":67,"index":3666}}],"key":"1gsl/vMwrKGa5aYfNtCHl6fAfek=","exportNames":["*"],"imports":1}},{"name":"./duplex","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":69,"column":15,"index":3688},"end":{"line":69,"column":34,"index":3707}}],"key":"QWK3BJsJksw3+kI+b1qAeCz4AKc=","exportNames":["*"],"imports":1}},{"name":"./state","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":70,"column":29,"index":3737},"end":{"line":70,"column":47,"index":3755}}],"key":"/X11qJ81yEcBhLP+mZ7eVgw5yjQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  // Copyright Joyent, Inc. and other Node contributors.\n  //\n  // Permission is hereby granted, free of charge, to any person obtaining a\n  // copy of this software and associated documentation files (the\n  // \"Software\"), to deal in the Software without restriction, including\n  // without limitation the rights to use, copy, modify, merge, publish,\n  // distribute, sublicense, and/or sell copies of the Software, and to permit\n  // persons to whom the Software is furnished to do so, subject to the\n  // following conditions:\n  //\n  // The above copyright notice and this permission notice shall be included\n  // in all copies or substantial portions of the Software.\n  //\n  // THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n  // OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  // MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n  // NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n  // DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n  // USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n  // a transform stream is a readable/writable stream where you do\n  // something with the data.  Sometimes it's called a \"filter\",\n  // but that's not a great name for it, since that implies a thing where\n  // some bits pass through, and others are simply ignored.  (That would\n  // be a valid example of a transform, of course.)\n  //\n  // While the output is causally related to the input, it's not a\n  // necessarily symmetric or synchronous transformation.  For example,\n  // a zlib stream might take multiple plain-text writes(), and then\n  // emit a single compressed chunk some time in the future.\n  //\n  // Here's how this works:\n  //\n  // The Transform stream has all the aspects of the readable and writable\n  // stream classes.  When you write(chunk), that calls _write(chunk,cb)\n  // internally, and returns false if there's a lot of pending writes\n  // buffered up.  When you call read(), that calls _read(n) until\n  // there's enough pending readable data buffered up.\n  //\n  // In a transform stream, the written data is placed in a buffer.  When\n  // _read(n) is called, it transforms the queued up data, calling the\n  // buffered _write cb's as it consumes chunks.  If consuming a single\n  // written chunk would result in multiple output chunks, then the first\n  // outputted bit calls the readcb, and subsequent chunks just go into\n  // the read buffer, and will cause it to emit 'readable' if necessary.\n  //\n  // This way, back-pressure is actually determined by the reading side,\n  // since _read has to be called to start processing a new chunk.  However,\n  // a pathological inflate type of transform can cause excessive buffering\n  // here.  For example, imagine a stream where every byte of input is\n  // interpreted as an integer from 0-255, and then results in that many\n  // bytes of output.  Writing the 4 bytes {ff,ff,ff,ff} would result in\n  // 1kb of data being output.  In this case, you could write a very small\n  // amount of input, and end up with a very large amount of output.  In\n  // such a pathological inflating mechanism, there'd be no way to tell\n  // the system to stop doing the transform.  A single 4MB write could\n  // cause the system to run out of memory.\n  //\n  // However, even in such a pathological case, only a single written chunk\n  // would be consumed, and then the rest would wait (un-transformed) until\n  // the results of the previous transformed chunk were consumed.\n\n  'use strict';\n\n  const {\n    ObjectSetPrototypeOf,\n    Symbol\n  } = require(_dependencyMap[0], \"../../ours/primordials\");\n  module.exports = Transform;\n  const {\n    ERR_METHOD_NOT_IMPLEMENTED\n  } = require(_dependencyMap[1], \"../../ours/errors\").codes;\n  const Duplex = require(_dependencyMap[2], \"./duplex\");\n  const {\n    getHighWaterMark\n  } = require(_dependencyMap[3], \"./state\");\n  ObjectSetPrototypeOf(Transform.prototype, Duplex.prototype);\n  ObjectSetPrototypeOf(Transform, Duplex);\n  const kCallback = Symbol('kCallback');\n  function Transform(options) {\n    if (!(this instanceof Transform)) return new Transform(options);\n\n    // TODO (ronag): This should preferably always be\n    // applied but would be semver-major. Or even better;\n    // make Transform a Readable with the Writable interface.\n    const readableHighWaterMark = options ? getHighWaterMark(this, options, 'readableHighWaterMark', true) : null;\n    if (readableHighWaterMark === 0) {\n      // A Duplex will buffer both on the writable and readable side while\n      // a Transform just wants to buffer hwm number of elements. To avoid\n      // buffering twice we disable buffering on the writable side.\n      options = {\n        ...options,\n        highWaterMark: null,\n        readableHighWaterMark,\n        // TODO (ronag): 0 is not optimal since we have\n        // a \"bug\" where we check needDrain before calling _write and not after.\n        // Refs: https://github.com/nodejs/node/pull/32887\n        // Refs: https://github.com/nodejs/node/pull/35941\n        writableHighWaterMark: options.writableHighWaterMark || 0\n      };\n    }\n    Duplex.call(this, options);\n\n    // We have implemented the _read method, and done the other things\n    // that Readable wants before the first _read call, so unset the\n    // sync guard flag.\n    this._readableState.sync = false;\n    this[kCallback] = null;\n    if (options) {\n      if (typeof options.transform === 'function') this._transform = options.transform;\n      if (typeof options.flush === 'function') this._flush = options.flush;\n    }\n\n    // When the writable side finishes, then flush out anything remaining.\n    // Backwards compat. Some Transform streams incorrectly implement _final\n    // instead of or in addition to _flush. By using 'prefinish' instead of\n    // implementing _final we continue supporting this unfortunate use case.\n    this.on('prefinish', prefinish);\n  }\n  function final(cb) {\n    if (typeof this._flush === 'function' && !this.destroyed) {\n      this._flush((er, data) => {\n        if (er) {\n          if (cb) {\n            cb(er);\n          } else {\n            this.destroy(er);\n          }\n          return;\n        }\n        if (data != null) {\n          this.push(data);\n        }\n        this.push(null);\n        if (cb) {\n          cb();\n        }\n      });\n    } else {\n      this.push(null);\n      if (cb) {\n        cb();\n      }\n    }\n  }\n  function prefinish() {\n    if (this._final !== final) {\n      final.call(this);\n    }\n  }\n  Transform.prototype._final = final;\n  Transform.prototype._transform = function (chunk, encoding, callback) {\n    throw new ERR_METHOD_NOT_IMPLEMENTED('_transform()');\n  };\n  Transform.prototype._write = function (chunk, encoding, callback) {\n    const rState = this._readableState;\n    const wState = this._writableState;\n    const length = rState.length;\n    this._transform(chunk, encoding, (err, val) => {\n      if (err) {\n        callback(err);\n        return;\n      }\n      if (val != null) {\n        this.push(val);\n      }\n      if (wState.ended ||\n      // Backwards compat.\n      length === rState.length ||\n      // Backwards compat.\n      rState.length < rState.highWaterMark) {\n        callback();\n      } else {\n        this[kCallback] = callback;\n      }\n    });\n  };\n  Transform.prototype._read = function () {\n    if (this[kCallback]) {\n      const callback = this[kCallback];\n      this[kCallback] = null;\n      callback();\n    }\n  };\n});","lineCount":187,"map":[[2,2,1,0],[3,2,2,0],[4,2,3,0],[5,2,4,0],[6,2,5,0],[7,2,6,0],[8,2,7,0],[9,2,8,0],[10,2,9,0],[11,2,10,0],[12,2,11,0],[13,2,12,0],[14,2,13,0],[15,2,14,0],[16,2,15,0],[17,2,16,0],[18,2,17,0],[19,2,18,0],[20,2,19,0],[21,2,20,0],[23,2,22,0],[24,2,23,0],[25,2,24,0],[26,2,25,0],[27,2,26,0],[28,2,27,0],[29,2,28,0],[30,2,29,0],[31,2,30,0],[32,2,31,0],[33,2,32,0],[34,2,33,0],[35,2,34,0],[36,2,35,0],[37,2,36,0],[38,2,37,0],[39,2,38,0],[40,2,39,0],[41,2,40,0],[42,2,41,0],[43,2,42,0],[44,2,43,0],[45,2,44,0],[46,2,45,0],[47,2,46,0],[48,2,47,0],[49,2,48,0],[50,2,49,0],[51,2,50,0],[52,2,51,0],[53,2,52,0],[54,2,53,0],[55,2,54,0],[56,2,55,0],[57,2,56,0],[58,2,57,0],[59,2,58,0],[60,2,59,0],[61,2,60,0],[62,2,61,0],[63,2,62,0],[65,2,64,0],[65,14,64,12],[67,2,66,0],[67,8,66,6],[68,4,66,8,"ObjectSetPrototypeOf"],[68,24,66,28],[69,4,66,30,"Symbol"],[70,2,66,37],[70,3,66,38],[70,6,66,41,"require"],[70,13,66,48],[70,14,66,48,"_dependencyMap"],[70,28,66,48],[70,57,66,73],[70,58,66,74],[71,2,67,0,"module"],[71,8,67,6],[71,9,67,7,"exports"],[71,16,67,14],[71,19,67,17,"Transform"],[71,28,67,26],[72,2,68,0],[72,8,68,6],[73,4,68,8,"ERR_METHOD_NOT_IMPLEMENTED"],[74,2,68,35],[74,3,68,36],[74,6,68,39,"require"],[74,13,68,46],[74,14,68,46,"_dependencyMap"],[74,28,68,46],[74,52,68,66],[74,53,68,67],[74,54,68,68,"codes"],[74,59,68,73],[75,2,69,0],[75,8,69,6,"Duplex"],[75,14,69,12],[75,17,69,15,"require"],[75,24,69,22],[75,25,69,22,"_dependencyMap"],[75,39,69,22],[75,54,69,33],[75,55,69,34],[76,2,70,0],[76,8,70,6],[77,4,70,8,"getHighWaterMark"],[78,2,70,25],[78,3,70,26],[78,6,70,29,"require"],[78,13,70,36],[78,14,70,36,"_dependencyMap"],[78,28,70,36],[78,42,70,46],[78,43,70,47],[79,2,71,0,"ObjectSetPrototypeOf"],[79,22,71,20],[79,23,71,21,"Transform"],[79,32,71,30],[79,33,71,31,"prototype"],[79,42,71,40],[79,44,71,42,"Duplex"],[79,50,71,48],[79,51,71,49,"prototype"],[79,60,71,58],[79,61,71,59],[80,2,72,0,"ObjectSetPrototypeOf"],[80,22,72,20],[80,23,72,21,"Transform"],[80,32,72,30],[80,34,72,32,"Duplex"],[80,40,72,38],[80,41,72,39],[81,2,73,0],[81,8,73,6,"kCallback"],[81,17,73,15],[81,20,73,18,"Symbol"],[81,26,73,24],[81,27,73,25],[81,38,73,36],[81,39,73,37],[82,2,74,0],[82,11,74,9,"Transform"],[82,20,74,18,"Transform"],[82,21,74,19,"options"],[82,28,74,26],[82,30,74,28],[83,4,75,2],[83,8,75,6],[83,10,75,8],[83,14,75,12],[83,26,75,24,"Transform"],[83,35,75,33],[83,36,75,34],[83,38,75,36],[83,45,75,43],[83,49,75,47,"Transform"],[83,58,75,56],[83,59,75,57,"options"],[83,66,75,64],[83,67,75,65],[85,4,77,2],[86,4,78,2],[87,4,79,2],[88,4,80,2],[88,10,80,8,"readableHighWaterMark"],[88,31,80,29],[88,34,80,32,"options"],[88,41,80,39],[88,44,80,42,"getHighWaterMark"],[88,60,80,58],[88,61,80,59],[88,65,80,63],[88,67,80,65,"options"],[88,74,80,72],[88,76,80,74],[88,99,80,97],[88,101,80,99],[88,105,80,103],[88,106,80,104],[88,109,80,107],[88,113,80,111],[89,4,81,2],[89,8,81,6,"readableHighWaterMark"],[89,29,81,27],[89,34,81,32],[89,35,81,33],[89,37,81,35],[90,6,82,4],[91,6,83,4],[92,6,84,4],[93,6,85,4,"options"],[93,13,85,11],[93,16,85,14],[94,8,86,6],[94,11,86,9,"options"],[94,18,86,16],[95,8,87,6,"highWaterMark"],[95,21,87,19],[95,23,87,21],[95,27,87,25],[96,8,88,6,"readableHighWaterMark"],[96,29,88,27],[97,8,89,6],[98,8,90,6],[99,8,91,6],[100,8,92,6],[101,8,93,6,"writableHighWaterMark"],[101,29,93,27],[101,31,93,29,"options"],[101,38,93,36],[101,39,93,37,"writableHighWaterMark"],[101,60,93,58],[101,64,93,62],[102,6,94,4],[102,7,94,5],[103,4,95,2],[104,4,96,2,"Duplex"],[104,10,96,8],[104,11,96,9,"call"],[104,15,96,13],[104,16,96,14],[104,20,96,18],[104,22,96,20,"options"],[104,29,96,27],[104,30,96,28],[106,4,98,2],[107,4,99,2],[108,4,100,2],[109,4,101,2],[109,8,101,6],[109,9,101,7,"_readableState"],[109,23,101,21],[109,24,101,22,"sync"],[109,28,101,26],[109,31,101,29],[109,36,101,34],[110,4,102,2],[110,8,102,6],[110,9,102,7,"kCallback"],[110,18,102,16],[110,19,102,17],[110,22,102,20],[110,26,102,24],[111,4,103,2],[111,8,103,6,"options"],[111,15,103,13],[111,17,103,15],[112,6,104,4],[112,10,104,8],[112,17,104,15,"options"],[112,24,104,22],[112,25,104,23,"transform"],[112,34,104,32],[112,39,104,37],[112,49,104,47],[112,51,104,49],[112,55,104,53],[112,56,104,54,"_transform"],[112,66,104,64],[112,69,104,67,"options"],[112,76,104,74],[112,77,104,75,"transform"],[112,86,104,84],[113,6,105,4],[113,10,105,8],[113,17,105,15,"options"],[113,24,105,22],[113,25,105,23,"flush"],[113,30,105,28],[113,35,105,33],[113,45,105,43],[113,47,105,45],[113,51,105,49],[113,52,105,50,"_flush"],[113,58,105,56],[113,61,105,59,"options"],[113,68,105,66],[113,69,105,67,"flush"],[113,74,105,72],[114,4,106,2],[116,4,108,2],[117,4,109,2],[118,4,110,2],[119,4,111,2],[120,4,112,2],[120,8,112,6],[120,9,112,7,"on"],[120,11,112,9],[120,12,112,10],[120,23,112,21],[120,25,112,23,"prefinish"],[120,34,112,32],[120,35,112,33],[121,2,113,0],[122,2,114,0],[122,11,114,9,"final"],[122,16,114,14,"final"],[122,17,114,15,"cb"],[122,19,114,17],[122,21,114,19],[123,4,115,2],[123,8,115,6],[123,15,115,13],[123,19,115,17],[123,20,115,18,"_flush"],[123,26,115,24],[123,31,115,29],[123,41,115,39],[123,45,115,43],[123,46,115,44],[123,50,115,48],[123,51,115,49,"destroyed"],[123,60,115,58],[123,62,115,60],[124,6,116,4],[124,10,116,8],[124,11,116,9,"_flush"],[124,17,116,15],[124,18,116,16],[124,19,116,17,"er"],[124,21,116,19],[124,23,116,21,"data"],[124,27,116,25],[124,32,116,30],[125,8,117,6],[125,12,117,10,"er"],[125,14,117,12],[125,16,117,14],[126,10,118,8],[126,14,118,12,"cb"],[126,16,118,14],[126,18,118,16],[127,12,119,10,"cb"],[127,14,119,12],[127,15,119,13,"er"],[127,17,119,15],[127,18,119,16],[128,10,120,8],[128,11,120,9],[128,17,120,15],[129,12,121,10],[129,16,121,14],[129,17,121,15,"destroy"],[129,24,121,22],[129,25,121,23,"er"],[129,27,121,25],[129,28,121,26],[130,10,122,8],[131,10,123,8],[132,8,124,6],[133,8,125,6],[133,12,125,10,"data"],[133,16,125,14],[133,20,125,18],[133,24,125,22],[133,26,125,24],[134,10,126,8],[134,14,126,12],[134,15,126,13,"push"],[134,19,126,17],[134,20,126,18,"data"],[134,24,126,22],[134,25,126,23],[135,8,127,6],[136,8,128,6],[136,12,128,10],[136,13,128,11,"push"],[136,17,128,15],[136,18,128,16],[136,22,128,20],[136,23,128,21],[137,8,129,6],[137,12,129,10,"cb"],[137,14,129,12],[137,16,129,14],[138,10,130,8,"cb"],[138,12,130,10],[138,13,130,11],[138,14,130,12],[139,8,131,6],[140,6,132,4],[140,7,132,5],[140,8,132,6],[141,4,133,2],[141,5,133,3],[141,11,133,9],[142,6,134,4],[142,10,134,8],[142,11,134,9,"push"],[142,15,134,13],[142,16,134,14],[142,20,134,18],[142,21,134,19],[143,6,135,4],[143,10,135,8,"cb"],[143,12,135,10],[143,14,135,12],[144,8,136,6,"cb"],[144,10,136,8],[144,11,136,9],[144,12,136,10],[145,6,137,4],[146,4,138,2],[147,2,139,0],[148,2,140,0],[148,11,140,9,"prefinish"],[148,20,140,18,"prefinish"],[148,21,140,18],[148,23,140,21],[149,4,141,2],[149,8,141,6],[149,12,141,10],[149,13,141,11,"_final"],[149,19,141,17],[149,24,141,22,"final"],[149,29,141,27],[149,31,141,29],[150,6,142,4,"final"],[150,11,142,9],[150,12,142,10,"call"],[150,16,142,14],[150,17,142,15],[150,21,142,19],[150,22,142,20],[151,4,143,2],[152,2,144,0],[153,2,145,0,"Transform"],[153,11,145,9],[153,12,145,10,"prototype"],[153,21,145,19],[153,22,145,20,"_final"],[153,28,145,26],[153,31,145,29,"final"],[153,36,145,34],[154,2,146,0,"Transform"],[154,11,146,9],[154,12,146,10,"prototype"],[154,21,146,19],[154,22,146,20,"_transform"],[154,32,146,30],[154,35,146,33],[154,45,146,43,"chunk"],[154,50,146,48],[154,52,146,50,"encoding"],[154,60,146,58],[154,62,146,60,"callback"],[154,70,146,68],[154,72,146,70],[155,4,147,2],[155,10,147,8],[155,14,147,12,"ERR_METHOD_NOT_IMPLEMENTED"],[155,40,147,38],[155,41,147,39],[155,55,147,53],[155,56,147,54],[156,2,148,0],[156,3,148,1],[157,2,149,0,"Transform"],[157,11,149,9],[157,12,149,10,"prototype"],[157,21,149,19],[157,22,149,20,"_write"],[157,28,149,26],[157,31,149,29],[157,41,149,39,"chunk"],[157,46,149,44],[157,48,149,46,"encoding"],[157,56,149,54],[157,58,149,56,"callback"],[157,66,149,64],[157,68,149,66],[158,4,150,2],[158,10,150,8,"rState"],[158,16,150,14],[158,19,150,17],[158,23,150,21],[158,24,150,22,"_readableState"],[158,38,150,36],[159,4,151,2],[159,10,151,8,"wState"],[159,16,151,14],[159,19,151,17],[159,23,151,21],[159,24,151,22,"_writableState"],[159,38,151,36],[160,4,152,2],[160,10,152,8,"length"],[160,16,152,14],[160,19,152,17,"rState"],[160,25,152,23],[160,26,152,24,"length"],[160,32,152,30],[161,4,153,2],[161,8,153,6],[161,9,153,7,"_transform"],[161,19,153,17],[161,20,153,18,"chunk"],[161,25,153,23],[161,27,153,25,"encoding"],[161,35,153,33],[161,37,153,35],[161,38,153,36,"err"],[161,41,153,39],[161,43,153,41,"val"],[161,46,153,44],[161,51,153,49],[162,6,154,4],[162,10,154,8,"err"],[162,13,154,11],[162,15,154,13],[163,8,155,6,"callback"],[163,16,155,14],[163,17,155,15,"err"],[163,20,155,18],[163,21,155,19],[164,8,156,6],[165,6,157,4],[166,6,158,4],[166,10,158,8,"val"],[166,13,158,11],[166,17,158,15],[166,21,158,19],[166,23,158,21],[167,8,159,6],[167,12,159,10],[167,13,159,11,"push"],[167,17,159,15],[167,18,159,16,"val"],[167,21,159,19],[167,22,159,20],[168,6,160,4],[169,6,161,4],[169,10,162,6,"wState"],[169,16,162,12],[169,17,162,13,"ended"],[169,22,162,18],[170,6,163,6],[171,6,164,6,"length"],[171,12,164,12],[171,17,164,17,"rState"],[171,23,164,23],[171,24,164,24,"length"],[171,30,164,30],[172,6,165,6],[173,6,166,6,"rState"],[173,12,166,12],[173,13,166,13,"length"],[173,19,166,19],[173,22,166,22,"rState"],[173,28,166,28],[173,29,166,29,"highWaterMark"],[173,42,166,42],[173,44,167,6],[174,8,168,6,"callback"],[174,16,168,14],[174,17,168,15],[174,18,168,16],[175,6,169,4],[175,7,169,5],[175,13,169,11],[176,8,170,6],[176,12,170,10],[176,13,170,11,"kCallback"],[176,22,170,20],[176,23,170,21],[176,26,170,24,"callback"],[176,34,170,32],[177,6,171,4],[178,4,172,2],[178,5,172,3],[178,6,172,4],[179,2,173,0],[179,3,173,1],[180,2,174,0,"Transform"],[180,11,174,9],[180,12,174,10,"prototype"],[180,21,174,19],[180,22,174,20,"_read"],[180,27,174,25],[180,30,174,28],[180,42,174,40],[181,4,175,2],[181,8,175,6],[181,12,175,10],[181,13,175,11,"kCallback"],[181,22,175,20],[181,23,175,21],[181,25,175,23],[182,6,176,4],[182,12,176,10,"callback"],[182,20,176,18],[182,23,176,21],[182,27,176,25],[182,28,176,26,"kCallback"],[182,37,176,35],[182,38,176,36],[183,6,177,4],[183,10,177,8],[183,11,177,9,"kCallback"],[183,20,177,18],[183,21,177,19],[183,24,177,22],[183,28,177,26],[184,6,178,4,"callback"],[184,14,178,12],[184,15,178,13],[184,16,178,14],[185,4,179,2],[186,2,180,0],[186,3,180,1],[187,0,180,1],[187,3]],"functionMap":{"names":["<global>","Transform","final","_flush$argument_0","prefinish","Transform.prototype._transform","Transform.prototype._write","_transform$argument_2","Transform.prototype._read"],"mappings":"AAA;ACyE;CDuC;AEC;gBCE;KDgB;CFO;AIC;CJI;iCKE;CLE;6BMC;mCCI;GDmB;CNC;4BQC;CRM"},"hasCjsExports":true},"type":"js/module"}]}