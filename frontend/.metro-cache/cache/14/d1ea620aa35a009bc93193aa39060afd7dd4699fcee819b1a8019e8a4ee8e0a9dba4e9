{"dependencies":[{"name":"../../errors/request.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":58,"index":58}}],"key":"2pE/btc+6/9ceuRiPNwUYrtm86Y=","exportNames":["*"],"imports":1}},{"name":"../../errors/transport.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":59},"end":{"line":2,"column":62,"index":121}}],"key":"805IfQHE3SROi/84maXj3cvj+EI=","exportNames":["*"],"imports":1}},{"name":"../../utils/rpc/compat.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":122},"end":{"line":3,"column":54,"index":176}}],"key":"BqdFQYi/umte+F453mPIO84Ve40=","exportNames":["*"],"imports":1}},{"name":"../../utils/rpc/webSocket.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":177},"end":{"line":4,"column":70,"index":247}}],"key":"vu+4XtTqPv3WqBr4FAT9zJOP/mY=","exportNames":["*"],"imports":1}},{"name":"./createTransport.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":248},"end":{"line":5,"column":56,"index":304}}],"key":"IMAs7VdCtDa1Nl7Tey+wGJLFCUk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.webSocket = webSocket;\n  var _errorsRequestJs = require(_dependencyMap[0], \"../../errors/request.js\");\n  var _errorsTransportJs = require(_dependencyMap[1], \"../../errors/transport.js\");\n  var _utilsRpcCompatJs = require(_dependencyMap[2], \"../../utils/rpc/compat.js\");\n  var _utilsRpcWebSocketJs = require(_dependencyMap[3], \"../../utils/rpc/webSocket.js\");\n  var _createTransportJs = require(_dependencyMap[4], \"./createTransport.js\");\n  /**\n   * @description Creates a WebSocket transport that connects to a JSON-RPC API.\n   */\n  function webSocket(/** URL of the JSON-RPC API. Defaults to the chain's public RPC URL. */\n  url, config = {}) {\n    const {\n      keepAlive,\n      key = 'webSocket',\n      methods,\n      name = 'WebSocket JSON-RPC',\n      reconnect,\n      retryDelay\n    } = config;\n    return ({\n      chain,\n      retryCount: retryCount_,\n      timeout: timeout_\n    }) => {\n      const retryCount = config.retryCount ?? retryCount_;\n      const timeout = timeout_ ?? config.timeout ?? 10_000;\n      const url_ = url || chain?.rpcUrls.default.webSocket?.[0];\n      if (!url_) throw new _errorsTransportJs.UrlRequiredError();\n      return (0, _createTransportJs.createTransport)({\n        key,\n        methods,\n        name,\n        async request({\n          method,\n          params\n        }) {\n          const body = {\n            method,\n            params\n          };\n          const rpcClient = await (0, _utilsRpcWebSocketJs.getWebSocketRpcClient)(url_, {\n            keepAlive,\n            reconnect\n          });\n          const {\n            error,\n            result\n          } = await rpcClient.requestAsync({\n            body,\n            timeout\n          });\n          if (error) throw new _errorsRequestJs.RpcRequestError({\n            body,\n            error,\n            url: url_\n          });\n          return result;\n        },\n        retryCount,\n        retryDelay,\n        timeout,\n        type: 'webSocket'\n      }, {\n        getSocket() {\n          return (0, _utilsRpcCompatJs.getSocket)(url_);\n        },\n        getRpcClient() {\n          return (0, _utilsRpcWebSocketJs.getWebSocketRpcClient)(url_);\n        },\n        async subscribe({\n          params,\n          onData,\n          onError\n        }) {\n          const rpcClient = await (0, _utilsRpcWebSocketJs.getWebSocketRpcClient)(url_);\n          const {\n            result: subscriptionId\n          } = await new Promise((resolve, reject) => rpcClient.request({\n            body: {\n              method: 'eth_subscribe',\n              params\n            },\n            onError(error) {\n              reject(error);\n              onError?.(error);\n              return;\n            },\n            onResponse(response) {\n              if (response.error) {\n                reject(response.error);\n                onError?.(response.error);\n                return;\n              }\n              if (typeof response.id === 'number') {\n                resolve(response);\n                return;\n              }\n              if (response.method !== 'eth_subscription') return;\n              onData(response.params);\n            }\n          }));\n          return {\n            subscriptionId,\n            async unsubscribe() {\n              return new Promise(resolve => rpcClient.request({\n                body: {\n                  method: 'eth_unsubscribe',\n                  params: [subscriptionId]\n                },\n                onResponse: resolve\n              }));\n            }\n          };\n        }\n      });\n    };\n  }\n});","lineCount":124,"map":[[7,2,9,0,"exports"],[7,9,9,0],[7,10,9,0,"webSocket"],[7,19,9,0],[7,22,9,0,"webSocket"],[7,31,9,0],[8,2,1,0],[8,6,1,0,"_errorsRequestJs"],[8,22,1,0],[8,25,1,0,"require"],[8,32,1,0],[8,33,1,0,"_dependencyMap"],[8,47,1,0],[9,2,2,0],[9,6,2,0,"_errorsTransportJs"],[9,24,2,0],[9,27,2,0,"require"],[9,34,2,0],[9,35,2,0,"_dependencyMap"],[9,49,2,0],[10,2,3,0],[10,6,3,0,"_utilsRpcCompatJs"],[10,23,3,0],[10,26,3,0,"require"],[10,33,3,0],[10,34,3,0,"_dependencyMap"],[10,48,3,0],[11,2,4,0],[11,6,4,0,"_utilsRpcWebSocketJs"],[11,26,4,0],[11,29,4,0,"require"],[11,36,4,0],[11,37,4,0,"_dependencyMap"],[11,51,4,0],[12,2,5,0],[12,6,5,0,"_createTransportJs"],[12,24,5,0],[12,27,5,0,"require"],[12,34,5,0],[12,35,5,0,"_dependencyMap"],[12,49,5,0],[13,2,6,0],[14,0,7,0],[15,0,8,0],[16,2,9,7],[16,11,9,16,"webSocket"],[16,20,9,25,"webSocket"],[16,21,10,0],[17,2,11,0,"url"],[17,5,11,3],[17,7,11,5,"config"],[17,13,11,11],[17,16,11,14],[17,17,11,15],[17,18,11,16],[17,20,11,18],[18,4,12,4],[18,10,12,10],[19,6,12,12,"keepAlive"],[19,15,12,21],[20,6,12,23,"key"],[20,9,12,26],[20,12,12,29],[20,23,12,40],[21,6,12,42,"methods"],[21,13,12,49],[22,6,12,51,"name"],[22,10,12,55],[22,13,12,58],[22,33,12,78],[23,6,12,80,"reconnect"],[23,15,12,89],[24,6,12,91,"retryDelay"],[25,4,12,103],[25,5,12,104],[25,8,12,107,"config"],[25,14,12,113],[26,4,13,4],[26,11,13,11],[26,12,13,12],[27,6,13,14,"chain"],[27,11,13,19],[28,6,13,21,"retryCount"],[28,16,13,31],[28,18,13,33,"retryCount_"],[28,29,13,44],[29,6,13,46,"timeout"],[29,13,13,53],[29,15,13,55,"timeout_"],[30,4,13,64],[30,5,13,65],[30,10,13,70],[31,6,14,8],[31,12,14,14,"retryCount"],[31,22,14,24],[31,25,14,27,"config"],[31,31,14,33],[31,32,14,34,"retryCount"],[31,42,14,44],[31,46,14,48,"retryCount_"],[31,57,14,59],[32,6,15,8],[32,12,15,14,"timeout"],[32,19,15,21],[32,22,15,24,"timeout_"],[32,30,15,32],[32,34,15,36,"config"],[32,40,15,42],[32,41,15,43,"timeout"],[32,48,15,50],[32,52,15,54],[32,58,15,60],[33,6,16,8],[33,12,16,14,"url_"],[33,16,16,18],[33,19,16,21,"url"],[33,22,16,24],[33,26,16,28,"chain"],[33,31,16,33],[33,33,16,35,"rpcUrls"],[33,40,16,42],[33,41,16,43,"default"],[33,48,16,50],[33,49,16,51,"webSocket"],[33,58,16,60],[33,61,16,63],[33,62,16,64],[33,63,16,65],[34,6,17,8],[34,10,17,12],[34,11,17,13,"url_"],[34,15,17,17],[34,17,18,12],[34,23,18,18],[34,27,18,22,"UrlRequiredError"],[34,45,18,38],[34,46,18,38,"UrlRequiredError"],[34,62,18,38],[34,63,18,39],[34,64,18,40],[35,6,19,8],[35,13,19,15],[35,17,19,15,"createTransport"],[35,35,19,30],[35,36,19,30,"createTransport"],[35,51,19,30],[35,53,19,31],[36,8,20,12,"key"],[36,11,20,15],[37,8,21,12,"methods"],[37,15,21,19],[38,8,22,12,"name"],[38,12,22,16],[39,8,23,12],[39,14,23,18,"request"],[39,21,23,25,"request"],[39,22,23,26],[40,10,23,28,"method"],[40,16,23,34],[41,10,23,36,"params"],[42,8,23,43],[42,9,23,44],[42,11,23,46],[43,10,24,16],[43,16,24,22,"body"],[43,20,24,26],[43,23,24,29],[44,12,24,31,"method"],[44,18,24,37],[45,12,24,39,"params"],[46,10,24,46],[46,11,24,47],[47,10,25,16],[47,16,25,22,"rpcClient"],[47,25,25,31],[47,28,25,34],[47,34,25,40],[47,38,25,40,"getWebSocketRpcClient"],[47,58,25,61],[47,59,25,61,"getWebSocketRpcClient"],[47,80,25,61],[47,82,25,62,"url_"],[47,86,25,66],[47,88,25,68],[48,12,26,20,"keepAlive"],[48,21,26,29],[49,12,27,20,"reconnect"],[50,10,28,16],[50,11,28,17],[50,12,28,18],[51,10,29,16],[51,16,29,22],[52,12,29,24,"error"],[52,17,29,29],[53,12,29,31,"result"],[54,10,29,38],[54,11,29,39],[54,14,29,42],[54,20,29,48,"rpcClient"],[54,29,29,57],[54,30,29,58,"requestAsync"],[54,42,29,70],[54,43,29,71],[55,12,30,20,"body"],[55,16,30,24],[56,12,31,20,"timeout"],[57,10,32,16],[57,11,32,17],[57,12,32,18],[58,10,33,16],[58,14,33,20,"error"],[58,19,33,25],[58,21,34,20],[58,27,34,26],[58,31,34,30,"RpcRequestError"],[58,47,34,45],[58,48,34,45,"RpcRequestError"],[58,63,34,45],[58,64,34,46],[59,12,35,24,"body"],[59,16,35,28],[60,12,36,24,"error"],[60,17,36,29],[61,12,37,24,"url"],[61,15,37,27],[61,17,37,29,"url_"],[62,10,38,20],[62,11,38,21],[62,12,38,22],[63,10,39,16],[63,17,39,23,"result"],[63,23,39,29],[64,8,40,12],[64,9,40,13],[65,8,41,12,"retryCount"],[65,18,41,22],[66,8,42,12,"retryDelay"],[66,18,42,22],[67,8,43,12,"timeout"],[67,15,43,19],[68,8,44,12,"type"],[68,12,44,16],[68,14,44,18],[69,6,45,8],[69,7,45,9],[69,9,45,11],[70,8,46,12,"getSocket"],[70,17,46,21,"getSocket"],[70,18,46,21],[70,20,46,24],[71,10,47,16],[71,17,47,23],[71,21,47,23,"getSocket"],[71,38,47,32],[71,39,47,32,"getSocket"],[71,48,47,32],[71,50,47,33,"url_"],[71,54,47,37],[71,55,47,38],[72,8,48,12],[72,9,48,13],[73,8,49,12,"getRpcClient"],[73,20,49,24,"getRpcClient"],[73,21,49,24],[73,23,49,27],[74,10,50,16],[74,17,50,23],[74,21,50,23,"getWebSocketRpcClient"],[74,41,50,44],[74,42,50,44,"getWebSocketRpcClient"],[74,63,50,44],[74,65,50,45,"url_"],[74,69,50,49],[74,70,50,50],[75,8,51,12],[75,9,51,13],[76,8,52,12],[76,14,52,18,"subscribe"],[76,23,52,27,"subscribe"],[76,24,52,28],[77,10,52,30,"params"],[77,16,52,36],[78,10,52,38,"onData"],[78,16,52,44],[79,10,52,46,"onError"],[80,8,52,54],[80,9,52,55],[80,11,52,57],[81,10,53,16],[81,16,53,22,"rpcClient"],[81,25,53,31],[81,28,53,34],[81,34,53,40],[81,38,53,40,"getWebSocketRpcClient"],[81,58,53,61],[81,59,53,61,"getWebSocketRpcClient"],[81,80,53,61],[81,82,53,62,"url_"],[81,86,53,66],[81,87,53,67],[82,10,54,16],[82,16,54,22],[83,12,54,24,"result"],[83,18,54,30],[83,20,54,32,"subscriptionId"],[84,10,54,47],[84,11,54,48],[84,14,54,51],[84,20,54,57],[84,24,54,61,"Promise"],[84,31,54,68],[84,32,54,69],[84,33,54,70,"resolve"],[84,40,54,77],[84,42,54,79,"reject"],[84,48,54,85],[84,53,54,90,"rpcClient"],[84,62,54,99],[84,63,54,100,"request"],[84,70,54,107],[84,71,54,108],[85,12,55,20,"body"],[85,16,55,24],[85,18,55,26],[86,14,56,24,"method"],[86,20,56,30],[86,22,56,32],[86,37,56,47],[87,14,57,24,"params"],[88,12,58,20],[88,13,58,21],[89,12,59,20,"onError"],[89,19,59,27,"onError"],[89,20,59,28,"error"],[89,25,59,33],[89,27,59,35],[90,14,60,24,"reject"],[90,20,60,30],[90,21,60,31,"error"],[90,26,60,36],[90,27,60,37],[91,14,61,24,"onError"],[91,21,61,31],[91,24,61,34,"error"],[91,29,61,39],[91,30,61,40],[92,14,62,24],[93,12,63,20],[93,13,63,21],[94,12,64,20,"onResponse"],[94,22,64,30,"onResponse"],[94,23,64,31,"response"],[94,31,64,39],[94,33,64,41],[95,14,65,24],[95,18,65,28,"response"],[95,26,65,36],[95,27,65,37,"error"],[95,32,65,42],[95,34,65,44],[96,16,66,28,"reject"],[96,22,66,34],[96,23,66,35,"response"],[96,31,66,43],[96,32,66,44,"error"],[96,37,66,49],[96,38,66,50],[97,16,67,28,"onError"],[97,23,67,35],[97,26,67,38,"response"],[97,34,67,46],[97,35,67,47,"error"],[97,40,67,52],[97,41,67,53],[98,16,68,28],[99,14,69,24],[100,14,70,24],[100,18,70,28],[100,25,70,35,"response"],[100,33,70,43],[100,34,70,44,"id"],[100,36,70,46],[100,41,70,51],[100,49,70,59],[100,51,70,61],[101,16,71,28,"resolve"],[101,23,71,35],[101,24,71,36,"response"],[101,32,71,44],[101,33,71,45],[102,16,72,28],[103,14,73,24],[104,14,74,24],[104,18,74,28,"response"],[104,26,74,36],[104,27,74,37,"method"],[104,33,74,43],[104,38,74,48],[104,56,74,66],[104,58,75,28],[105,14,76,24,"onData"],[105,20,76,30],[105,21,76,31,"response"],[105,29,76,39],[105,30,76,40,"params"],[105,36,76,46],[105,37,76,47],[106,12,77,20],[107,10,78,16],[107,11,78,17],[107,12,78,18],[107,13,78,19],[108,10,79,16],[108,17,79,23],[109,12,80,20,"subscriptionId"],[109,26,80,34],[110,12,81,20],[110,18,81,26,"unsubscribe"],[110,29,81,37,"unsubscribe"],[110,30,81,37],[110,32,81,40],[111,14,82,24],[111,21,82,31],[111,25,82,35,"Promise"],[111,32,82,42],[111,33,82,44,"resolve"],[111,40,82,51],[111,44,82,56,"rpcClient"],[111,53,82,65],[111,54,82,66,"request"],[111,61,82,73],[111,62,82,74],[112,16,83,28,"body"],[112,20,83,32],[112,22,83,34],[113,18,84,32,"method"],[113,24,84,38],[113,26,84,40],[113,43,84,57],[114,18,85,32,"params"],[114,24,85,38],[114,26,85,40],[114,27,85,41,"subscriptionId"],[114,41,85,55],[115,16,86,28],[115,17,86,29],[116,16,87,28,"onResponse"],[116,26,87,38],[116,28,87,40,"resolve"],[117,14,88,24],[117,15,88,25],[117,16,88,26],[117,17,88,27],[118,12,89,20],[119,10,90,16],[119,11,90,17],[120,8,91,12],[121,6,92,8],[121,7,92,9],[121,8,92,10],[122,4,93,4],[122,5,93,5],[123,2,94,0],[124,0,94,1],[124,3]],"functionMap":{"names":["<global>","webSocket","<anonymous>","createTransport$argument_0.request","createTransport$argument_1.getSocket","createTransport$argument_1.getRpcClient","createTransport$argument_1.subscribe","Promise$argument_0","rpcClient.request$argument_0.onError","rpcClient.request$argument_0.onResponse","unsubscribe"],"mappings":"AAA;OCQ;WCI;YCU;aDiB;YEM;aFE;YGC;aHE;YIC;qECE;oBCK;qBDI;oBEC;qBFa;kBDC;oBIG;2CHC;0BGM;qBJC;aJE;KDE;CDC"},"hasCjsExports":false},"type":"js/module"}]}