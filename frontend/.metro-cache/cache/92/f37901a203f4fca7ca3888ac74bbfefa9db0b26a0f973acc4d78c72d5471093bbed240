{"dependencies":[{"name":"../address/isAddressEqual.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":28,"index":156},"end":{"line":4,"column":67,"index":195}}],"key":"G+mn4YBvcSc/Ic6uwpWkGiF5IkY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.validateSiweMessage = validateSiweMessage;\n  const isAddressEqual_js_1 = require(_dependencyMap[0], \"../address/isAddressEqual.js\");\n  function validateSiweMessage(parameters) {\n    const {\n      address,\n      domain,\n      message,\n      nonce,\n      scheme,\n      time = new Date()\n    } = parameters;\n    if (domain && message.domain !== domain) return false;\n    if (nonce && message.nonce !== nonce) return false;\n    if (scheme && message.scheme !== scheme) return false;\n    if (message.expirationTime && time >= message.expirationTime) return false;\n    if (message.notBefore && time < message.notBefore) return false;\n    try {\n      if (!message.address) return false;\n      if (address && !(0, isAddressEqual_js_1.isAddressEqual)(message.address, address)) return false;\n    } catch {\n      return false;\n    }\n    return true;\n  }\n});","lineCount":31,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"validateSiweMessage"],[7,29,3,27],[7,32,3,30,"validateSiweMessage"],[7,51,3,49],[8,2,4,0],[8,8,4,6,"isAddressEqual_js_1"],[8,27,4,25],[8,30,4,28,"require"],[8,37,4,35],[8,38,4,35,"_dependencyMap"],[8,52,4,35],[8,87,4,66],[8,88,4,67],[9,2,5,0],[9,11,5,9,"validateSiweMessage"],[9,30,5,28,"validateSiweMessage"],[9,31,5,29,"parameters"],[9,41,5,39],[9,43,5,41],[10,4,6,4],[10,10,6,10],[11,6,6,12,"address"],[11,13,6,19],[12,6,6,21,"domain"],[12,12,6,27],[13,6,6,29,"message"],[13,13,6,36],[14,6,6,38,"nonce"],[14,11,6,43],[15,6,6,45,"scheme"],[15,12,6,51],[16,6,6,53,"time"],[16,10,6,57],[16,13,6,60],[16,17,6,64,"Date"],[16,21,6,68],[16,22,6,69],[17,4,6,72],[17,5,6,73],[17,8,6,76,"parameters"],[17,18,6,86],[18,4,7,4],[18,8,7,8,"domain"],[18,14,7,14],[18,18,7,18,"message"],[18,25,7,25],[18,26,7,26,"domain"],[18,32,7,32],[18,37,7,37,"domain"],[18,43,7,43],[18,45,8,8],[18,52,8,15],[18,57,8,20],[19,4,9,4],[19,8,9,8,"nonce"],[19,13,9,13],[19,17,9,17,"message"],[19,24,9,24],[19,25,9,25,"nonce"],[19,30,9,30],[19,35,9,35,"nonce"],[19,40,9,40],[19,42,10,8],[19,49,10,15],[19,54,10,20],[20,4,11,4],[20,8,11,8,"scheme"],[20,14,11,14],[20,18,11,18,"message"],[20,25,11,25],[20,26,11,26,"scheme"],[20,32,11,32],[20,37,11,37,"scheme"],[20,43,11,43],[20,45,12,8],[20,52,12,15],[20,57,12,20],[21,4,13,4],[21,8,13,8,"message"],[21,15,13,15],[21,16,13,16,"expirationTime"],[21,30,13,30],[21,34,13,34,"time"],[21,38,13,38],[21,42,13,42,"message"],[21,49,13,49],[21,50,13,50,"expirationTime"],[21,64,13,64],[21,66,14,8],[21,73,14,15],[21,78,14,20],[22,4,15,4],[22,8,15,8,"message"],[22,15,15,15],[22,16,15,16,"notBefore"],[22,25,15,25],[22,29,15,29,"time"],[22,33,15,33],[22,36,15,36,"message"],[22,43,15,43],[22,44,15,44,"notBefore"],[22,53,15,53],[22,55,16,8],[22,62,16,15],[22,67,16,20],[23,4,17,4],[23,8,17,8],[24,6,18,8],[24,10,18,12],[24,11,18,13,"message"],[24,18,18,20],[24,19,18,21,"address"],[24,26,18,28],[24,28,19,12],[24,35,19,19],[24,40,19,24],[25,6,20,8],[25,10,20,12,"address"],[25,17,20,19],[25,21,20,23],[25,22,20,24],[25,23,20,25],[25,24,20,26],[25,26,20,28,"isAddressEqual_js_1"],[25,45,20,47],[25,46,20,48,"isAddressEqual"],[25,60,20,62],[25,62,20,64,"message"],[25,69,20,71],[25,70,20,72,"address"],[25,77,20,79],[25,79,20,81,"address"],[25,86,20,88],[25,87,20,89],[25,89,21,12],[25,96,21,19],[25,101,21,24],[26,4,22,4],[26,5,22,5],[26,6,23,4],[26,12,23,10],[27,6,24,8],[27,13,24,15],[27,18,24,20],[28,4,25,4],[29,4,26,4],[29,11,26,11],[29,15,26,15],[30,2,27,0],[31,0,27,1],[31,3]],"functionMap":{"names":["<global>","validateSiweMessage"],"mappings":"AAA;ACI;CDsB"},"hasCjsExports":true},"type":"js/module"}]}