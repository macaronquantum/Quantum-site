{"dependencies":[{"name":"../../ours/primordials","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":26,"index":40},"end":{"line":3,"column":59,"index":73}}],"key":"NYjhRIk1YfVwfaQSeITMV+mboSc=","exportNames":["*"],"imports":1}},{"name":"../../ours/errors","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":30,"index":104},"end":{"line":4,"column":58,"index":132}}],"key":"1gsl/vMwrKGa5aYfNtCHl6fAfek=","exportNames":["*"],"imports":1}},{"name":"./utils","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":64,"index":197},"end":{"line":5,"column":82,"index":215}}],"key":"Arg6QRuIuy5D/jfcnxX1qJiHjX8=","exportNames":["*"],"imports":1}},{"name":"./end-of-stream","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":12,"index":228},"end":{"line":6,"column":38,"index":254}}],"key":"wYzLdnrEbrGjPeg9yNcs7/vHpVc=","exportNames":["*"],"imports":1}},{"name":"../../ours/util","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":47,"column":43,"index":1602},"end":{"line":47,"column":69,"index":1628}}],"key":"vgA1whfYbp+LEvvdsBttIUSnIH8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  const {\n    SymbolDispose\n  } = require(_dependencyMap[0], \"../../ours/primordials\");\n  const {\n    AbortError,\n    codes\n  } = require(_dependencyMap[1], \"../../ours/errors\");\n  const {\n    isNodeStream,\n    isWebStream,\n    kControllerErrorFunction\n  } = require(_dependencyMap[2], \"./utils\");\n  const eos = require(_dependencyMap[3], \"./end-of-stream\");\n  const {\n    ERR_INVALID_ARG_TYPE\n  } = codes;\n  let addAbortListener;\n\n  // This method is inlined here for readable-stream\n  // It also does not allow for signal to not exist on the stream\n  // https://github.com/nodejs/node/pull/36061#discussion_r533718029\n  const validateAbortSignal = (signal, name) => {\n    if (typeof signal !== 'object' || !('aborted' in signal)) {\n      throw new ERR_INVALID_ARG_TYPE(name, 'AbortSignal', signal);\n    }\n  };\n  module.exports.addAbortSignal = function addAbortSignal(signal, stream) {\n    validateAbortSignal(signal, 'signal');\n    if (!isNodeStream(stream) && !isWebStream(stream)) {\n      throw new ERR_INVALID_ARG_TYPE('stream', ['ReadableStream', 'WritableStream', 'Stream'], stream);\n    }\n    return module.exports.addAbortSignalNoValidate(signal, stream);\n  };\n  module.exports.addAbortSignalNoValidate = function (signal, stream) {\n    if (typeof signal !== 'object' || !('aborted' in signal)) {\n      return stream;\n    }\n    const onAbort = isNodeStream(stream) ? () => {\n      stream.destroy(new AbortError(undefined, {\n        cause: signal.reason\n      }));\n    } : () => {\n      stream[kControllerErrorFunction](new AbortError(undefined, {\n        cause: signal.reason\n      }));\n    };\n    if (signal.aborted) {\n      onAbort();\n    } else {\n      addAbortListener = addAbortListener || require(_dependencyMap[4], \"../../ours/util\").addAbortListener;\n      const disposable = addAbortListener(signal, onAbort);\n      eos(stream, disposable[SymbolDispose]);\n    }\n    return stream;\n  };\n});","lineCount":59,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,8,3,6],[5,4,3,8,"SymbolDispose"],[6,2,3,22],[6,3,3,23],[6,6,3,26,"require"],[6,13,3,33],[6,14,3,33,"_dependencyMap"],[6,28,3,33],[6,57,3,58],[6,58,3,59],[7,2,4,0],[7,8,4,6],[8,4,4,8,"AbortError"],[8,14,4,18],[9,4,4,20,"codes"],[10,2,4,26],[10,3,4,27],[10,6,4,30,"require"],[10,13,4,37],[10,14,4,37,"_dependencyMap"],[10,28,4,37],[10,52,4,57],[10,53,4,58],[11,2,5,0],[11,8,5,6],[12,4,5,8,"isNodeStream"],[12,16,5,20],[13,4,5,22,"isWebStream"],[13,15,5,33],[14,4,5,35,"kControllerErrorFunction"],[15,2,5,60],[15,3,5,61],[15,6,5,64,"require"],[15,13,5,71],[15,14,5,71,"_dependencyMap"],[15,28,5,71],[15,42,5,81],[15,43,5,82],[16,2,6,0],[16,8,6,6,"eos"],[16,11,6,9],[16,14,6,12,"require"],[16,21,6,19],[16,22,6,19,"_dependencyMap"],[16,36,6,19],[16,58,6,37],[16,59,6,38],[17,2,7,0],[17,8,7,6],[18,4,7,8,"ERR_INVALID_ARG_TYPE"],[19,2,7,29],[19,3,7,30],[19,6,7,33,"codes"],[19,11,7,38],[20,2,8,0],[20,6,8,4,"addAbortListener"],[20,22,8,20],[22,2,10,0],[23,2,11,0],[24,2,12,0],[25,2,13,0],[25,8,13,6,"validateAbortSignal"],[25,27,13,25],[25,30,13,28,"validateAbortSignal"],[25,31,13,29,"signal"],[25,37,13,35],[25,39,13,37,"name"],[25,43,13,41],[25,48,13,46],[26,4,14,2],[26,8,14,6],[26,15,14,13,"signal"],[26,21,14,19],[26,26,14,24],[26,34,14,32],[26,38,14,36],[26,40,14,38],[26,49,14,47],[26,53,14,51,"signal"],[26,59,14,57],[26,60,14,58],[26,62,14,60],[27,6,15,4],[27,12,15,10],[27,16,15,14,"ERR_INVALID_ARG_TYPE"],[27,36,15,34],[27,37,15,35,"name"],[27,41,15,39],[27,43,15,41],[27,56,15,54],[27,58,15,56,"signal"],[27,64,15,62],[27,65,15,63],[28,4,16,2],[29,2,17,0],[29,3,17,1],[30,2,18,0,"module"],[30,8,18,6],[30,9,18,7,"exports"],[30,16,18,14],[30,17,18,15,"addAbortSignal"],[30,31,18,29],[30,34,18,32],[30,43,18,41,"addAbortSignal"],[30,57,18,55,"addAbortSignal"],[30,58,18,56,"signal"],[30,64,18,62],[30,66,18,64,"stream"],[30,72,18,70],[30,74,18,72],[31,4,19,2,"validateAbortSignal"],[31,23,19,21],[31,24,19,22,"signal"],[31,30,19,28],[31,32,19,30],[31,40,19,38],[31,41,19,39],[32,4,20,2],[32,8,20,6],[32,9,20,7,"isNodeStream"],[32,21,20,19],[32,22,20,20,"stream"],[32,28,20,26],[32,29,20,27],[32,33,20,31],[32,34,20,32,"isWebStream"],[32,45,20,43],[32,46,20,44,"stream"],[32,52,20,50],[32,53,20,51],[32,55,20,53],[33,6,21,4],[33,12,21,10],[33,16,21,14,"ERR_INVALID_ARG_TYPE"],[33,36,21,34],[33,37,21,35],[33,45,21,43],[33,47,21,45],[33,48,21,46],[33,64,21,62],[33,66,21,64],[33,82,21,80],[33,84,21,82],[33,92,21,90],[33,93,21,91],[33,95,21,93,"stream"],[33,101,21,99],[33,102,21,100],[34,4,22,2],[35,4,23,2],[35,11,23,9,"module"],[35,17,23,15],[35,18,23,16,"exports"],[35,25,23,23],[35,26,23,24,"addAbortSignalNoValidate"],[35,50,23,48],[35,51,23,49,"signal"],[35,57,23,55],[35,59,23,57,"stream"],[35,65,23,63],[35,66,23,64],[36,2,24,0],[36,3,24,1],[37,2,25,0,"module"],[37,8,25,6],[37,9,25,7,"exports"],[37,16,25,14],[37,17,25,15,"addAbortSignalNoValidate"],[37,41,25,39],[37,44,25,42],[37,54,25,52,"signal"],[37,60,25,58],[37,62,25,60,"stream"],[37,68,25,66],[37,70,25,68],[38,4,26,2],[38,8,26,6],[38,15,26,13,"signal"],[38,21,26,19],[38,26,26,24],[38,34,26,32],[38,38,26,36],[38,40,26,38],[38,49,26,47],[38,53,26,51,"signal"],[38,59,26,57],[38,60,26,58],[38,62,26,60],[39,6,27,4],[39,13,27,11,"stream"],[39,19,27,17],[40,4,28,2],[41,4,29,2],[41,10,29,8,"onAbort"],[41,17,29,15],[41,20,29,18,"isNodeStream"],[41,32,29,30],[41,33,29,31,"stream"],[41,39,29,37],[41,40,29,38],[41,43,30,6],[41,49,30,12],[42,6,31,8,"stream"],[42,12,31,14],[42,13,31,15,"destroy"],[42,20,31,22],[42,21,32,10],[42,25,32,14,"AbortError"],[42,35,32,24],[42,36,32,25,"undefined"],[42,45,32,34],[42,47,32,36],[43,8,33,12,"cause"],[43,13,33,17],[43,15,33,19,"signal"],[43,21,33,25],[43,22,33,26,"reason"],[44,6,34,10],[44,7,34,11],[44,8,35,8],[44,9,35,9],[45,4,36,6],[45,5,36,7],[45,8,37,6],[45,14,37,12],[46,6,38,8,"stream"],[46,12,38,14],[46,13,38,15,"kControllerErrorFunction"],[46,37,38,39],[46,38,38,40],[46,39,39,10],[46,43,39,14,"AbortError"],[46,53,39,24],[46,54,39,25,"undefined"],[46,63,39,34],[46,65,39,36],[47,8,40,12,"cause"],[47,13,40,17],[47,15,40,19,"signal"],[47,21,40,25],[47,22,40,26,"reason"],[48,6,41,10],[48,7,41,11],[48,8,42,8],[48,9,42,9],[49,4,43,6],[49,5,43,7],[50,4,44,2],[50,8,44,6,"signal"],[50,14,44,12],[50,15,44,13,"aborted"],[50,22,44,20],[50,24,44,22],[51,6,45,4,"onAbort"],[51,13,45,11],[51,14,45,12],[51,15,45,13],[52,4,46,2],[52,5,46,3],[52,11,46,9],[53,6,47,4,"addAbortListener"],[53,22,47,20],[53,25,47,23,"addAbortListener"],[53,41,47,39],[53,45,47,43,"require"],[53,52,47,50],[53,53,47,50,"_dependencyMap"],[53,67,47,50],[53,89,47,68],[53,90,47,69],[53,91,47,70,"addAbortListener"],[53,107,47,86],[54,6,48,4],[54,12,48,10,"disposable"],[54,22,48,20],[54,25,48,23,"addAbortListener"],[54,41,48,39],[54,42,48,40,"signal"],[54,48,48,46],[54,50,48,48,"onAbort"],[54,57,48,55],[54,58,48,56],[55,6,49,4,"eos"],[55,9,49,7],[55,10,49,8,"stream"],[55,16,49,14],[55,18,49,16,"disposable"],[55,28,49,26],[55,29,49,27,"SymbolDispose"],[55,42,49,40],[55,43,49,41],[55,44,49,42],[56,4,50,2],[57,4,51,2],[57,11,51,9,"stream"],[57,17,51,15],[58,2,52,0],[58,3,52,1],[59,0,52,1],[59,3]],"functionMap":{"names":["<global>","validateAbortSignal","addAbortSignal","module.exports.addAbortSignalNoValidate","<anonymous>"],"mappings":"AAA;4BCY;CDI;gCEC;CFM;0CGC;MCK;ODM;MCC;ODM;CHS"},"hasCjsExports":true},"type":"js/module"}]}