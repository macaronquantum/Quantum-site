{"dependencies":[{"name":"@ledgerhq/hw-transport","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":75,"index":75}}],"key":"KwZpx9ZDepxYjf5Q7opyc3kHIFU=","exportNames":["*"],"imports":1}},{"name":"@solana/wallet-adapter-base","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":76},"end":{"line":2,"column":69,"index":145}}],"key":"UrbaetKTiKpOkbbQPY6ITws4gVs=","exportNames":["*"],"imports":1}},{"name":"@solana/web3.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":146},"end":{"line":3,"column":44,"index":190}}],"key":"hVqIgOgXAH1+S7mu7qk6LJzdVc8=","exportNames":["*"],"imports":1}},{"name":"./polyfills/index.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":191},"end":{"line":4,"column":30,"index":221}}],"key":"rDB21wa3CjGtkX9K1V516oiR9N8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.getDerivationPath = getDerivationPath;\n  exports.getPublicKey = getPublicKey;\n  exports.signTransaction = signTransaction;\n  var _ledgerhqHwTransport = require(_dependencyMap[0], \"@ledgerhq/hw-transport\");\n  var _solanaWalletAdapterBase = require(_dependencyMap[1], \"@solana/wallet-adapter-base\");\n  var _solanaWeb3Js = require(_dependencyMap[2], \"@solana/web3.js\");\n  require(_dependencyMap[3], \"./polyfills/index.js\");\n  function getDerivationPath(account, change) {\n    const length = account !== undefined ? change === undefined ? 3 : 4 : 2;\n    const derivationPath = Buffer.alloc(1 + length * 4);\n    let offset = derivationPath.writeUInt8(length, 0);\n    offset = derivationPath.writeUInt32BE(harden(44), offset); // Using BIP44\n    offset = derivationPath.writeUInt32BE(harden(501), offset); // Solana's BIP44 path\n    if (account !== undefined) {\n      offset = derivationPath.writeUInt32BE(harden(account), offset);\n      if (change !== undefined) {\n        derivationPath.writeUInt32BE(harden(change), offset);\n      }\n    }\n    return derivationPath;\n  }\n  const BIP32_HARDENED_BIT = 1 << 31 >>> 0;\n  function harden(n) {\n    return (n | BIP32_HARDENED_BIT) >>> 0;\n  }\n  const INS_GET_PUBKEY = 0x05;\n  const INS_SIGN_MESSAGE = 0x06;\n  const P1_NON_CONFIRM = 0x00;\n  const P1_CONFIRM = 0x01;\n  const P2_EXTEND = 0x01;\n  const P2_MORE = 0x02;\n  const MAX_PAYLOAD = 255;\n  const LEDGER_CLA = 0xe0;\n  /** @internal */\n  async function getPublicKey(transport, derivationPath) {\n    const bytes = await send(transport, INS_GET_PUBKEY, P1_NON_CONFIRM, derivationPath);\n    return new _solanaWeb3Js.PublicKey(bytes);\n  }\n  /** @internal */\n  async function signTransaction(transport, transaction, derivationPath) {\n    const paths = Buffer.alloc(1);\n    paths.writeUInt8(1, 0);\n    const message = (0, _solanaWalletAdapterBase.isVersionedTransaction)(transaction) ? transaction.message.serialize() : transaction.serializeMessage();\n    const data = Buffer.concat([paths, derivationPath, message]);\n    return await send(transport, INS_SIGN_MESSAGE, P1_CONFIRM, data);\n  }\n  async function send(transport, instruction, p1, data) {\n    let p2 = 0;\n    let offset = 0;\n    if (data.length > MAX_PAYLOAD) {\n      while (data.length - offset > MAX_PAYLOAD) {\n        const buffer = data.slice(offset, offset + MAX_PAYLOAD);\n        const response = await transport.send(LEDGER_CLA, instruction, p1, p2 | P2_MORE, buffer);\n        // @ts-ignore -- TransportStatusError is a constructor Function, not a Class\n        if (response.length !== 2) throw new _ledgerhqHwTransport.TransportStatusError(_ledgerhqHwTransport.StatusCodes.INCORRECT_DATA);\n        p2 |= P2_EXTEND;\n        offset += MAX_PAYLOAD;\n      }\n    }\n    const buffer = data.slice(offset);\n    const response = await transport.send(LEDGER_CLA, instruction, p1, p2, buffer);\n    return response.slice(0, response.length - 2);\n  }\n});","lineCount":70,"map":[[7,2,5,0,"exports"],[7,9,5,0],[7,10,5,0,"getDerivationPath"],[7,27,5,0],[7,30,5,0,"getDerivationPath"],[7,47,5,0],[8,2,32,0,"exports"],[8,9,32,0],[8,10,32,0,"getPublicKey"],[8,22,32,0],[8,25,32,0,"getPublicKey"],[8,37,32,0],[9,2,37,0,"exports"],[9,9,37,0],[9,10,37,0,"signTransaction"],[9,25,37,0],[9,28,37,0,"signTransaction"],[9,43,37,0],[10,2,1,0],[10,6,1,0,"_ledgerhqHwTransport"],[10,26,1,0],[10,29,1,0,"require"],[10,36,1,0],[10,37,1,0,"_dependencyMap"],[10,51,1,0],[11,2,2,0],[11,6,2,0,"_solanaWalletAdapterBase"],[11,30,2,0],[11,33,2,0,"require"],[11,40,2,0],[11,41,2,0,"_dependencyMap"],[11,55,2,0],[12,2,3,0],[12,6,3,0,"_solanaWeb3Js"],[12,19,3,0],[12,22,3,0,"require"],[12,29,3,0],[12,30,3,0,"_dependencyMap"],[12,44,3,0],[13,2,4,0,"require"],[13,9,4,0],[13,10,4,0,"_dependencyMap"],[13,24,4,0],[14,2,5,7],[14,11,5,16,"getDerivationPath"],[14,28,5,33,"getDerivationPath"],[14,29,5,34,"account"],[14,36,5,41],[14,38,5,43,"change"],[14,44,5,49],[14,46,5,51],[15,4,6,4],[15,10,6,10,"length"],[15,16,6,16],[15,19,6,19,"account"],[15,26,6,26],[15,31,6,31,"undefined"],[15,40,6,40],[15,43,6,44,"change"],[15,49,6,50],[15,54,6,55,"undefined"],[15,63,6,64],[15,66,6,67],[15,67,6,68],[15,70,6,71],[15,71,6,72],[15,74,6,76],[15,75,6,77],[16,4,7,4],[16,10,7,10,"derivationPath"],[16,24,7,24],[16,27,7,27,"Buffer"],[16,33,7,33],[16,34,7,34,"alloc"],[16,39,7,39],[16,40,7,40],[16,41,7,41],[16,44,7,44,"length"],[16,50,7,50],[16,53,7,53],[16,54,7,54],[16,55,7,55],[17,4,8,4],[17,8,8,8,"offset"],[17,14,8,14],[17,17,8,17,"derivationPath"],[17,31,8,31],[17,32,8,32,"writeUInt8"],[17,42,8,42],[17,43,8,43,"length"],[17,49,8,49],[17,51,8,51],[17,52,8,52],[17,53,8,53],[18,4,9,4,"offset"],[18,10,9,10],[18,13,9,13,"derivationPath"],[18,27,9,27],[18,28,9,28,"writeUInt32BE"],[18,41,9,41],[18,42,9,42,"harden"],[18,48,9,48],[18,49,9,49],[18,51,9,51],[18,52,9,52],[18,54,9,54,"offset"],[18,60,9,60],[18,61,9,61],[18,62,9,62],[18,63,9,63],[19,4,10,4,"offset"],[19,10,10,10],[19,13,10,13,"derivationPath"],[19,27,10,27],[19,28,10,28,"writeUInt32BE"],[19,41,10,41],[19,42,10,42,"harden"],[19,48,10,48],[19,49,10,49],[19,52,10,52],[19,53,10,53],[19,55,10,55,"offset"],[19,61,10,61],[19,62,10,62],[19,63,10,63],[19,64,10,64],[20,4,11,4],[20,8,11,8,"account"],[20,15,11,15],[20,20,11,20,"undefined"],[20,29,11,29],[20,31,11,31],[21,6,12,8,"offset"],[21,12,12,14],[21,15,12,17,"derivationPath"],[21,29,12,31],[21,30,12,32,"writeUInt32BE"],[21,43,12,45],[21,44,12,46,"harden"],[21,50,12,52],[21,51,12,53,"account"],[21,58,12,60],[21,59,12,61],[21,61,12,63,"offset"],[21,67,12,69],[21,68,12,70],[22,6,13,8],[22,10,13,12,"change"],[22,16,13,18],[22,21,13,23,"undefined"],[22,30,13,32],[22,32,13,34],[23,8,14,12,"derivationPath"],[23,22,14,26],[23,23,14,27,"writeUInt32BE"],[23,36,14,40],[23,37,14,41,"harden"],[23,43,14,47],[23,44,14,48,"change"],[23,50,14,54],[23,51,14,55],[23,53,14,57,"offset"],[23,59,14,63],[23,60,14,64],[24,6,15,8],[25,4,16,4],[26,4,17,4],[26,11,17,11,"derivationPath"],[26,25,17,25],[27,2,18,0],[28,2,19,0],[28,8,19,6,"BIP32_HARDENED_BIT"],[28,26,19,24],[28,29,19,28],[28,30,19,29],[28,34,19,33],[28,36,19,35],[28,41,19,41],[28,42,19,42],[29,2,20,0],[29,11,20,9,"harden"],[29,17,20,15,"harden"],[29,18,20,16,"n"],[29,19,20,17],[29,21,20,19],[30,4,21,4],[30,11,21,11],[30,12,21,12,"n"],[30,13,21,13],[30,16,21,16,"BIP32_HARDENED_BIT"],[30,34,21,34],[30,40,21,40],[30,41,21,41],[31,2,22,0],[32,2,23,0],[32,8,23,6,"INS_GET_PUBKEY"],[32,22,23,20],[32,25,23,23],[32,29,23,27],[33,2,24,0],[33,8,24,6,"INS_SIGN_MESSAGE"],[33,24,24,22],[33,27,24,25],[33,31,24,29],[34,2,25,0],[34,8,25,6,"P1_NON_CONFIRM"],[34,22,25,20],[34,25,25,23],[34,29,25,27],[35,2,26,0],[35,8,26,6,"P1_CONFIRM"],[35,18,26,16],[35,21,26,19],[35,25,26,23],[36,2,27,0],[36,8,27,6,"P2_EXTEND"],[36,17,27,15],[36,20,27,18],[36,24,27,22],[37,2,28,0],[37,8,28,6,"P2_MORE"],[37,15,28,13],[37,18,28,16],[37,22,28,20],[38,2,29,0],[38,8,29,6,"MAX_PAYLOAD"],[38,19,29,17],[38,22,29,20],[38,25,29,23],[39,2,30,0],[39,8,30,6,"LEDGER_CLA"],[39,18,30,16],[39,21,30,19],[39,25,30,23],[40,2,31,0],[41,2,32,7],[41,17,32,22,"getPublicKey"],[41,29,32,34,"getPublicKey"],[41,30,32,35,"transport"],[41,39,32,44],[41,41,32,46,"derivationPath"],[41,55,32,60],[41,57,32,62],[42,4,33,4],[42,10,33,10,"bytes"],[42,15,33,15],[42,18,33,18],[42,24,33,24,"send"],[42,28,33,28],[42,29,33,29,"transport"],[42,38,33,38],[42,40,33,40,"INS_GET_PUBKEY"],[42,54,33,54],[42,56,33,56,"P1_NON_CONFIRM"],[42,70,33,70],[42,72,33,72,"derivationPath"],[42,86,33,86],[42,87,33,87],[43,4,34,4],[43,11,34,11],[43,15,34,15,"PublicKey"],[43,28,34,24],[43,29,34,24,"PublicKey"],[43,38,34,24],[43,39,34,25,"bytes"],[43,44,34,30],[43,45,34,31],[44,2,35,0],[45,2,36,0],[46,2,37,7],[46,17,37,22,"signTransaction"],[46,32,37,37,"signTransaction"],[46,33,37,38,"transport"],[46,42,37,47],[46,44,37,49,"transaction"],[46,55,37,60],[46,57,37,62,"derivationPath"],[46,71,37,76],[46,73,37,78],[47,4,38,4],[47,10,38,10,"paths"],[47,15,38,15],[47,18,38,18,"Buffer"],[47,24,38,24],[47,25,38,25,"alloc"],[47,30,38,30],[47,31,38,31],[47,32,38,32],[47,33,38,33],[48,4,39,4,"paths"],[48,9,39,9],[48,10,39,10,"writeUInt8"],[48,20,39,20],[48,21,39,21],[48,22,39,22],[48,24,39,24],[48,25,39,25],[48,26,39,26],[49,4,40,4],[49,10,40,10,"message"],[49,17,40,17],[49,20,40,20],[49,24,40,20,"isVersionedTransaction"],[49,48,40,42],[49,49,40,42,"isVersionedTransaction"],[49,71,40,42],[49,73,40,43,"transaction"],[49,84,40,54],[49,85,40,55],[49,88,41,10,"transaction"],[49,99,41,21],[49,100,41,22,"message"],[49,107,41,29],[49,108,41,30,"serialize"],[49,117,41,39],[49,118,41,40],[49,119,41,41],[49,122,42,10,"transaction"],[49,133,42,21],[49,134,42,22,"serializeMessage"],[49,150,42,38],[49,151,42,39],[49,152,42,40],[50,4,43,4],[50,10,43,10,"data"],[50,14,43,14],[50,17,43,17,"Buffer"],[50,23,43,23],[50,24,43,24,"concat"],[50,30,43,30],[50,31,43,31],[50,32,43,32,"paths"],[50,37,43,37],[50,39,43,39,"derivationPath"],[50,53,43,53],[50,55,43,55,"message"],[50,62,43,62],[50,63,43,63],[50,64,43,64],[51,4,44,4],[51,11,44,11],[51,17,44,17,"send"],[51,21,44,21],[51,22,44,22,"transport"],[51,31,44,31],[51,33,44,33,"INS_SIGN_MESSAGE"],[51,49,44,49],[51,51,44,51,"P1_CONFIRM"],[51,61,44,61],[51,63,44,63,"data"],[51,67,44,67],[51,68,44,68],[52,2,45,0],[53,2,46,0],[53,17,46,15,"send"],[53,21,46,19,"send"],[53,22,46,20,"transport"],[53,31,46,29],[53,33,46,31,"instruction"],[53,44,46,42],[53,46,46,44,"p1"],[53,48,46,46],[53,50,46,48,"data"],[53,54,46,52],[53,56,46,54],[54,4,47,4],[54,8,47,8,"p2"],[54,10,47,10],[54,13,47,13],[54,14,47,14],[55,4,48,4],[55,8,48,8,"offset"],[55,14,48,14],[55,17,48,17],[55,18,48,18],[56,4,49,4],[56,8,49,8,"data"],[56,12,49,12],[56,13,49,13,"length"],[56,19,49,19],[56,22,49,22,"MAX_PAYLOAD"],[56,33,49,33],[56,35,49,35],[57,6,50,8],[57,13,50,15,"data"],[57,17,50,19],[57,18,50,20,"length"],[57,24,50,26],[57,27,50,29,"offset"],[57,33,50,35],[57,36,50,38,"MAX_PAYLOAD"],[57,47,50,49],[57,49,50,51],[58,8,51,12],[58,14,51,18,"buffer"],[58,20,51,24],[58,23,51,27,"data"],[58,27,51,31],[58,28,51,32,"slice"],[58,33,51,37],[58,34,51,38,"offset"],[58,40,51,44],[58,42,51,46,"offset"],[58,48,51,52],[58,51,51,55,"MAX_PAYLOAD"],[58,62,51,66],[58,63,51,67],[59,8,52,12],[59,14,52,18,"response"],[59,22,52,26],[59,25,52,29],[59,31,52,35,"transport"],[59,40,52,44],[59,41,52,45,"send"],[59,45,52,49],[59,46,52,50,"LEDGER_CLA"],[59,56,52,60],[59,58,52,62,"instruction"],[59,69,52,73],[59,71,52,75,"p1"],[59,73,52,77],[59,75,52,79,"p2"],[59,77,52,81],[59,80,52,84,"P2_MORE"],[59,87,52,91],[59,89,52,93,"buffer"],[59,95,52,99],[59,96,52,100],[60,8,53,12],[61,8,54,12],[61,12,54,16,"response"],[61,20,54,24],[61,21,54,25,"length"],[61,27,54,31],[61,32,54,36],[61,33,54,37],[61,35,55,16],[61,41,55,22],[61,45,55,26,"TransportStatusError"],[61,65,55,46],[61,66,55,46,"TransportStatusError"],[61,86,55,46],[61,87,55,47,"StatusCodes"],[61,107,55,58],[61,108,55,58,"StatusCodes"],[61,119,55,58],[61,120,55,59,"INCORRECT_DATA"],[61,134,55,73],[61,135,55,74],[62,8,56,12,"p2"],[62,10,56,14],[62,14,56,18,"P2_EXTEND"],[62,23,56,27],[63,8,57,12,"offset"],[63,14,57,18],[63,18,57,22,"MAX_PAYLOAD"],[63,29,57,33],[64,6,58,8],[65,4,59,4],[66,4,60,4],[66,10,60,10,"buffer"],[66,16,60,16],[66,19,60,19,"data"],[66,23,60,23],[66,24,60,24,"slice"],[66,29,60,29],[66,30,60,30,"offset"],[66,36,60,36],[66,37,60,37],[67,4,61,4],[67,10,61,10,"response"],[67,18,61,18],[67,21,61,21],[67,27,61,27,"transport"],[67,36,61,36],[67,37,61,37,"send"],[67,41,61,41],[67,42,61,42,"LEDGER_CLA"],[67,52,61,52],[67,54,61,54,"instruction"],[67,65,61,65],[67,67,61,67,"p1"],[67,69,61,69],[67,71,61,71,"p2"],[67,73,61,73],[67,75,61,75,"buffer"],[67,81,61,81],[67,82,61,82],[68,4,62,4],[68,11,62,11,"response"],[68,19,62,19],[68,20,62,20,"slice"],[68,25,62,25],[68,26,62,26],[68,27,62,27],[68,29,62,29,"response"],[68,37,62,37],[68,38,62,38,"length"],[68,44,62,44],[68,47,62,47],[68,48,62,48],[68,49,62,49],[69,2,63,0],[70,0,63,1],[70,3]],"functionMap":{"names":["<global>","getDerivationPath","harden","getPublicKey","signTransaction","send"],"mappings":"AAA;OCI;CDa;AEE;CFE;OGU;CHG;OIE;CJQ;AKC;CLiB"},"hasCjsExports":false},"type":"js/module"}]}