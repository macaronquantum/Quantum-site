{"dependencies":[{"name":"../address/isAddress.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"8fiY6HrHaNOn7prFYrXJoAofgVU=","exportNames":["*"],"imports":1}},{"name":"../address/isAddressEqual.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":62,"index":115}}],"key":"g7Heh1CcuKgiDNOJYMlZD8SYUXg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.validateSiweMessage = validateSiweMessage;\n  var _addressIsAddressJs = require(_dependencyMap[0], \"../address/isAddress.js\");\n  var _addressIsAddressEqualJs = require(_dependencyMap[1], \"../address/isAddressEqual.js\");\n  /**\n   * @description Validates EIP-4361 message.\n   *\n   * @see https://eips.ethereum.org/EIPS/eip-4361\n   */\n  function validateSiweMessage(parameters) {\n    const {\n      address,\n      domain,\n      message,\n      nonce,\n      scheme,\n      time = new Date()\n    } = parameters;\n    if (domain && message.domain !== domain) return false;\n    if (nonce && message.nonce !== nonce) return false;\n    if (scheme && message.scheme !== scheme) return false;\n    if (message.expirationTime && time >= message.expirationTime) return false;\n    if (message.notBefore && time < message.notBefore) return false;\n    try {\n      if (!message.address) return false;\n      if (!(0, _addressIsAddressJs.isAddress)(message.address, {\n        strict: false\n      })) return false;\n      if (address && !(0, _addressIsAddressEqualJs.isAddressEqual)(message.address, address)) return false;\n    } catch {\n      return false;\n    }\n    return true;\n  }\n});","lineCount":40,"map":[[7,2,8,0,"exports"],[7,9,8,0],[7,10,8,0,"validateSiweMessage"],[7,29,8,0],[7,32,8,0,"validateSiweMessage"],[7,51,8,0],[8,2,1,0],[8,6,1,0,"_addressIsAddressJs"],[8,25,1,0],[8,28,1,0,"require"],[8,35,1,0],[8,36,1,0,"_dependencyMap"],[8,50,1,0],[9,2,2,0],[9,6,2,0,"_addressIsAddressEqualJs"],[9,30,2,0],[9,33,2,0,"require"],[9,40,2,0],[9,41,2,0,"_dependencyMap"],[9,55,2,0],[10,2,3,0],[11,0,4,0],[12,0,5,0],[13,0,6,0],[14,0,7,0],[15,2,8,7],[15,11,8,16,"validateSiweMessage"],[15,30,8,35,"validateSiweMessage"],[15,31,8,36,"parameters"],[15,41,8,46],[15,43,8,48],[16,4,9,4],[16,10,9,10],[17,6,9,12,"address"],[17,13,9,19],[18,6,9,21,"domain"],[18,12,9,27],[19,6,9,29,"message"],[19,13,9,36],[20,6,9,38,"nonce"],[20,11,9,43],[21,6,9,45,"scheme"],[21,12,9,51],[22,6,9,53,"time"],[22,10,9,57],[22,13,9,60],[22,17,9,64,"Date"],[22,21,9,68],[22,22,9,69],[23,4,9,72],[23,5,9,73],[23,8,9,76,"parameters"],[23,18,9,86],[24,4,10,4],[24,8,10,8,"domain"],[24,14,10,14],[24,18,10,18,"message"],[24,25,10,25],[24,26,10,26,"domain"],[24,32,10,32],[24,37,10,37,"domain"],[24,43,10,43],[24,45,11,8],[24,52,11,15],[24,57,11,20],[25,4,12,4],[25,8,12,8,"nonce"],[25,13,12,13],[25,17,12,17,"message"],[25,24,12,24],[25,25,12,25,"nonce"],[25,30,12,30],[25,35,12,35,"nonce"],[25,40,12,40],[25,42,13,8],[25,49,13,15],[25,54,13,20],[26,4,14,4],[26,8,14,8,"scheme"],[26,14,14,14],[26,18,14,18,"message"],[26,25,14,25],[26,26,14,26,"scheme"],[26,32,14,32],[26,37,14,37,"scheme"],[26,43,14,43],[26,45,15,8],[26,52,15,15],[26,57,15,20],[27,4,16,4],[27,8,16,8,"message"],[27,15,16,15],[27,16,16,16,"expirationTime"],[27,30,16,30],[27,34,16,34,"time"],[27,38,16,38],[27,42,16,42,"message"],[27,49,16,49],[27,50,16,50,"expirationTime"],[27,64,16,64],[27,66,17,8],[27,73,17,15],[27,78,17,20],[28,4,18,4],[28,8,18,8,"message"],[28,15,18,15],[28,16,18,16,"notBefore"],[28,25,18,25],[28,29,18,29,"time"],[28,33,18,33],[28,36,18,36,"message"],[28,43,18,43],[28,44,18,44,"notBefore"],[28,53,18,53],[28,55,19,8],[28,62,19,15],[28,67,19,20],[29,4,20,4],[29,8,20,8],[30,6,21,8],[30,10,21,12],[30,11,21,13,"message"],[30,18,21,20],[30,19,21,21,"address"],[30,26,21,28],[30,28,22,12],[30,35,22,19],[30,40,22,24],[31,6,23,8],[31,10,23,12],[31,11,23,13],[31,15,23,13,"isAddress"],[31,34,23,22],[31,35,23,22,"isAddress"],[31,44,23,22],[31,46,23,23,"message"],[31,53,23,30],[31,54,23,31,"address"],[31,61,23,38],[31,63,23,40],[32,8,23,42,"strict"],[32,14,23,48],[32,16,23,50],[33,6,23,56],[33,7,23,57],[33,8,23,58],[33,10,24,12],[33,17,24,19],[33,22,24,24],[34,6,25,8],[34,10,25,12,"address"],[34,17,25,19],[34,21,25,23],[34,22,25,24],[34,26,25,24,"isAddressEqual"],[34,50,25,38],[34,51,25,38,"isAddressEqual"],[34,65,25,38],[34,67,25,39,"message"],[34,74,25,46],[34,75,25,47,"address"],[34,82,25,54],[34,84,25,56,"address"],[34,91,25,63],[34,92,25,64],[34,94,26,12],[34,101,26,19],[34,106,26,24],[35,4,27,4],[35,5,27,5],[35,6,28,4],[35,12,28,10],[36,6,29,8],[36,13,29,15],[36,18,29,20],[37,4,30,4],[38,4,31,4],[38,11,31,11],[38,15,31,15],[39,2,32,0],[40,0,32,1],[40,3]],"functionMap":{"names":["<global>","validateSiweMessage"],"mappings":"AAA;OCO;CDwB"},"hasCjsExports":false},"type":"js/module"}]}