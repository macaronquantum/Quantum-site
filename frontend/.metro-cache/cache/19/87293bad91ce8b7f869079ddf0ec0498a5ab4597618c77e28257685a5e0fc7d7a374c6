{"dependencies":[{"name":"../wait.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":34,"index":34}}],"key":"T2bcpb9QdSYAATi/ze9KsRAxIWA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.withRetry = withRetry;\n  var _waitJs = require(_dependencyMap[0], \"../wait.js\");\n  function withRetry(fn, {\n    delay: delay_ = 100,\n    retryCount = 2,\n    shouldRetry = () => true\n  } = {}) {\n    return new Promise((resolve, reject) => {\n      const attemptRetry = async ({\n        count = 0\n      } = {}) => {\n        const retry = async ({\n          error\n        }) => {\n          const delay = typeof delay_ === 'function' ? delay_({\n            count,\n            error\n          }) : delay_;\n          if (delay) await (0, _waitJs.wait)(delay);\n          attemptRetry({\n            count: count + 1\n          });\n        };\n        try {\n          const data = await fn();\n          resolve(data);\n        } catch (err) {\n          if (count < retryCount && (await shouldRetry({\n            count,\n            error: err\n          }))) return retry({\n            error: err\n          });\n          reject(err);\n        }\n      };\n      attemptRetry();\n    });\n  }\n});","lineCount":46,"map":[[7,2,2,0,"exports"],[7,9,2,0],[7,10,2,0,"withRetry"],[7,19,2,0],[7,22,2,0,"withRetry"],[7,31,2,0],[8,2,1,0],[8,6,1,0,"_waitJs"],[8,13,1,0],[8,16,1,0,"require"],[8,23,1,0],[8,24,1,0,"_dependencyMap"],[8,38,1,0],[9,2,2,7],[9,11,2,16,"withRetry"],[9,20,2,25,"withRetry"],[9,21,2,26,"fn"],[9,23,2,28],[9,25,2,30],[10,4,2,32,"delay"],[10,9,2,37],[10,11,2,39,"delay_"],[10,17,2,45],[10,20,2,48],[10,23,2,51],[11,4,2,53,"retryCount"],[11,14,2,63],[11,17,2,66],[11,18,2,67],[12,4,2,69,"shouldRetry"],[12,15,2,80],[12,18,2,83,"shouldRetry"],[12,19,2,83],[12,24,2,89],[13,2,2,95],[13,3,2,96],[13,6,2,99],[13,7,2,100],[13,8,2,101],[13,10,2,103],[14,4,3,4],[14,11,3,11],[14,15,3,15,"Promise"],[14,22,3,22],[14,23,3,23],[14,24,3,24,"resolve"],[14,31,3,31],[14,33,3,33,"reject"],[14,39,3,39],[14,44,3,44],[15,6,4,8],[15,12,4,14,"attemptRetry"],[15,24,4,26],[15,27,4,29],[15,33,4,29,"attemptRetry"],[15,34,4,36],[16,8,4,38,"count"],[16,13,4,43],[16,16,4,46],[17,6,4,48],[17,7,4,49],[17,10,4,52],[17,11,4,53],[17,12,4,54],[17,17,4,59],[18,8,5,12],[18,14,5,18,"retry"],[18,19,5,23],[18,22,5,26],[18,28,5,26,"retry"],[18,29,5,33],[19,10,5,35,"error"],[20,8,5,41],[20,9,5,42],[20,14,5,47],[21,10,6,16],[21,16,6,22,"delay"],[21,21,6,27],[21,24,6,30],[21,31,6,37,"delay_"],[21,37,6,43],[21,42,6,48],[21,52,6,58],[21,55,6,61,"delay_"],[21,61,6,67],[21,62,6,68],[22,12,6,70,"count"],[22,17,6,75],[23,12,6,77,"error"],[24,10,6,83],[24,11,6,84],[24,12,6,85],[24,15,6,88,"delay_"],[24,21,6,94],[25,10,7,16],[25,14,7,20,"delay"],[25,19,7,25],[25,21,8,20],[25,27,8,26],[25,31,8,26,"wait"],[25,38,8,30],[25,39,8,30,"wait"],[25,43,8,30],[25,45,8,31,"delay"],[25,50,8,36],[25,51,8,37],[26,10,9,16,"attemptRetry"],[26,22,9,28],[26,23,9,29],[27,12,9,31,"count"],[27,17,9,36],[27,19,9,38,"count"],[27,24,9,43],[27,27,9,46],[28,10,9,48],[28,11,9,49],[28,12,9,50],[29,8,10,12],[29,9,10,13],[30,8,11,12],[30,12,11,16],[31,10,12,16],[31,16,12,22,"data"],[31,20,12,26],[31,23,12,29],[31,29,12,35,"fn"],[31,31,12,37],[31,32,12,38],[31,33,12,39],[32,10,13,16,"resolve"],[32,17,13,23],[32,18,13,24,"data"],[32,22,13,28],[32,23,13,29],[33,8,14,12],[33,9,14,13],[33,10,15,12],[33,17,15,19,"err"],[33,20,15,22],[33,22,15,24],[34,10,16,16],[34,14,16,20,"count"],[34,19,16,25],[34,22,16,28,"retryCount"],[34,32,16,38],[34,37,17,21],[34,43,17,27,"shouldRetry"],[34,54,17,38],[34,55,17,39],[35,12,17,41,"count"],[35,17,17,46],[36,12,17,48,"error"],[36,17,17,53],[36,19,17,55,"err"],[37,10,17,59],[37,11,17,60],[37,12,17,61],[37,13,17,62],[37,15,18,20],[37,22,18,27,"retry"],[37,27,18,32],[37,28,18,33],[38,12,18,35,"error"],[38,17,18,40],[38,19,18,42,"err"],[39,10,18,46],[39,11,18,47],[39,12,18,48],[40,10,19,16,"reject"],[40,16,19,22],[40,17,19,23,"err"],[40,20,19,26],[40,21,19,27],[41,8,20,12],[42,6,21,8],[42,7,21,9],[43,6,22,8,"attemptRetry"],[43,18,22,20],[43,19,22,21],[43,20,22,22],[44,4,23,4],[44,5,23,5],[44,6,23,6],[45,2,24,0],[46,0,24,1],[46,3]],"functionMap":{"names":["<global>","withRetry","<anonymous>","Promise$argument_0","attemptRetry","retry"],"mappings":"AAA;OCC,4EC,UD;uBEC;6BCC;0BCC;aDK;SDW;KFE;CDC"},"hasCjsExports":false},"type":"js/module"}]}