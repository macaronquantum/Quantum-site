{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.now = exports.removeTooOldValues = exports.ObliviousSet = void 0;\n  /**\n   * this is a set which automatically forgets\n   * a given entry when a new entry is set and the ttl\n   * of the old one is over\n   */\n  class ObliviousSet {\n    map = new Map();\n    /**\n     * Creating calls to setTimeout() is expensive,\n     * so we only do that if there is not timeout already open.\n     */\n    _to = false;\n    constructor(ttl) {\n      this.ttl = ttl;\n    }\n    has(value) {\n      return this.map.has(value);\n    }\n    add(value) {\n      this.map.set(value, now());\n      /**\n       * When a new value is added,\n       * start the cleanup at the next tick\n       * to not block the cpu for more important stuff\n       * that might happen.\n       */\n      if (!this._to) {\n        this._to = true;\n        setTimeout(() => {\n          this._to = false;\n          removeTooOldValues(this);\n        }, 0);\n      }\n    }\n    clear() {\n      this.map.clear();\n    }\n  }\n  exports.ObliviousSet = ObliviousSet;\n  /**\n   * Removes all entries from the set\n   * where the TTL has expired\n   */\n  function removeTooOldValues(obliviousSet) {\n    const olderThen = now() - obliviousSet.ttl;\n    const iterator = obliviousSet.map[Symbol.iterator]();\n    /**\n     * Because we can assume the new values are added at the bottom,\n     * we start from the top and stop as soon as we reach a non-too-old value.\n     */\n    while (true) {\n      const next = iterator.next().value;\n      if (!next) {\n        return; // no more elements\n      }\n      const value = next[0];\n      const time = next[1];\n      if (time < olderThen) {\n        obliviousSet.map.delete(value);\n      } else {\n        // We reached a value that is not old enough\n        return;\n      }\n    }\n  }\n  exports.removeTooOldValues = removeTooOldValues;\n  function now() {\n    return Date.now();\n  }\n  exports.now = now;\n});","lineCount":78,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"now"],[7,13,3,11],[7,16,3,14,"exports"],[7,23,3,21],[7,24,3,22,"removeTooOldValues"],[7,42,3,40],[7,45,3,43,"exports"],[7,52,3,50],[7,53,3,51,"ObliviousSet"],[7,65,3,63],[7,68,3,66],[7,73,3,71],[7,74,3,72],[8,2,4,0],[9,0,5,0],[10,0,6,0],[11,0,7,0],[12,0,8,0],[13,2,9,0],[13,8,9,6,"ObliviousSet"],[13,20,9,18],[13,21,9,19],[14,4,11,4,"map"],[14,7,11,7],[14,10,11,10],[14,14,11,14,"Map"],[14,17,11,17],[14,18,11,18],[14,19,11,19],[15,4,12,4],[16,0,13,0],[17,0,14,0],[18,0,15,0],[19,4,16,4,"_to"],[19,7,16,7],[19,10,16,10],[19,15,16,15],[20,4,17,4,"constructor"],[20,15,17,15,"constructor"],[20,16,17,16,"ttl"],[20,19,17,19],[20,21,17,21],[21,6,18,8],[21,10,18,12],[21,11,18,13,"ttl"],[21,14,18,16],[21,17,18,19,"ttl"],[21,20,18,22],[22,4,19,4],[23,4,20,4,"has"],[23,7,20,7,"has"],[23,8,20,8,"value"],[23,13,20,13],[23,15,20,15],[24,6,21,8],[24,13,21,15],[24,17,21,19],[24,18,21,20,"map"],[24,21,21,23],[24,22,21,24,"has"],[24,25,21,27],[24,26,21,28,"value"],[24,31,21,33],[24,32,21,34],[25,4,22,4],[26,4,23,4,"add"],[26,7,23,7,"add"],[26,8,23,8,"value"],[26,13,23,13],[26,15,23,15],[27,6,24,8],[27,10,24,12],[27,11,24,13,"map"],[27,14,24,16],[27,15,24,17,"set"],[27,18,24,20],[27,19,24,21,"value"],[27,24,24,26],[27,26,24,28,"now"],[27,29,24,31],[27,30,24,32],[27,31,24,33],[27,32,24,34],[28,6,25,8],[29,0,26,0],[30,0,27,0],[31,0,28,0],[32,0,29,0],[33,0,30,0],[34,6,31,8],[34,10,31,12],[34,11,31,13],[34,15,31,17],[34,16,31,18,"_to"],[34,19,31,21],[34,21,31,23],[35,8,32,12],[35,12,32,16],[35,13,32,17,"_to"],[35,16,32,20],[35,19,32,23],[35,23,32,27],[36,8,33,12,"setTimeout"],[36,18,33,22],[36,19,33,23],[36,25,33,29],[37,10,34,16],[37,14,34,20],[37,15,34,21,"_to"],[37,18,34,24],[37,21,34,27],[37,26,34,32],[38,10,35,16,"removeTooOldValues"],[38,28,35,34],[38,29,35,35],[38,33,35,39],[38,34,35,40],[39,8,36,12],[39,9,36,13],[39,11,36,15],[39,12,36,16],[39,13,36,17],[40,6,37,8],[41,4,38,4],[42,4,39,4,"clear"],[42,9,39,9,"clear"],[42,10,39,9],[42,12,39,12],[43,6,40,8],[43,10,40,12],[43,11,40,13,"map"],[43,14,40,16],[43,15,40,17,"clear"],[43,20,40,22],[43,21,40,23],[43,22,40,24],[44,4,41,4],[45,2,42,0],[46,2,43,0,"exports"],[46,9,43,7],[46,10,43,8,"ObliviousSet"],[46,22,43,20],[46,25,43,23,"ObliviousSet"],[46,37,43,35],[47,2,44,0],[48,0,45,0],[49,0,46,0],[50,0,47,0],[51,2,48,0],[51,11,48,9,"removeTooOldValues"],[51,29,48,27,"removeTooOldValues"],[51,30,48,28,"obliviousSet"],[51,42,48,40],[51,44,48,42],[52,4,49,4],[52,10,49,10,"olderThen"],[52,19,49,19],[52,22,49,22,"now"],[52,25,49,25],[52,26,49,26],[52,27,49,27],[52,30,49,30,"obliviousSet"],[52,42,49,42],[52,43,49,43,"ttl"],[52,46,49,46],[53,4,50,4],[53,10,50,10,"iterator"],[53,18,50,18],[53,21,50,21,"obliviousSet"],[53,33,50,33],[53,34,50,34,"map"],[53,37,50,37],[53,38,50,38,"Symbol"],[53,44,50,44],[53,45,50,45,"iterator"],[53,53,50,53],[53,54,50,54],[53,55,50,55],[53,56,50,56],[54,4,51,4],[55,0,52,0],[56,0,53,0],[57,0,54,0],[58,4,55,4],[58,11,55,11],[58,15,55,15],[58,17,55,17],[59,6,56,8],[59,12,56,14,"next"],[59,16,56,18],[59,19,56,21,"iterator"],[59,27,56,29],[59,28,56,30,"next"],[59,32,56,34],[59,33,56,35],[59,34,56,36],[59,35,56,37,"value"],[59,40,56,42],[60,6,57,8],[60,10,57,12],[60,11,57,13,"next"],[60,15,57,17],[60,17,57,19],[61,8,58,12],[61,15,58,19],[61,16,58,20],[62,6,59,8],[63,6,60,8],[63,12,60,14,"value"],[63,17,60,19],[63,20,60,22,"next"],[63,24,60,26],[63,25,60,27],[63,26,60,28],[63,27,60,29],[64,6,61,8],[64,12,61,14,"time"],[64,16,61,18],[64,19,61,21,"next"],[64,23,61,25],[64,24,61,26],[64,25,61,27],[64,26,61,28],[65,6,62,8],[65,10,62,12,"time"],[65,14,62,16],[65,17,62,19,"olderThen"],[65,26,62,28],[65,28,62,30],[66,8,63,12,"obliviousSet"],[66,20,63,24],[66,21,63,25,"map"],[66,24,63,28],[66,25,63,29,"delete"],[66,31,63,35],[66,32,63,36,"value"],[66,37,63,41],[66,38,63,42],[67,6,64,8],[67,7,64,9],[67,13,65,13],[68,8,66,12],[69,8,67,12],[70,6,68,8],[71,4,69,4],[72,2,70,0],[73,2,71,0,"exports"],[73,9,71,7],[73,10,71,8,"removeTooOldValues"],[73,28,71,26],[73,31,71,29,"removeTooOldValues"],[73,49,71,47],[74,2,72,0],[74,11,72,9,"now"],[74,14,72,12,"now"],[74,15,72,12],[74,17,72,15],[75,4,73,4],[75,11,73,11,"Date"],[75,15,73,15],[75,16,73,16,"now"],[75,19,73,19],[75,20,73,20],[75,21,73,21],[76,2,74,0],[77,2,75,0,"exports"],[77,9,75,7],[77,10,75,8,"now"],[77,13,75,11],[77,16,75,14,"now"],[77,19,75,17],[78,0,75,18],[78,3]],"functionMap":{"names":["<global>","ObliviousSet","ObliviousSet#constructor","ObliviousSet#has","ObliviousSet#add","setTimeout$argument_0","ObliviousSet#clear","removeTooOldValues","now"],"mappings":"AAA;ACQ;ICQ;KDE;IEC;KFE;IGC;uBCU;aDG;KHE;IKC;KLE;CDC;AOM;CPsB;AQE;CRE"},"hasCjsExports":true},"type":"js/module"}]}