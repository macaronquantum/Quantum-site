{"dependencies":[{"name":"../../utils/signature/hashMessage.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":67,"index":67}}],"key":"HWo3UjFOo4MsHmS/bYn4lXoJI7U=","exportNames":["*"],"imports":1}},{"name":"../../utils/siwe/parseSiweMessage.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":68},"end":{"line":2,"column":72,"index":140}}],"key":"EbyQfkYWNmTOVxt0go6qcHY8/DU=","exportNames":["*"],"imports":1}},{"name":"../../utils/siwe/validateSiweMessage.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":141},"end":{"line":3,"column":79,"index":220}}],"key":"sZj+ThuXZBGjAPcxtCX0SiewRxU=","exportNames":["*"],"imports":1}},{"name":"../public/verifyHash.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":221},"end":{"line":4,"column":54,"index":275}}],"key":"WTZZtOpnOOg39AHKGViWPmgHikY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.verifySiweMessage = verifySiweMessage;\n  var _utilsSignatureHashMessageJs = require(_dependencyMap[0], \"../../utils/signature/hashMessage.js\");\n  var _utilsSiweParseSiweMessageJs = require(_dependencyMap[1], \"../../utils/siwe/parseSiweMessage.js\");\n  var _utilsSiweValidateSiweMessageJs = require(_dependencyMap[2], \"../../utils/siwe/validateSiweMessage.js\");\n  var _publicVerifyHashJs = require(_dependencyMap[3], \"../public/verifyHash.js\");\n  /**\n   * Verifies [EIP-4361](https://eips.ethereum.org/EIPS/eip-4361) formatted message was signed.\n   *\n   * Compatible with Smart Contract Accounts & Externally Owned Accounts via [ERC-6492](https://eips.ethereum.org/EIPS/eip-6492).\n   *\n   * - Docs {@link https://viem.sh/docs/siwe/actions/verifySiweMessage}\n   *\n   * @param client - Client to use.\n   * @param parameters - {@link VerifySiweMessageParameters}\n   * @returns Whether or not the signature is valid. {@link VerifySiweMessageReturnType}\n   */\n  async function verifySiweMessage(client, parameters) {\n    const {\n      address,\n      domain,\n      message,\n      nonce,\n      scheme,\n      signature,\n      time = new Date(),\n      ...callRequest\n    } = parameters;\n    const parsed = (0, _utilsSiweParseSiweMessageJs.parseSiweMessage)(message);\n    if (!parsed.address) return false;\n    const isValid = (0, _utilsSiweValidateSiweMessageJs.validateSiweMessage)({\n      address,\n      domain,\n      message: parsed,\n      nonce,\n      scheme,\n      time\n    });\n    if (!isValid) return false;\n    const hash = (0, _utilsSignatureHashMessageJs.hashMessage)(message);\n    return (0, _publicVerifyHashJs.verifyHash)(client, {\n      address: parsed.address,\n      hash,\n      signature,\n      ...callRequest\n    });\n  }\n});","lineCount":53,"map":[[7,2,16,0,"exports"],[7,9,16,0],[7,10,16,0,"verifySiweMessage"],[7,27,16,0],[7,30,16,0,"verifySiweMessage"],[7,47,16,0],[8,2,1,0],[8,6,1,0,"_utilsSignatureHashMessageJs"],[8,34,1,0],[8,37,1,0,"require"],[8,44,1,0],[8,45,1,0,"_dependencyMap"],[8,59,1,0],[9,2,2,0],[9,6,2,0,"_utilsSiweParseSiweMessageJs"],[9,34,2,0],[9,37,2,0,"require"],[9,44,2,0],[9,45,2,0,"_dependencyMap"],[9,59,2,0],[10,2,3,0],[10,6,3,0,"_utilsSiweValidateSiweMessageJs"],[10,37,3,0],[10,40,3,0,"require"],[10,47,3,0],[10,48,3,0,"_dependencyMap"],[10,62,3,0],[11,2,4,0],[11,6,4,0,"_publicVerifyHashJs"],[11,25,4,0],[11,28,4,0,"require"],[11,35,4,0],[11,36,4,0,"_dependencyMap"],[11,50,4,0],[12,2,5,0],[13,0,6,0],[14,0,7,0],[15,0,8,0],[16,0,9,0],[17,0,10,0],[18,0,11,0],[19,0,12,0],[20,0,13,0],[21,0,14,0],[22,0,15,0],[23,2,16,7],[23,17,16,22,"verifySiweMessage"],[23,34,16,39,"verifySiweMessage"],[23,35,16,40,"client"],[23,41,16,46],[23,43,16,48,"parameters"],[23,53,16,58],[23,55,16,60],[24,4,17,4],[24,10,17,10],[25,6,17,12,"address"],[25,13,17,19],[26,6,17,21,"domain"],[26,12,17,27],[27,6,17,29,"message"],[27,13,17,36],[28,6,17,38,"nonce"],[28,11,17,43],[29,6,17,45,"scheme"],[29,12,17,51],[30,6,17,53,"signature"],[30,15,17,62],[31,6,17,64,"time"],[31,10,17,68],[31,13,17,71],[31,17,17,75,"Date"],[31,21,17,79],[31,22,17,80],[31,23,17,81],[32,6,17,83],[32,9,17,86,"callRequest"],[33,4,17,98],[33,5,17,99],[33,8,17,102,"parameters"],[33,18,17,112],[34,4,18,4],[34,10,18,10,"parsed"],[34,16,18,16],[34,19,18,19],[34,23,18,19,"parseSiweMessage"],[34,51,18,35],[34,52,18,35,"parseSiweMessage"],[34,68,18,35],[34,70,18,36,"message"],[34,77,18,43],[34,78,18,44],[35,4,19,4],[35,8,19,8],[35,9,19,9,"parsed"],[35,15,19,15],[35,16,19,16,"address"],[35,23,19,23],[35,25,20,8],[35,32,20,15],[35,37,20,20],[36,4,21,4],[36,10,21,10,"isValid"],[36,17,21,17],[36,20,21,20],[36,24,21,20,"validateSiweMessage"],[36,55,21,39],[36,56,21,39,"validateSiweMessage"],[36,75,21,39],[36,77,21,40],[37,6,22,8,"address"],[37,13,22,15],[38,6,23,8,"domain"],[38,12,23,14],[39,6,24,8,"message"],[39,13,24,15],[39,15,24,17,"parsed"],[39,21,24,23],[40,6,25,8,"nonce"],[40,11,25,13],[41,6,26,8,"scheme"],[41,12,26,14],[42,6,27,8,"time"],[43,4,28,4],[43,5,28,5],[43,6,28,6],[44,4,29,4],[44,8,29,8],[44,9,29,9,"isValid"],[44,16,29,16],[44,18,30,8],[44,25,30,15],[44,30,30,20],[45,4,31,4],[45,10,31,10,"hash"],[45,14,31,14],[45,17,31,17],[45,21,31,17,"hashMessage"],[45,49,31,28],[45,50,31,28,"hashMessage"],[45,61,31,28],[45,63,31,29,"message"],[45,70,31,36],[45,71,31,37],[46,4,32,4],[46,11,32,11],[46,15,32,11,"verifyHash"],[46,34,32,21],[46,35,32,21,"verifyHash"],[46,45,32,21],[46,47,32,22,"client"],[46,53,32,28],[46,55,32,30],[47,6,33,8,"address"],[47,13,33,15],[47,15,33,17,"parsed"],[47,21,33,23],[47,22,33,24,"address"],[47,29,33,31],[48,6,34,8,"hash"],[48,10,34,12],[49,6,35,8,"signature"],[49,15,35,17],[50,6,36,8],[50,9,36,11,"callRequest"],[51,4,37,4],[51,5,37,5],[51,6,37,6],[52,2,38,0],[53,0,38,1],[53,3]],"functionMap":{"names":["<global>","verifySiweMessage"],"mappings":"AAA;OCe;CDsB"},"hasCjsExports":false},"type":"js/module"}]}