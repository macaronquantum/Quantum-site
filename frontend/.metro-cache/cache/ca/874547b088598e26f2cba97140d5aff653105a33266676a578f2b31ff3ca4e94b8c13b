{"dependencies":[{"name":"./levels","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":19,"index":78},"end":{"line":4,"column":38,"index":97}}],"key":"RV0vlXbloNKZ40kBOBOlF2+VoiI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  const metadata = Symbol.for('pino.metadata');\n  const {\n    levels\n  } = require(_dependencyMap[0], \"./levels\");\n  const defaultLevels = Object.create(levels);\n  defaultLevels.silent = Infinity;\n  const DEFAULT_INFO_LEVEL = levels.info;\n  function multistream(streamsArray, opts) {\n    let counter = 0;\n    streamsArray = streamsArray || [];\n    opts = opts || {\n      dedupe: false\n    };\n    let levels = defaultLevels;\n    if (opts.levels && typeof opts.levels === 'object') {\n      levels = opts.levels;\n    }\n    const res = {\n      write,\n      add,\n      flushSync,\n      end,\n      minLevel: 0,\n      streams: [],\n      clone,\n      [metadata]: true\n    };\n    if (Array.isArray(streamsArray)) {\n      streamsArray.forEach(add, res);\n    } else {\n      add.call(res, streamsArray);\n    }\n\n    // clean this object up\n    // or it will stay allocated forever\n    // as it is closed on the following closures\n    streamsArray = null;\n    return res;\n\n    // we can exit early because the streams are ordered by level\n    function write(data) {\n      let dest;\n      const level = this.lastLevel;\n      const {\n        streams\n      } = this;\n      let stream;\n      for (let i = 0; i < streams.length; i++) {\n        dest = streams[i];\n        if (dest.level <= level) {\n          stream = dest.stream;\n          if (stream[metadata]) {\n            const {\n              lastTime,\n              lastMsg,\n              lastObj,\n              lastLogger\n            } = this;\n            stream.lastLevel = level;\n            stream.lastTime = lastTime;\n            stream.lastMsg = lastMsg;\n            stream.lastObj = lastObj;\n            stream.lastLogger = lastLogger;\n          }\n          if (!opts.dedupe || dest.level === level) {\n            stream.write(data);\n          }\n        } else {\n          break;\n        }\n      }\n    }\n    function flushSync() {\n      for (const {\n        stream\n      } of this.streams) {\n        if (typeof stream.flushSync === 'function') {\n          stream.flushSync();\n        }\n      }\n    }\n    function add(dest) {\n      if (!dest) {\n        return res;\n      }\n\n      // Check that dest implements either StreamEntry or DestinationStream\n      const isStream = typeof dest.write === 'function' || dest.stream;\n      const stream_ = dest.write ? dest : dest.stream;\n      // This is necessary to provide a meaningful error message, otherwise it throws somewhere inside write()\n      if (!isStream) {\n        throw Error('stream object needs to implement either StreamEntry or DestinationStream interface');\n      }\n      const {\n        streams\n      } = this;\n      let level;\n      if (typeof dest.levelVal === 'number') {\n        level = dest.levelVal;\n      } else if (typeof dest.level === 'string') {\n        level = levels[dest.level];\n      } else if (typeof dest.level === 'number') {\n        level = dest.level;\n      } else {\n        level = DEFAULT_INFO_LEVEL;\n      }\n      const dest_ = {\n        stream: stream_,\n        level,\n        levelVal: undefined,\n        id: counter++\n      };\n      streams.unshift(dest_);\n      streams.sort(compareByLevel);\n      this.minLevel = streams[0].level;\n      return res;\n    }\n    function end() {\n      for (const {\n        stream\n      } of this.streams) {\n        if (typeof stream.flushSync === 'function') {\n          stream.flushSync();\n        }\n        stream.end();\n      }\n    }\n    function clone(level) {\n      const streams = new Array(this.streams.length);\n      for (let i = 0; i < streams.length; i++) {\n        streams[i] = {\n          level: level,\n          stream: this.streams[i].stream\n        };\n      }\n      return {\n        write,\n        add,\n        minLevel: level,\n        streams,\n        clone,\n        flushSync,\n        [metadata]: true\n      };\n    }\n  }\n  function compareByLevel(a, b) {\n    return a.level - b.level;\n  }\n  module.exports = multistream;\n});","lineCount":154,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,8,3,6,"metadata"],[4,16,3,14],[4,19,3,17,"Symbol"],[4,25,3,23],[4,26,3,24,"for"],[4,29,3,27],[4,30,3,28],[4,45,3,43],[4,46,3,44],[5,2,4,0],[5,8,4,6],[6,4,4,8,"levels"],[7,2,4,15],[7,3,4,16],[7,6,4,19,"require"],[7,13,4,26],[7,14,4,26,"_dependencyMap"],[7,28,4,26],[7,43,4,37],[7,44,4,38],[8,2,6,0],[8,8,6,6,"defaultLevels"],[8,21,6,19],[8,24,6,22,"Object"],[8,30,6,28],[8,31,6,29,"create"],[8,37,6,35],[8,38,6,36,"levels"],[8,44,6,42],[8,45,6,43],[9,2,7,0,"defaultLevels"],[9,15,7,13],[9,16,7,14,"silent"],[9,22,7,20],[9,25,7,23,"Infinity"],[9,33,7,31],[10,2,9,0],[10,8,9,6,"DEFAULT_INFO_LEVEL"],[10,26,9,24],[10,29,9,27,"levels"],[10,35,9,33],[10,36,9,34,"info"],[10,40,9,38],[11,2,11,0],[11,11,11,9,"multistream"],[11,22,11,20,"multistream"],[11,23,11,22,"streamsArray"],[11,35,11,34],[11,37,11,36,"opts"],[11,41,11,40],[11,43,11,42],[12,4,12,2],[12,8,12,6,"counter"],[12,15,12,13],[12,18,12,16],[12,19,12,17],[13,4,13,2,"streamsArray"],[13,16,13,14],[13,19,13,17,"streamsArray"],[13,31,13,29],[13,35,13,33],[13,37,13,35],[14,4,14,2,"opts"],[14,8,14,6],[14,11,14,9,"opts"],[14,15,14,13],[14,19,14,17],[15,6,14,19,"dedupe"],[15,12,14,25],[15,14,14,27],[16,4,14,33],[16,5,14,34],[17,4,16,2],[17,8,16,6,"levels"],[17,14,16,12],[17,17,16,15,"defaultLevels"],[17,30,16,28],[18,4,17,2],[18,8,17,6,"opts"],[18,12,17,10],[18,13,17,11,"levels"],[18,19,17,17],[18,23,17,21],[18,30,17,28,"opts"],[18,34,17,32],[18,35,17,33,"levels"],[18,41,17,39],[18,46,17,44],[18,54,17,52],[18,56,17,54],[19,6,18,4,"levels"],[19,12,18,10],[19,15,18,13,"opts"],[19,19,18,17],[19,20,18,18,"levels"],[19,26,18,24],[20,4,19,2],[21,4,21,2],[21,10,21,8,"res"],[21,13,21,11],[21,16,21,14],[22,6,22,4,"write"],[22,11,22,9],[23,6,23,4,"add"],[23,9,23,7],[24,6,24,4,"flushSync"],[24,15,24,13],[25,6,25,4,"end"],[25,9,25,7],[26,6,26,4,"minLevel"],[26,14,26,12],[26,16,26,14],[26,17,26,15],[27,6,27,4,"streams"],[27,13,27,11],[27,15,27,13],[27,17,27,15],[28,6,28,4,"clone"],[28,11,28,9],[29,6,29,4],[29,7,29,5,"metadata"],[29,15,29,13],[29,18,29,16],[30,4,30,2],[30,5,30,3],[31,4,32,2],[31,8,32,6,"Array"],[31,13,32,11],[31,14,32,12,"isArray"],[31,21,32,19],[31,22,32,20,"streamsArray"],[31,34,32,32],[31,35,32,33],[31,37,32,35],[32,6,33,4,"streamsArray"],[32,18,33,16],[32,19,33,17,"forEach"],[32,26,33,24],[32,27,33,25,"add"],[32,30,33,28],[32,32,33,30,"res"],[32,35,33,33],[32,36,33,34],[33,4,34,2],[33,5,34,3],[33,11,34,9],[34,6,35,4,"add"],[34,9,35,7],[34,10,35,8,"call"],[34,14,35,12],[34,15,35,13,"res"],[34,18,35,16],[34,20,35,18,"streamsArray"],[34,32,35,30],[34,33,35,31],[35,4,36,2],[37,4,38,2],[38,4,39,2],[39,4,40,2],[40,4,41,2,"streamsArray"],[40,16,41,14],[40,19,41,17],[40,23,41,21],[41,4,43,2],[41,11,43,9,"res"],[41,14,43,12],[43,4,45,2],[44,4,46,2],[44,13,46,11,"write"],[44,18,46,16,"write"],[44,19,46,18,"data"],[44,23,46,22],[44,25,46,24],[45,6,47,4],[45,10,47,8,"dest"],[45,14,47,12],[46,6,48,4],[46,12,48,10,"level"],[46,17,48,15],[46,20,48,18],[46,24,48,22],[46,25,48,23,"lastLevel"],[46,34,48,32],[47,6,49,4],[47,12,49,10],[48,8,49,12,"streams"],[49,6,49,20],[49,7,49,21],[49,10,49,24],[49,14,49,28],[50,6,50,4],[50,10,50,8,"stream"],[50,16,50,14],[51,6,51,4],[51,11,51,9],[51,15,51,13,"i"],[51,16,51,14],[51,19,51,17],[51,20,51,18],[51,22,51,20,"i"],[51,23,51,21],[51,26,51,24,"streams"],[51,33,51,31],[51,34,51,32,"length"],[51,40,51,38],[51,42,51,40,"i"],[51,43,51,41],[51,45,51,43],[51,47,51,45],[52,8,52,6,"dest"],[52,12,52,10],[52,15,52,13,"streams"],[52,22,52,20],[52,23,52,21,"i"],[52,24,52,22],[52,25,52,23],[53,8,53,6],[53,12,53,10,"dest"],[53,16,53,14],[53,17,53,15,"level"],[53,22,53,20],[53,26,53,24,"level"],[53,31,53,29],[53,33,53,31],[54,10,54,8,"stream"],[54,16,54,14],[54,19,54,17,"dest"],[54,23,54,21],[54,24,54,22,"stream"],[54,30,54,28],[55,10,55,8],[55,14,55,12,"stream"],[55,20,55,18],[55,21,55,19,"metadata"],[55,29,55,27],[55,30,55,28],[55,32,55,30],[56,12,56,10],[56,18,56,16],[57,14,56,18,"lastTime"],[57,22,56,26],[58,14,56,28,"lastMsg"],[58,21,56,35],[59,14,56,37,"lastObj"],[59,21,56,44],[60,14,56,46,"lastLogger"],[61,12,56,57],[61,13,56,58],[61,16,56,61],[61,20,56,65],[62,12,57,10,"stream"],[62,18,57,16],[62,19,57,17,"lastLevel"],[62,28,57,26],[62,31,57,29,"level"],[62,36,57,34],[63,12,58,10,"stream"],[63,18,58,16],[63,19,58,17,"lastTime"],[63,27,58,25],[63,30,58,28,"lastTime"],[63,38,58,36],[64,12,59,10,"stream"],[64,18,59,16],[64,19,59,17,"lastMsg"],[64,26,59,24],[64,29,59,27,"lastMsg"],[64,36,59,34],[65,12,60,10,"stream"],[65,18,60,16],[65,19,60,17,"lastObj"],[65,26,60,24],[65,29,60,27,"lastObj"],[65,36,60,34],[66,12,61,10,"stream"],[66,18,61,16],[66,19,61,17,"lastLogger"],[66,29,61,27],[66,32,61,30,"lastLogger"],[66,42,61,40],[67,10,62,8],[68,10,63,8],[68,14,63,12],[68,15,63,13,"opts"],[68,19,63,17],[68,20,63,18,"dedupe"],[68,26,63,24],[68,30,63,28,"dest"],[68,34,63,32],[68,35,63,33,"level"],[68,40,63,38],[68,45,63,43,"level"],[68,50,63,48],[68,52,63,50],[69,12,64,10,"stream"],[69,18,64,16],[69,19,64,17,"write"],[69,24,64,22],[69,25,64,23,"data"],[69,29,64,27],[69,30,64,28],[70,10,65,8],[71,8,66,6],[71,9,66,7],[71,15,66,13],[72,10,67,8],[73,8,68,6],[74,6,69,4],[75,4,70,2],[76,4,72,2],[76,13,72,11,"flushSync"],[76,22,72,20,"flushSync"],[76,23,72,20],[76,25,72,24],[77,6,73,4],[77,11,73,9],[77,17,73,15],[78,8,73,17,"stream"],[79,6,73,24],[79,7,73,25],[79,11,73,29],[79,15,73,33],[79,16,73,34,"streams"],[79,23,73,41],[79,25,73,43],[80,8,74,6],[80,12,74,10],[80,19,74,17,"stream"],[80,25,74,23],[80,26,74,24,"flushSync"],[80,35,74,33],[80,40,74,38],[80,50,74,48],[80,52,74,50],[81,10,75,8,"stream"],[81,16,75,14],[81,17,75,15,"flushSync"],[81,26,75,24],[81,27,75,25],[81,28,75,26],[82,8,76,6],[83,6,77,4],[84,4,78,2],[85,4,80,2],[85,13,80,11,"add"],[85,16,80,14,"add"],[85,17,80,16,"dest"],[85,21,80,20],[85,23,80,22],[86,6,81,4],[86,10,81,8],[86,11,81,9,"dest"],[86,15,81,13],[86,17,81,15],[87,8,82,6],[87,15,82,13,"res"],[87,18,82,16],[88,6,83,4],[90,6,85,4],[91,6,86,4],[91,12,86,10,"isStream"],[91,20,86,18],[91,23,86,21],[91,30,86,28,"dest"],[91,34,86,32],[91,35,86,33,"write"],[91,40,86,38],[91,45,86,43],[91,55,86,53],[91,59,86,57,"dest"],[91,63,86,61],[91,64,86,62,"stream"],[91,70,86,68],[92,6,87,4],[92,12,87,10,"stream_"],[92,19,87,17],[92,22,87,20,"dest"],[92,26,87,24],[92,27,87,25,"write"],[92,32,87,30],[92,35,87,33,"dest"],[92,39,87,37],[92,42,87,40,"dest"],[92,46,87,44],[92,47,87,45,"stream"],[92,53,87,51],[93,6,88,4],[94,6,89,4],[94,10,89,8],[94,11,89,9,"isStream"],[94,19,89,17],[94,21,89,19],[95,8,90,6],[95,14,90,12,"Error"],[95,19,90,17],[95,20,90,18],[95,104,90,102],[95,105,90,103],[96,6,91,4],[97,6,93,4],[97,12,93,10],[98,8,93,12,"streams"],[99,6,93,20],[99,7,93,21],[99,10,93,24],[99,14,93,28],[100,6,95,4],[100,10,95,8,"level"],[100,15,95,13],[101,6,96,4],[101,10,96,8],[101,17,96,15,"dest"],[101,21,96,19],[101,22,96,20,"levelVal"],[101,30,96,28],[101,35,96,33],[101,43,96,41],[101,45,96,43],[102,8,97,6,"level"],[102,13,97,11],[102,16,97,14,"dest"],[102,20,97,18],[102,21,97,19,"levelVal"],[102,29,97,27],[103,6,98,4],[103,7,98,5],[103,13,98,11],[103,17,98,15],[103,24,98,22,"dest"],[103,28,98,26],[103,29,98,27,"level"],[103,34,98,32],[103,39,98,37],[103,47,98,45],[103,49,98,47],[104,8,99,6,"level"],[104,13,99,11],[104,16,99,14,"levels"],[104,22,99,20],[104,23,99,21,"dest"],[104,27,99,25],[104,28,99,26,"level"],[104,33,99,31],[104,34,99,32],[105,6,100,4],[105,7,100,5],[105,13,100,11],[105,17,100,15],[105,24,100,22,"dest"],[105,28,100,26],[105,29,100,27,"level"],[105,34,100,32],[105,39,100,37],[105,47,100,45],[105,49,100,47],[106,8,101,6,"level"],[106,13,101,11],[106,16,101,14,"dest"],[106,20,101,18],[106,21,101,19,"level"],[106,26,101,24],[107,6,102,4],[107,7,102,5],[107,13,102,11],[108,8,103,6,"level"],[108,13,103,11],[108,16,103,14,"DEFAULT_INFO_LEVEL"],[108,34,103,32],[109,6,104,4],[110,6,106,4],[110,12,106,10,"dest_"],[110,17,106,15],[110,20,106,18],[111,8,107,6,"stream"],[111,14,107,12],[111,16,107,14,"stream_"],[111,23,107,21],[112,8,108,6,"level"],[112,13,108,11],[113,8,109,6,"levelVal"],[113,16,109,14],[113,18,109,16,"undefined"],[113,27,109,25],[114,8,110,6,"id"],[114,10,110,8],[114,12,110,10,"counter"],[114,19,110,17],[115,6,111,4],[115,7,111,5],[116,6,113,4,"streams"],[116,13,113,11],[116,14,113,12,"unshift"],[116,21,113,19],[116,22,113,20,"dest_"],[116,27,113,25],[116,28,113,26],[117,6,114,4,"streams"],[117,13,114,11],[117,14,114,12,"sort"],[117,18,114,16],[117,19,114,17,"compareByLevel"],[117,33,114,31],[117,34,114,32],[118,6,116,4],[118,10,116,8],[118,11,116,9,"minLevel"],[118,19,116,17],[118,22,116,20,"streams"],[118,29,116,27],[118,30,116,28],[118,31,116,29],[118,32,116,30],[118,33,116,31,"level"],[118,38,116,36],[119,6,118,4],[119,13,118,11,"res"],[119,16,118,14],[120,4,119,2],[121,4,121,2],[121,13,121,11,"end"],[121,16,121,14,"end"],[121,17,121,14],[121,19,121,18],[122,6,122,4],[122,11,122,9],[122,17,122,15],[123,8,122,17,"stream"],[124,6,122,24],[124,7,122,25],[124,11,122,29],[124,15,122,33],[124,16,122,34,"streams"],[124,23,122,41],[124,25,122,43],[125,8,123,6],[125,12,123,10],[125,19,123,17,"stream"],[125,25,123,23],[125,26,123,24,"flushSync"],[125,35,123,33],[125,40,123,38],[125,50,123,48],[125,52,123,50],[126,10,124,8,"stream"],[126,16,124,14],[126,17,124,15,"flushSync"],[126,26,124,24],[126,27,124,25],[126,28,124,26],[127,8,125,6],[128,8,126,6,"stream"],[128,14,126,12],[128,15,126,13,"end"],[128,18,126,16],[128,19,126,17],[128,20,126,18],[129,6,127,4],[130,4,128,2],[131,4,130,2],[131,13,130,11,"clone"],[131,18,130,16,"clone"],[131,19,130,18,"level"],[131,24,130,23],[131,26,130,25],[132,6,131,4],[132,12,131,10,"streams"],[132,19,131,17],[132,22,131,20],[132,26,131,24,"Array"],[132,31,131,29],[132,32,131,30],[132,36,131,34],[132,37,131,35,"streams"],[132,44,131,42],[132,45,131,43,"length"],[132,51,131,49],[132,52,131,50],[133,6,133,4],[133,11,133,9],[133,15,133,13,"i"],[133,16,133,14],[133,19,133,17],[133,20,133,18],[133,22,133,20,"i"],[133,23,133,21],[133,26,133,24,"streams"],[133,33,133,31],[133,34,133,32,"length"],[133,40,133,38],[133,42,133,40,"i"],[133,43,133,41],[133,45,133,43],[133,47,133,45],[134,8,134,6,"streams"],[134,15,134,13],[134,16,134,14,"i"],[134,17,134,15],[134,18,134,16],[134,21,134,19],[135,10,135,8,"level"],[135,15,135,13],[135,17,135,15,"level"],[135,22,135,20],[136,10,136,8,"stream"],[136,16,136,14],[136,18,136,16],[136,22,136,20],[136,23,136,21,"streams"],[136,30,136,28],[136,31,136,29,"i"],[136,32,136,30],[136,33,136,31],[136,34,136,32,"stream"],[137,8,137,6],[137,9,137,7],[138,6,138,4],[139,6,140,4],[139,13,140,11],[140,8,141,6,"write"],[140,13,141,11],[141,8,142,6,"add"],[141,11,142,9],[142,8,143,6,"minLevel"],[142,16,143,14],[142,18,143,16,"level"],[142,23,143,21],[143,8,144,6,"streams"],[143,15,144,13],[144,8,145,6,"clone"],[144,13,145,11],[145,8,146,6,"flushSync"],[145,17,146,15],[146,8,147,6],[146,9,147,7,"metadata"],[146,17,147,15],[146,20,147,18],[147,6,148,4],[147,7,148,5],[148,4,149,2],[149,2,150,0],[150,2,152,0],[150,11,152,9,"compareByLevel"],[150,25,152,23,"compareByLevel"],[150,26,152,25,"a"],[150,27,152,26],[150,29,152,28,"b"],[150,30,152,29],[150,32,152,31],[151,4,153,2],[151,11,153,9,"a"],[151,12,153,10],[151,13,153,11,"level"],[151,18,153,16],[151,21,153,19,"b"],[151,22,153,20],[151,23,153,21,"level"],[151,28,153,26],[152,2,154,0],[153,2,156,0,"module"],[153,8,156,6],[153,9,156,7,"exports"],[153,16,156,14],[153,19,156,17,"multistream"],[153,30,156,28],[154,0,156,28],[154,3]],"functionMap":{"names":["<global>","multistream","write","flushSync","add","end","clone","compareByLevel"],"mappings":"AAA;ACU;ECmC;GDwB;EEE;GFM;EGE;GHuC;EIE;GJO;EKE;GLmB;CDC;AOE;CPE"},"hasCjsExports":true},"type":"js/module"}]}