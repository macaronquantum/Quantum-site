{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"listenersCache\", {\n    enumerable: true,\n    get: function () {\n      return listenersCache;\n    }\n  });\n  Object.defineProperty(exports, \"cleanupCache\", {\n    enumerable: true,\n    get: function () {\n      return cleanupCache;\n    }\n  });\n  exports.observe = observe;\n  /** @internal */\n  const listenersCache = /*#__PURE__*/new Map();\n  /** @internal */\n  const cleanupCache = /*#__PURE__*/new Map();\n  let callbackCount = 0;\n  /**\n   * @description Sets up an observer for a given function. If another function\n   * is set up under the same observer id, the function will only be called once\n   * for both instances of the observer.\n   */\n  function observe(observerId, callbacks, fn) {\n    const callbackId = ++callbackCount;\n    const getListeners = () => listenersCache.get(observerId) || [];\n    const unsubscribe = () => {\n      const listeners = getListeners();\n      listenersCache.set(observerId, listeners.filter(cb => cb.id !== callbackId));\n    };\n    const unwatch = () => {\n      const listeners = getListeners();\n      if (!listeners.some(cb => cb.id === callbackId)) return;\n      const cleanup = cleanupCache.get(observerId);\n      if (listeners.length === 1 && cleanup) {\n        const p = cleanup();\n        if (p instanceof Promise) p.catch(() => {});\n      }\n      unsubscribe();\n    };\n    const listeners = getListeners();\n    listenersCache.set(observerId, [...listeners, {\n      id: callbackId,\n      fns: callbacks\n    }]);\n    if (listeners && listeners.length > 0) return unwatch;\n    const emit = {};\n    for (const key in callbacks) {\n      emit[key] = (...args) => {\n        const listeners = getListeners();\n        if (listeners.length === 0) return;\n        for (const listener of listeners) listener.fns[key]?.(...args);\n      };\n    }\n    const cleanup = fn(emit);\n    if (typeof cleanup === 'function') cleanupCache.set(observerId, cleanup);\n    return unwatch;\n  }\n});","lineCount":65,"map":[[7,2,2,0,"Object"],[7,8,2,0],[7,9,2,0,"defineProperty"],[7,23,2,0],[7,24,2,0,"exports"],[7,31,2,0],[8,4,2,0,"enumerable"],[8,14,2,0],[9,4,2,0,"get"],[9,7,2,0],[9,18,2,0,"get"],[9,19,2,0],[10,6,2,0],[10,13,2,0,"listenersCache"],[10,27,2,0],[11,4,2,0],[12,2,2,0],[13,2,4,0,"Object"],[13,8,4,0],[13,9,4,0,"defineProperty"],[13,23,4,0],[13,24,4,0,"exports"],[13,31,4,0],[14,4,4,0,"enumerable"],[14,14,4,0],[15,4,4,0,"get"],[15,7,4,0],[15,18,4,0,"get"],[15,19,4,0],[16,6,4,0],[16,13,4,0,"cleanupCache"],[16,25,4,0],[17,4,4,0],[18,2,4,0],[19,2,11,0,"exports"],[19,9,11,0],[19,10,11,0,"observe"],[19,17,11,0],[19,20,11,0,"observe"],[19,27,11,0],[20,2,1,0],[21,2,2,7],[21,8,2,13,"listenersCache"],[21,22,2,27],[21,25,2,30],[21,38,2,44],[21,42,2,48,"Map"],[21,45,2,51],[21,46,2,52],[21,47,2,53],[22,2,3,0],[23,2,4,7],[23,8,4,13,"cleanupCache"],[23,20,4,25],[23,23,4,28],[23,36,4,42],[23,40,4,46,"Map"],[23,43,4,49],[23,44,4,50],[23,45,4,51],[24,2,5,0],[24,6,5,4,"callbackCount"],[24,19,5,17],[24,22,5,20],[24,23,5,21],[25,2,6,0],[26,0,7,0],[27,0,8,0],[28,0,9,0],[29,0,10,0],[30,2,11,7],[30,11,11,16,"observe"],[30,18,11,23,"observe"],[30,19,11,24,"observerId"],[30,29,11,34],[30,31,11,36,"callbacks"],[30,40,11,45],[30,42,11,47,"fn"],[30,44,11,49],[30,46,11,51],[31,4,12,4],[31,10,12,10,"callbackId"],[31,20,12,20],[31,23,12,23],[31,25,12,25,"callbackCount"],[31,38,12,38],[32,4,13,4],[32,10,13,10,"getListeners"],[32,22,13,22],[32,25,13,25,"getListeners"],[32,26,13,25],[32,31,13,31,"listenersCache"],[32,45,13,45],[32,46,13,46,"get"],[32,49,13,49],[32,50,13,50,"observerId"],[32,60,13,60],[32,61,13,61],[32,65,13,65],[32,67,13,67],[33,4,14,4],[33,10,14,10,"unsubscribe"],[33,21,14,21],[33,24,14,24,"unsubscribe"],[33,25,14,24],[33,30,14,30],[34,6,15,8],[34,12,15,14,"listeners"],[34,21,15,23],[34,24,15,26,"getListeners"],[34,36,15,38],[34,37,15,39],[34,38,15,40],[35,6,16,8,"listenersCache"],[35,20,16,22],[35,21,16,23,"set"],[35,24,16,26],[35,25,16,27,"observerId"],[35,35,16,37],[35,37,16,39,"listeners"],[35,46,16,48],[35,47,16,49,"filter"],[35,53,16,55],[35,54,16,57,"cb"],[35,56,16,59],[35,60,16,64,"cb"],[35,62,16,66],[35,63,16,67,"id"],[35,65,16,69],[35,70,16,74,"callbackId"],[35,80,16,84],[35,81,16,85],[35,82,16,86],[36,4,17,4],[36,5,17,5],[37,4,18,4],[37,10,18,10,"unwatch"],[37,17,18,17],[37,20,18,20,"unwatch"],[37,21,18,20],[37,26,18,26],[38,6,19,8],[38,12,19,14,"listeners"],[38,21,19,23],[38,24,19,26,"getListeners"],[38,36,19,38],[38,37,19,39],[38,38,19,40],[39,6,20,8],[39,10,20,12],[39,11,20,13,"listeners"],[39,20,20,22],[39,21,20,23,"some"],[39,25,20,27],[39,26,20,29,"cb"],[39,28,20,31],[39,32,20,36,"cb"],[39,34,20,38],[39,35,20,39,"id"],[39,37,20,41],[39,42,20,46,"callbackId"],[39,52,20,56],[39,53,20,57],[39,55,21,12],[40,6,22,8],[40,12,22,14,"cleanup"],[40,19,22,21],[40,22,22,24,"cleanupCache"],[40,34,22,36],[40,35,22,37,"get"],[40,38,22,40],[40,39,22,41,"observerId"],[40,49,22,51],[40,50,22,52],[41,6,23,8],[41,10,23,12,"listeners"],[41,19,23,21],[41,20,23,22,"length"],[41,26,23,28],[41,31,23,33],[41,32,23,34],[41,36,23,38,"cleanup"],[41,43,23,45],[41,45,23,47],[42,8,24,12],[42,14,24,18,"p"],[42,15,24,19],[42,18,24,22,"cleanup"],[42,25,24,29],[42,26,24,30],[42,27,24,31],[43,8,25,12],[43,12,25,16,"p"],[43,13,25,17],[43,25,25,29,"Promise"],[43,32,25,36],[43,34,26,16,"p"],[43,35,26,17],[43,36,26,18,"catch"],[43,41,26,23],[43,42,26,24],[43,48,26,30],[43,49,26,32],[43,50,26,33],[43,51,26,34],[44,6,27,8],[45,6,28,8,"unsubscribe"],[45,17,28,19],[45,18,28,20],[45,19,28,21],[46,4,29,4],[46,5,29,5],[47,4,30,4],[47,10,30,10,"listeners"],[47,19,30,19],[47,22,30,22,"getListeners"],[47,34,30,34],[47,35,30,35],[47,36,30,36],[48,4,31,4,"listenersCache"],[48,18,31,18],[48,19,31,19,"set"],[48,22,31,22],[48,23,31,23,"observerId"],[48,33,31,33],[48,35,31,35],[48,36,32,8],[48,39,32,11,"listeners"],[48,48,32,20],[48,50,33,8],[49,6,33,10,"id"],[49,8,33,12],[49,10,33,14,"callbackId"],[49,20,33,24],[50,6,33,26,"fns"],[50,9,33,29],[50,11,33,31,"callbacks"],[51,4,33,41],[51,5,33,42],[51,6,34,5],[51,7,34,6],[52,4,35,4],[52,8,35,8,"listeners"],[52,17,35,17],[52,21,35,21,"listeners"],[52,30,35,30],[52,31,35,31,"length"],[52,37,35,37],[52,40,35,40],[52,41,35,41],[52,43,36,8],[52,50,36,15,"unwatch"],[52,57,36,22],[53,4,37,4],[53,10,37,10,"emit"],[53,14,37,14],[53,17,37,17],[53,18,37,18],[53,19,37,19],[54,4,38,4],[54,9,38,9],[54,15,38,15,"key"],[54,18,38,18],[54,22,38,22,"callbacks"],[54,31,38,31],[54,33,38,33],[55,6,39,8,"emit"],[55,10,39,12],[55,11,39,13,"key"],[55,14,39,16],[55,15,39,17],[55,18,39,21],[55,19,39,22],[55,22,39,25,"args"],[55,26,39,29],[55,31,39,34],[56,8,40,12],[56,14,40,18,"listeners"],[56,23,40,27],[56,26,40,30,"getListeners"],[56,38,40,42],[56,39,40,43],[56,40,40,44],[57,8,41,12],[57,12,41,16,"listeners"],[57,21,41,25],[57,22,41,26,"length"],[57,28,41,32],[57,33,41,37],[57,34,41,38],[57,36,42,16],[58,8,43,12],[58,13,43,17],[58,19,43,23,"listener"],[58,27,43,31],[58,31,43,35,"listeners"],[58,40,43,44],[58,42,44,16,"listener"],[58,50,44,24],[58,51,44,25,"fns"],[58,54,44,28],[58,55,44,29,"key"],[58,58,44,32],[58,59,44,33],[58,62,44,36],[58,65,44,39,"args"],[58,69,44,43],[58,70,44,44],[59,6,45,8],[59,7,45,10],[60,4,46,4],[61,4,47,4],[61,10,47,10,"cleanup"],[61,17,47,17],[61,20,47,20,"fn"],[61,22,47,22],[61,23,47,23,"emit"],[61,27,47,27],[61,28,47,28],[62,4,48,4],[62,8,48,8],[62,15,48,15,"cleanup"],[62,22,48,22],[62,27,48,27],[62,37,48,37],[62,39,49,8,"cleanupCache"],[62,51,49,20],[62,52,49,21,"set"],[62,55,49,24],[62,56,49,25,"observerId"],[62,66,49,35],[62,68,49,37,"cleanup"],[62,75,49,44],[62,76,49,45],[63,4,50,4],[63,11,50,11,"unwatch"],[63,18,50,18],[64,2,51,0],[65,0,51,1],[65,3]],"functionMap":{"names":["<global>","observe","getListeners","unsubscribe","listeners.filter$argument_0","unwatch","listeners.some$argument_0","p._catch$argument_0","emit.key"],"mappings":"AAA;OCU;yBCE,0CD;wBEC;wDCE,4BD;KFC;oBIC;4BCE,4BD;wBEM,SF;KJG;qBOU;SPM;CDM"},"hasCjsExports":false},"type":"js/module"}]}