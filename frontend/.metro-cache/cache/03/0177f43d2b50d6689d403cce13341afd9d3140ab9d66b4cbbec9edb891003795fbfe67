{"dependencies":[{"name":"./util","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":15,"index":175},"end":{"line":4,"column":32,"index":192}}],"key":"hA8WsniBZrUJ/dmBZgrNdZcEmJ8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.softMixProtos = exports.proxyMix = exports.getIngredientWithProp = void 0;\n  const util_1 = require(_dependencyMap[0], \"./util\");\n  /**\n   * Finds the ingredient with the given prop, searching in reverse order and breadth-first if searching ingredient\n   * prototypes is required.\n   */\n  const getIngredientWithProp = (prop, ingredients) => {\n    const protoChains = ingredients.map(ingredient => (0, util_1.protoChain)(ingredient));\n    // since we search breadth-first, we need to keep track of our depth in the prototype chains\n    let protoDepth = 0;\n    // not all prototype chains are the same depth, so this remains true as long as at least one of the ingredients'\n    // prototype chains has an object at this depth\n    let protosAreLeftToSearch = true;\n    while (protosAreLeftToSearch) {\n      // with the start of each horizontal slice, we assume this is the one that's deeper than any of the proto chains\n      protosAreLeftToSearch = false;\n      // scan through the ingredients right to left\n      for (let i = ingredients.length - 1; i >= 0; i--) {\n        const searchTarget = protoChains[i][protoDepth];\n        if (searchTarget !== undefined && searchTarget !== null) {\n          // if we find something, this is proof that this horizontal slice potentially more objects to search\n          protosAreLeftToSearch = true;\n          // eureka, we found it\n          if (Object.getOwnPropertyDescriptor(searchTarget, prop) != undefined) {\n            return protoChains[i][0];\n          }\n        }\n      }\n      protoDepth++;\n    }\n    return undefined;\n  };\n  exports.getIngredientWithProp = getIngredientWithProp;\n  /**\n   * \"Mixes\" ingredients by wrapping them in a Proxy.  The optional prototype argument allows the mixed object to sit\n   * downstream of an existing prototype chain.  Note that \"properties\" cannot be added, deleted, or modified.\n   */\n  const proxyMix = (ingredients, prototype = Object.prototype) => new Proxy({}, {\n    getPrototypeOf() {\n      return prototype;\n    },\n    setPrototypeOf() {\n      throw Error('Cannot set prototype of Proxies created by ts-mixer');\n    },\n    getOwnPropertyDescriptor(_, prop) {\n      return Object.getOwnPropertyDescriptor((0, exports.getIngredientWithProp)(prop, ingredients) || {}, prop);\n    },\n    defineProperty() {\n      throw new Error('Cannot define new properties on Proxies created by ts-mixer');\n    },\n    has(_, prop) {\n      return (0, exports.getIngredientWithProp)(prop, ingredients) !== undefined || prototype[prop] !== undefined;\n    },\n    get(_, prop) {\n      return ((0, exports.getIngredientWithProp)(prop, ingredients) || prototype)[prop];\n    },\n    set(_, prop, val) {\n      const ingredientWithProp = (0, exports.getIngredientWithProp)(prop, ingredients);\n      if (ingredientWithProp === undefined) throw new Error('Cannot set new properties on Proxies created by ts-mixer');\n      ingredientWithProp[prop] = val;\n      return true;\n    },\n    deleteProperty() {\n      throw new Error('Cannot delete properties on Proxies created by ts-mixer');\n    },\n    ownKeys() {\n      return ingredients.map(Object.getOwnPropertyNames).reduce((prev, curr) => curr.concat(prev.filter(key => curr.indexOf(key) < 0)));\n    }\n  });\n  exports.proxyMix = proxyMix;\n  /**\n   * Creates a new proxy-prototype object that is a \"soft\" mixture of the given prototypes.  The mixing is achieved by\n   * proxying all property access to the ingredients.  This is not ES5 compatible and less performant.  However, any\n   * changes made to the source prototypes will be reflected in the proxy-prototype, which may be desirable.\n   */\n  const softMixProtos = (ingredients, constructor) => (0, exports.proxyMix)([...ingredients, {\n    constructor\n  }]);\n  exports.softMixProtos = softMixProtos;\n});","lineCount":86,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"softMixProtos"],[7,23,3,21],[7,26,3,24,"exports"],[7,33,3,31],[7,34,3,32,"proxyMix"],[7,42,3,40],[7,45,3,43,"exports"],[7,52,3,50],[7,53,3,51,"getIngredientWithProp"],[7,74,3,72],[7,77,3,75],[7,82,3,80],[7,83,3,81],[8,2,4,0],[8,8,4,6,"util_1"],[8,14,4,12],[8,17,4,15,"require"],[8,24,4,22],[8,25,4,22,"_dependencyMap"],[8,39,4,22],[8,52,4,31],[8,53,4,32],[9,2,5,0],[10,0,6,0],[11,0,7,0],[12,0,8,0],[13,2,9,0],[13,8,9,6,"getIngredientWithProp"],[13,29,9,27],[13,32,9,30,"getIngredientWithProp"],[13,33,9,31,"prop"],[13,37,9,35],[13,39,9,37,"ingredients"],[13,50,9,48],[13,55,9,53],[14,4,10,4],[14,10,10,10,"protoChains"],[14,21,10,21],[14,24,10,24,"ingredients"],[14,35,10,35],[14,36,10,36,"map"],[14,39,10,39],[14,40,10,40,"ingredient"],[14,50,10,50],[14,54,10,54],[14,55,10,55],[14,56,10,56],[14,58,10,58,"util_1"],[14,64,10,64],[14,65,10,65,"protoChain"],[14,75,10,75],[14,77,10,77,"ingredient"],[14,87,10,87],[14,88,10,88],[14,89,10,89],[15,4,11,4],[16,4,12,4],[16,8,12,8,"protoDepth"],[16,18,12,18],[16,21,12,21],[16,22,12,22],[17,4,13,4],[18,4,14,4],[19,4,15,4],[19,8,15,8,"protosAreLeftToSearch"],[19,29,15,29],[19,32,15,32],[19,36,15,36],[20,4,16,4],[20,11,16,11,"protosAreLeftToSearch"],[20,32,16,32],[20,34,16,34],[21,6,17,8],[22,6,18,8,"protosAreLeftToSearch"],[22,27,18,29],[22,30,18,32],[22,35,18,37],[23,6,19,8],[24,6,20,8],[24,11,20,13],[24,15,20,17,"i"],[24,16,20,18],[24,19,20,21,"ingredients"],[24,30,20,32],[24,31,20,33,"length"],[24,37,20,39],[24,40,20,42],[24,41,20,43],[24,43,20,45,"i"],[24,44,20,46],[24,48,20,50],[24,49,20,51],[24,51,20,53,"i"],[24,52,20,54],[24,54,20,56],[24,56,20,58],[25,8,21,12],[25,14,21,18,"searchTarget"],[25,26,21,30],[25,29,21,33,"protoChains"],[25,40,21,44],[25,41,21,45,"i"],[25,42,21,46],[25,43,21,47],[25,44,21,48,"protoDepth"],[25,54,21,58],[25,55,21,59],[26,8,22,12],[26,12,22,16,"searchTarget"],[26,24,22,28],[26,29,22,33,"undefined"],[26,38,22,42],[26,42,22,46,"searchTarget"],[26,54,22,58],[26,59,22,63],[26,63,22,67],[26,65,22,69],[27,10,23,16],[28,10,24,16,"protosAreLeftToSearch"],[28,31,24,37],[28,34,24,40],[28,38,24,44],[29,10,25,16],[30,10,26,16],[30,14,26,20,"Object"],[30,20,26,26],[30,21,26,27,"getOwnPropertyDescriptor"],[30,45,26,51],[30,46,26,52,"searchTarget"],[30,58,26,64],[30,60,26,66,"prop"],[30,64,26,70],[30,65,26,71],[30,69,26,75,"undefined"],[30,78,26,84],[30,80,26,86],[31,12,27,20],[31,19,27,27,"protoChains"],[31,30,27,38],[31,31,27,39,"i"],[31,32,27,40],[31,33,27,41],[31,34,27,42],[31,35,27,43],[31,36,27,44],[32,10,28,16],[33,8,29,12],[34,6,30,8],[35,6,31,8,"protoDepth"],[35,16,31,18],[35,18,31,20],[36,4,32,4],[37,4,33,4],[37,11,33,11,"undefined"],[37,20,33,20],[38,2,34,0],[38,3,34,1],[39,2,35,0,"exports"],[39,9,35,7],[39,10,35,8,"getIngredientWithProp"],[39,31,35,29],[39,34,35,32,"getIngredientWithProp"],[39,55,35,53],[40,2,36,0],[41,0,37,0],[42,0,38,0],[43,0,39,0],[44,2,40,0],[44,8,40,6,"proxyMix"],[44,16,40,14],[44,19,40,17,"proxyMix"],[44,20,40,18,"ingredients"],[44,31,40,29],[44,33,40,31,"prototype"],[44,42,40,40],[44,45,40,43,"Object"],[44,51,40,49],[44,52,40,50,"prototype"],[44,61,40,59],[44,66,40,64],[44,70,40,68,"Proxy"],[44,75,40,73],[44,76,40,74],[44,77,40,75],[44,78,40,76],[44,80,40,78],[45,4,41,4,"getPrototypeOf"],[45,18,41,18,"getPrototypeOf"],[45,19,41,18],[45,21,41,21],[46,6,42,8],[46,13,42,15,"prototype"],[46,22,42,24],[47,4,43,4],[47,5,43,5],[48,4,44,4,"setPrototypeOf"],[48,18,44,18,"setPrototypeOf"],[48,19,44,18],[48,21,44,21],[49,6,45,8],[49,12,45,14,"Error"],[49,17,45,19],[49,18,45,20],[49,71,45,73],[49,72,45,74],[50,4,46,4],[50,5,46,5],[51,4,47,4,"getOwnPropertyDescriptor"],[51,28,47,28,"getOwnPropertyDescriptor"],[51,29,47,29,"_"],[51,30,47,30],[51,32,47,32,"prop"],[51,36,47,36],[51,38,47,38],[52,6,48,8],[52,13,48,15,"Object"],[52,19,48,21],[52,20,48,22,"getOwnPropertyDescriptor"],[52,44,48,46],[52,45,48,47],[52,46,48,48],[52,47,48,49],[52,49,48,51,"exports"],[52,56,48,58],[52,57,48,59,"getIngredientWithProp"],[52,78,48,80],[52,80,48,82,"prop"],[52,84,48,86],[52,86,48,88,"ingredients"],[52,97,48,99],[52,98,48,100],[52,102,48,104],[52,103,48,105],[52,104,48,106],[52,106,48,108,"prop"],[52,110,48,112],[52,111,48,113],[53,4,49,4],[53,5,49,5],[54,4,50,4,"defineProperty"],[54,18,50,18,"defineProperty"],[54,19,50,18],[54,21,50,21],[55,6,51,8],[55,12,51,14],[55,16,51,18,"Error"],[55,21,51,23],[55,22,51,24],[55,83,51,85],[55,84,51,86],[56,4,52,4],[56,5,52,5],[57,4,53,4,"has"],[57,7,53,7,"has"],[57,8,53,8,"_"],[57,9,53,9],[57,11,53,11,"prop"],[57,15,53,15],[57,17,53,17],[58,6,54,8],[58,13,54,15],[58,14,54,16],[58,15,54,17],[58,17,54,19,"exports"],[58,24,54,26],[58,25,54,27,"getIngredientWithProp"],[58,46,54,48],[58,48,54,50,"prop"],[58,52,54,54],[58,54,54,56,"ingredients"],[58,65,54,67],[58,66,54,68],[58,71,54,73,"undefined"],[58,80,54,82],[58,84,54,86,"prototype"],[58,93,54,95],[58,94,54,96,"prop"],[58,98,54,100],[58,99,54,101],[58,104,54,106,"undefined"],[58,113,54,115],[59,4,55,4],[59,5,55,5],[60,4,56,4,"get"],[60,7,56,7,"get"],[60,8,56,8,"_"],[60,9,56,9],[60,11,56,11,"prop"],[60,15,56,15],[60,17,56,17],[61,6,57,8],[61,13,57,15],[61,14,57,16],[61,15,57,17],[61,16,57,18],[61,18,57,20,"exports"],[61,25,57,27],[61,26,57,28,"getIngredientWithProp"],[61,47,57,49],[61,49,57,51,"prop"],[61,53,57,55],[61,55,57,57,"ingredients"],[61,66,57,68],[61,67,57,69],[61,71,57,73,"prototype"],[61,80,57,82],[61,82,57,84,"prop"],[61,86,57,88],[61,87,57,89],[62,4,58,4],[62,5,58,5],[63,4,59,4,"set"],[63,7,59,7,"set"],[63,8,59,8,"_"],[63,9,59,9],[63,11,59,11,"prop"],[63,15,59,15],[63,17,59,17,"val"],[63,20,59,20],[63,22,59,22],[64,6,60,8],[64,12,60,14,"ingredientWithProp"],[64,30,60,32],[64,33,60,35],[64,34,60,36],[64,35,60,37],[64,37,60,39,"exports"],[64,44,60,46],[64,45,60,47,"getIngredientWithProp"],[64,66,60,68],[64,68,60,70,"prop"],[64,72,60,74],[64,74,60,76,"ingredients"],[64,85,60,87],[64,86,60,88],[65,6,61,8],[65,10,61,12,"ingredientWithProp"],[65,28,61,30],[65,33,61,35,"undefined"],[65,42,61,44],[65,44,62,12],[65,50,62,18],[65,54,62,22,"Error"],[65,59,62,27],[65,60,62,28],[65,118,62,86],[65,119,62,87],[66,6,63,8,"ingredientWithProp"],[66,24,63,26],[66,25,63,27,"prop"],[66,29,63,31],[66,30,63,32],[66,33,63,35,"val"],[66,36,63,38],[67,6,64,8],[67,13,64,15],[67,17,64,19],[68,4,65,4],[68,5,65,5],[69,4,66,4,"deleteProperty"],[69,18,66,18,"deleteProperty"],[69,19,66,18],[69,21,66,21],[70,6,67,8],[70,12,67,14],[70,16,67,18,"Error"],[70,21,67,23],[70,22,67,24],[70,79,67,81],[70,80,67,82],[71,4,68,4],[71,5,68,5],[72,4,69,4,"ownKeys"],[72,11,69,11,"ownKeys"],[72,12,69,11],[72,14,69,14],[73,6,70,8],[73,13,70,15,"ingredients"],[73,24,70,26],[73,25,71,13,"map"],[73,28,71,16],[73,29,71,17,"Object"],[73,35,71,23],[73,36,71,24,"getOwnPropertyNames"],[73,55,71,43],[73,56,71,44],[73,57,72,13,"reduce"],[73,63,72,19],[73,64,72,20],[73,65,72,21,"prev"],[73,69,72,25],[73,71,72,27,"curr"],[73,75,72,31],[73,80,72,36,"curr"],[73,84,72,40],[73,85,72,41,"concat"],[73,91,72,47],[73,92,72,48,"prev"],[73,96,72,52],[73,97,72,53,"filter"],[73,103,72,59],[73,104,72,60,"key"],[73,107,72,63],[73,111,72,67,"curr"],[73,115,72,71],[73,116,72,72,"indexOf"],[73,123,72,79],[73,124,72,80,"key"],[73,127,72,83],[73,128,72,84],[73,131,72,87],[73,132,72,88],[73,133,72,89],[73,134,72,90],[73,135,72,91],[74,4,73,4],[75,2,74,0],[75,3,74,1],[75,4,74,2],[76,2,75,0,"exports"],[76,9,75,7],[76,10,75,8,"proxyMix"],[76,18,75,16],[76,21,75,19,"proxyMix"],[76,29,75,27],[77,2,76,0],[78,0,77,0],[79,0,78,0],[80,0,79,0],[81,0,80,0],[82,2,81,0],[82,8,81,6,"softMixProtos"],[82,21,81,19],[82,24,81,22,"softMixProtos"],[82,25,81,23,"ingredients"],[82,36,81,34],[82,38,81,36,"constructor"],[82,49,81,47],[82,54,81,52],[82,55,81,53],[82,56,81,54],[82,58,81,56,"exports"],[82,65,81,63],[82,66,81,64,"proxyMix"],[82,74,81,72],[82,76,81,74],[82,77,81,75],[82,80,81,78,"ingredients"],[82,91,81,89],[82,93,81,91],[83,4,81,93,"constructor"],[84,2,81,105],[84,3,81,106],[84,4,81,107],[84,5,81,108],[85,2,82,0,"exports"],[85,9,82,7],[85,10,82,8,"softMixProtos"],[85,23,82,21],[85,26,82,24,"softMixProtos"],[85,39,82,37],[86,0,82,38],[86,3]],"functionMap":{"names":["<global>","getIngredientWithProp","ingredients.map$argument_0","proxyMix","Proxy$argument_1.getPrototypeOf","Proxy$argument_1.setPrototypeOf","Proxy$argument_1.getOwnPropertyDescriptor","Proxy$argument_1.defineProperty","Proxy$argument_1.has","Proxy$argument_1.get","Proxy$argument_1.set","Proxy$argument_1.deleteProperty","Proxy$argument_1.ownKeys","ingredients.map.reduce$argument_0","prev.filter$argument_0","softMixProtos"],"mappings":"AAA;8BCQ;wCCC,gDD;CDwB;iBGM;ICC;KDE;IEC;KFE;IGC;KHE;IIC;KJE;IKC;KLE;IMC;KNE;IOC;KPM;IQC;KRE;ISC;oBCG,wCC,4BD,ED;KTC;EHC;sBeO,sFf"},"hasCjsExports":true},"type":"js/module"}]}