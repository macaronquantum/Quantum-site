{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"listenersCache\", {\n    enumerable: true,\n    get: function () {\n      return listenersCache;\n    }\n  });\n  Object.defineProperty(exports, \"cleanupCache\", {\n    enumerable: true,\n    get: function () {\n      return cleanupCache;\n    }\n  });\n  exports.observe = observe;\n  /** @internal */\n  const listenersCache = /*#__PURE__*/new Map();\n  /** @internal */\n  const cleanupCache = /*#__PURE__*/new Map();\n  let callbackCount = 0;\n  /**\n   * @description Sets up an observer for a given function. If another function\n   * is set up under the same observer id, the function will only be called once\n   * for both instances of the observer.\n   */\n  function observe(observerId, callbacks, fn) {\n    const callbackId = ++callbackCount;\n    const getListeners = () => listenersCache.get(observerId) || [];\n    const unsubscribe = () => {\n      const listeners = getListeners();\n      listenersCache.set(observerId, listeners.filter(cb => cb.id !== callbackId));\n    };\n    const unwatch = () => {\n      const listeners = getListeners();\n      if (!listeners.some(cb => cb.id === callbackId)) return;\n      const cleanup = cleanupCache.get(observerId);\n      if (listeners.length === 1 && cleanup) cleanup();\n      unsubscribe();\n    };\n    const listeners = getListeners();\n    listenersCache.set(observerId, [...listeners, {\n      id: callbackId,\n      fns: callbacks\n    }]);\n    if (listeners && listeners.length > 0) return unwatch;\n    const emit = {};\n    for (const key in callbacks) {\n      emit[key] = (...args) => {\n        const listeners = getListeners();\n        if (listeners.length === 0) return;\n        for (const listener of listeners) listener.fns[key]?.(...args);\n      };\n    }\n    const cleanup = fn(emit);\n    if (typeof cleanup === 'function') cleanupCache.set(observerId, cleanup);\n    return unwatch;\n  }\n});","lineCount":62,"map":[[7,2,2,0,"Object"],[7,8,2,0],[7,9,2,0,"defineProperty"],[7,23,2,0],[7,24,2,0,"exports"],[7,31,2,0],[8,4,2,0,"enumerable"],[8,14,2,0],[9,4,2,0,"get"],[9,7,2,0],[9,18,2,0,"get"],[9,19,2,0],[10,6,2,0],[10,13,2,0,"listenersCache"],[10,27,2,0],[11,4,2,0],[12,2,2,0],[13,2,4,0,"Object"],[13,8,4,0],[13,9,4,0,"defineProperty"],[13,23,4,0],[13,24,4,0,"exports"],[13,31,4,0],[14,4,4,0,"enumerable"],[14,14,4,0],[15,4,4,0,"get"],[15,7,4,0],[15,18,4,0,"get"],[15,19,4,0],[16,6,4,0],[16,13,4,0,"cleanupCache"],[16,25,4,0],[17,4,4,0],[18,2,4,0],[19,2,11,0,"exports"],[19,9,11,0],[19,10,11,0,"observe"],[19,17,11,0],[19,20,11,0,"observe"],[19,27,11,0],[20,2,1,0],[21,2,2,7],[21,8,2,13,"listenersCache"],[21,22,2,27],[21,25,2,30],[21,38,2,44],[21,42,2,48,"Map"],[21,45,2,51],[21,46,2,52],[21,47,2,53],[22,2,3,0],[23,2,4,7],[23,8,4,13,"cleanupCache"],[23,20,4,25],[23,23,4,28],[23,36,4,42],[23,40,4,46,"Map"],[23,43,4,49],[23,44,4,50],[23,45,4,51],[24,2,5,0],[24,6,5,4,"callbackCount"],[24,19,5,17],[24,22,5,20],[24,23,5,21],[25,2,6,0],[26,0,7,0],[27,0,8,0],[28,0,9,0],[29,0,10,0],[30,2,11,7],[30,11,11,16,"observe"],[30,18,11,23,"observe"],[30,19,11,24,"observerId"],[30,29,11,34],[30,31,11,36,"callbacks"],[30,40,11,45],[30,42,11,47,"fn"],[30,44,11,49],[30,46,11,51],[31,4,12,4],[31,10,12,10,"callbackId"],[31,20,12,20],[31,23,12,23],[31,25,12,25,"callbackCount"],[31,38,12,38],[32,4,13,4],[32,10,13,10,"getListeners"],[32,22,13,22],[32,25,13,25,"getListeners"],[32,26,13,25],[32,31,13,31,"listenersCache"],[32,45,13,45],[32,46,13,46,"get"],[32,49,13,49],[32,50,13,50,"observerId"],[32,60,13,60],[32,61,13,61],[32,65,13,65],[32,67,13,67],[33,4,14,4],[33,10,14,10,"unsubscribe"],[33,21,14,21],[33,24,14,24,"unsubscribe"],[33,25,14,24],[33,30,14,30],[34,6,15,8],[34,12,15,14,"listeners"],[34,21,15,23],[34,24,15,26,"getListeners"],[34,36,15,38],[34,37,15,39],[34,38,15,40],[35,6,16,8,"listenersCache"],[35,20,16,22],[35,21,16,23,"set"],[35,24,16,26],[35,25,16,27,"observerId"],[35,35,16,37],[35,37,16,39,"listeners"],[35,46,16,48],[35,47,16,49,"filter"],[35,53,16,55],[35,54,16,57,"cb"],[35,56,16,59],[35,60,16,64,"cb"],[35,62,16,66],[35,63,16,67,"id"],[35,65,16,69],[35,70,16,74,"callbackId"],[35,80,16,84],[35,81,16,85],[35,82,16,86],[36,4,17,4],[36,5,17,5],[37,4,18,4],[37,10,18,10,"unwatch"],[37,17,18,17],[37,20,18,20,"unwatch"],[37,21,18,20],[37,26,18,26],[38,6,19,8],[38,12,19,14,"listeners"],[38,21,19,23],[38,24,19,26,"getListeners"],[38,36,19,38],[38,37,19,39],[38,38,19,40],[39,6,20,8],[39,10,20,12],[39,11,20,13,"listeners"],[39,20,20,22],[39,21,20,23,"some"],[39,25,20,27],[39,26,20,29,"cb"],[39,28,20,31],[39,32,20,36,"cb"],[39,34,20,38],[39,35,20,39,"id"],[39,37,20,41],[39,42,20,46,"callbackId"],[39,52,20,56],[39,53,20,57],[39,55,21,12],[40,6,22,8],[40,12,22,14,"cleanup"],[40,19,22,21],[40,22,22,24,"cleanupCache"],[40,34,22,36],[40,35,22,37,"get"],[40,38,22,40],[40,39,22,41,"observerId"],[40,49,22,51],[40,50,22,52],[41,6,23,8],[41,10,23,12,"listeners"],[41,19,23,21],[41,20,23,22,"length"],[41,26,23,28],[41,31,23,33],[41,32,23,34],[41,36,23,38,"cleanup"],[41,43,23,45],[41,45,24,12,"cleanup"],[41,52,24,19],[41,53,24,20],[41,54,24,21],[42,6,25,8,"unsubscribe"],[42,17,25,19],[42,18,25,20],[42,19,25,21],[43,4,26,4],[43,5,26,5],[44,4,27,4],[44,10,27,10,"listeners"],[44,19,27,19],[44,22,27,22,"getListeners"],[44,34,27,34],[44,35,27,35],[44,36,27,36],[45,4,28,4,"listenersCache"],[45,18,28,18],[45,19,28,19,"set"],[45,22,28,22],[45,23,28,23,"observerId"],[45,33,28,33],[45,35,28,35],[45,36,29,8],[45,39,29,11,"listeners"],[45,48,29,20],[45,50,30,8],[46,6,30,10,"id"],[46,8,30,12],[46,10,30,14,"callbackId"],[46,20,30,24],[47,6,30,26,"fns"],[47,9,30,29],[47,11,30,31,"callbacks"],[48,4,30,41],[48,5,30,42],[48,6,31,5],[48,7,31,6],[49,4,32,4],[49,8,32,8,"listeners"],[49,17,32,17],[49,21,32,21,"listeners"],[49,30,32,30],[49,31,32,31,"length"],[49,37,32,37],[49,40,32,40],[49,41,32,41],[49,43,33,8],[49,50,33,15,"unwatch"],[49,57,33,22],[50,4,34,4],[50,10,34,10,"emit"],[50,14,34,14],[50,17,34,17],[50,18,34,18],[50,19,34,19],[51,4,35,4],[51,9,35,9],[51,15,35,15,"key"],[51,18,35,18],[51,22,35,22,"callbacks"],[51,31,35,31],[51,33,35,33],[52,6,36,8,"emit"],[52,10,36,12],[52,11,36,13,"key"],[52,14,36,16],[52,15,36,17],[52,18,36,21],[52,19,36,22],[52,22,36,25,"args"],[52,26,36,29],[52,31,36,34],[53,8,37,12],[53,14,37,18,"listeners"],[53,23,37,27],[53,26,37,30,"getListeners"],[53,38,37,42],[53,39,37,43],[53,40,37,44],[54,8,38,12],[54,12,38,16,"listeners"],[54,21,38,25],[54,22,38,26,"length"],[54,28,38,32],[54,33,38,37],[54,34,38,38],[54,36,39,16],[55,8,40,12],[55,13,40,17],[55,19,40,23,"listener"],[55,27,40,31],[55,31,40,35,"listeners"],[55,40,40,44],[55,42,41,16,"listener"],[55,50,41,24],[55,51,41,25,"fns"],[55,54,41,28],[55,55,41,29,"key"],[55,58,41,32],[55,59,41,33],[55,62,41,36],[55,65,41,39,"args"],[55,69,41,43],[55,70,41,44],[56,6,42,8],[56,7,42,10],[57,4,43,4],[58,4,44,4],[58,10,44,10,"cleanup"],[58,17,44,17],[58,20,44,20,"fn"],[58,22,44,22],[58,23,44,23,"emit"],[58,27,44,27],[58,28,44,28],[59,4,45,4],[59,8,45,8],[59,15,45,15,"cleanup"],[59,22,45,22],[59,27,45,27],[59,37,45,37],[59,39,46,8,"cleanupCache"],[59,51,46,20],[59,52,46,21,"set"],[59,55,46,24],[59,56,46,25,"observerId"],[59,66,46,35],[59,68,46,37,"cleanup"],[59,75,46,44],[59,76,46,45],[60,4,47,4],[60,11,47,11,"unwatch"],[60,18,47,18],[61,2,48,0],[62,0,48,1],[62,3]],"functionMap":{"names":["<global>","observe","getListeners","unsubscribe","listeners.filter$argument_0","unwatch","listeners.some$argument_0","emit.key"],"mappings":"AAA;OCU;yBCE,0CD;wBEC;wDCE,4BD;KFC;oBIC;4BCE,4BD;KJM;qBMU;SNM;CDM"},"hasCjsExports":false},"type":"js/module"}]}