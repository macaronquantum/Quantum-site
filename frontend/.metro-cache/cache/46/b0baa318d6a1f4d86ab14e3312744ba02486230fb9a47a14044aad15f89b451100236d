{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  function genWrap(wraps, ref, fn, event) {\n    function wrap() {\n      const obj = ref.deref();\n      // This should alway happen, however GC is\n      // undeterministic so it might happen.\n      /* istanbul ignore else */\n      if (obj !== undefined) {\n        fn(obj, event);\n      }\n    }\n    wraps[event] = wrap;\n    process.once(event, wrap);\n  }\n  const registry = new FinalizationRegistry(clear);\n  const map = new WeakMap();\n  function clear(wraps) {\n    process.removeListener('exit', wraps.exit);\n    process.removeListener('beforeExit', wraps.beforeExit);\n  }\n  function register(obj, fn) {\n    if (obj === undefined) {\n      throw new Error('the object can\\'t be undefined');\n    }\n    const ref = new WeakRef(obj);\n    const wraps = {};\n    map.set(obj, wraps);\n    registry.register(obj, wraps);\n    genWrap(wraps, ref, fn, 'exit');\n    genWrap(wraps, ref, fn, 'beforeExit');\n  }\n  function unregister(obj) {\n    const wraps = map.get(obj);\n    map.delete(obj);\n    if (wraps) {\n      clear(wraps);\n    }\n    registry.unregister(obj);\n  }\n  module.exports = {\n    register,\n    unregister\n  };\n});","lineCount":46,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,11,3,9,"genWrap"],[4,18,3,16,"genWrap"],[4,19,3,18,"wraps"],[4,24,3,23],[4,26,3,25,"ref"],[4,29,3,28],[4,31,3,30,"fn"],[4,33,3,32],[4,35,3,34,"event"],[4,40,3,39],[4,42,3,41],[5,4,4,2],[5,13,4,11,"wrap"],[5,17,4,15,"wrap"],[5,18,4,15],[5,20,4,19],[6,6,5,4],[6,12,5,10,"obj"],[6,15,5,13],[6,18,5,16,"ref"],[6,21,5,19],[6,22,5,20,"deref"],[6,27,5,25],[6,28,5,26],[6,29,5,27],[7,6,6,4],[8,6,7,4],[9,6,8,4],[10,6,9,4],[10,10,9,8,"obj"],[10,13,9,11],[10,18,9,16,"undefined"],[10,27,9,25],[10,29,9,27],[11,8,10,6,"fn"],[11,10,10,8],[11,11,10,9,"obj"],[11,14,10,12],[11,16,10,14,"event"],[11,21,10,19],[11,22,10,20],[12,6,11,4],[13,4,12,2],[14,4,14,2,"wraps"],[14,9,14,7],[14,10,14,8,"event"],[14,15,14,13],[14,16,14,14],[14,19,14,17,"wrap"],[14,23,14,21],[15,4,15,2,"process"],[15,11,15,9],[15,12,15,10,"once"],[15,16,15,14],[15,17,15,15,"event"],[15,22,15,20],[15,24,15,22,"wrap"],[15,28,15,26],[15,29,15,27],[16,2,16,0],[17,2,18,0],[17,8,18,6,"registry"],[17,16,18,14],[17,19,18,17],[17,23,18,21,"FinalizationRegistry"],[17,43,18,41],[17,44,18,42,"clear"],[17,49,18,47],[17,50,18,48],[18,2,19,0],[18,8,19,6,"map"],[18,11,19,9],[18,14,19,12],[18,18,19,16,"WeakMap"],[18,25,19,23],[18,26,19,24],[18,27,19,25],[19,2,21,0],[19,11,21,9,"clear"],[19,16,21,14,"clear"],[19,17,21,16,"wraps"],[19,22,21,21],[19,24,21,23],[20,4,22,2,"process"],[20,11,22,9],[20,12,22,10,"removeListener"],[20,26,22,24],[20,27,22,25],[20,33,22,31],[20,35,22,33,"wraps"],[20,40,22,38],[20,41,22,39,"exit"],[20,45,22,43],[20,46,22,44],[21,4,23,2,"process"],[21,11,23,9],[21,12,23,10,"removeListener"],[21,26,23,24],[21,27,23,25],[21,39,23,37],[21,41,23,39,"wraps"],[21,46,23,44],[21,47,23,45,"beforeExit"],[21,57,23,55],[21,58,23,56],[22,2,24,0],[23,2,26,0],[23,11,26,9,"register"],[23,19,26,17,"register"],[23,20,26,19,"obj"],[23,23,26,22],[23,25,26,24,"fn"],[23,27,26,26],[23,29,26,28],[24,4,27,2],[24,8,27,6,"obj"],[24,11,27,9],[24,16,27,14,"undefined"],[24,25,27,23],[24,27,27,25],[25,6,28,4],[25,12,28,10],[25,16,28,14,"Error"],[25,21,28,19],[25,22,28,20],[25,54,28,52],[25,55,28,53],[26,4,29,2],[27,4,30,2],[27,10,30,8,"ref"],[27,13,30,11],[27,16,30,14],[27,20,30,18,"WeakRef"],[27,27,30,25],[27,28,30,26,"obj"],[27,31,30,29],[27,32,30,30],[28,4,32,2],[28,10,32,8,"wraps"],[28,15,32,13],[28,18,32,16],[28,19,32,17],[28,20,32,18],[29,4,33,2,"map"],[29,7,33,5],[29,8,33,6,"set"],[29,11,33,9],[29,12,33,10,"obj"],[29,15,33,13],[29,17,33,15,"wraps"],[29,22,33,20],[29,23,33,21],[30,4,34,2,"registry"],[30,12,34,10],[30,13,34,11,"register"],[30,21,34,19],[30,22,34,20,"obj"],[30,25,34,23],[30,27,34,25,"wraps"],[30,32,34,30],[30,33,34,31],[31,4,36,2,"genWrap"],[31,11,36,9],[31,12,36,10,"wraps"],[31,17,36,15],[31,19,36,17,"ref"],[31,22,36,20],[31,24,36,22,"fn"],[31,26,36,24],[31,28,36,26],[31,34,36,32],[31,35,36,33],[32,4,37,2,"genWrap"],[32,11,37,9],[32,12,37,10,"wraps"],[32,17,37,15],[32,19,37,17,"ref"],[32,22,37,20],[32,24,37,22,"fn"],[32,26,37,24],[32,28,37,26],[32,40,37,38],[32,41,37,39],[33,2,38,0],[34,2,40,0],[34,11,40,9,"unregister"],[34,21,40,19,"unregister"],[34,22,40,21,"obj"],[34,25,40,24],[34,27,40,26],[35,4,41,2],[35,10,41,8,"wraps"],[35,15,41,13],[35,18,41,16,"map"],[35,21,41,19],[35,22,41,20,"get"],[35,25,41,23],[35,26,41,24,"obj"],[35,29,41,27],[35,30,41,28],[36,4,42,2,"map"],[36,7,42,5],[36,8,42,6,"delete"],[36,14,42,12],[36,15,42,13,"obj"],[36,18,42,16],[36,19,42,17],[37,4,43,2],[37,8,43,6,"wraps"],[37,13,43,11],[37,15,43,13],[38,6,44,4,"clear"],[38,11,44,9],[38,12,44,10,"wraps"],[38,17,44,15],[38,18,44,16],[39,4,45,2],[40,4,46,2,"registry"],[40,12,46,10],[40,13,46,11,"unregister"],[40,23,46,21],[40,24,46,22,"obj"],[40,27,46,25],[40,28,46,26],[41,2,47,0],[42,2,49,0,"module"],[42,8,49,6],[42,9,49,7,"exports"],[42,16,49,14],[42,19,49,17],[43,4,50,2,"register"],[43,12,50,10],[44,4,51,2,"unregister"],[45,2,52,0],[45,3,52,1],[46,0,52,1],[46,3]],"functionMap":{"names":["<global>","genWrap","wrap","clear","register","unregister"],"mappings":"AAA;ACE;ECC;GDQ;CDI;AGK;CHG;AIE;CJY;AKE;CLO"},"hasCjsExports":true},"type":"js/module"}]}