{"dependencies":[{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":128,"index":128}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.parseAvatarRecord = parseAvatarRecord;\n  var _utilsJs = require(_dependencyMap[0], \"./utils.js\");\n  /*\n   * @description Parses an ENS avatar record.\n   *\n   * @example\n   * parseAvatarRecord('eip155:1/erc1155:0xb32979486938aa9694bfc898f35dbed459f44424/10063')\n   * 'https://ipfs.io/ipfs/QmSP4nq9fnN9dAiCj42ug9Wa79rqmQerZXZch82VqpiH7U/image.gif'\n   *\n   * @see https://docs.ens.domains/web/avatars\n   *\n   */\n  async function parseAvatarRecord(client, {\n    gatewayUrls,\n    record\n  }) {\n    if (/eip155:/i.test(record)) return parseNftAvatarUri(client, {\n      gatewayUrls,\n      record\n    });\n    return (0, _utilsJs.parseAvatarUri)({\n      uri: record,\n      gatewayUrls\n    });\n  }\n  async function parseNftAvatarUri(client, {\n    gatewayUrls,\n    record\n  }) {\n    // parse NFT URI into properties\n    const nft = (0, _utilsJs.parseNftUri)(record);\n    // fetch tokenURI from the NFT contract\n    const nftUri = await (0, _utilsJs.getNftTokenUri)(client, {\n      nft\n    });\n    // resolve the URI from the fetched tokenURI\n    const {\n      uri: resolvedNftUri,\n      isOnChain,\n      isEncoded\n    } = (0, _utilsJs.resolveAvatarUri)({\n      uri: nftUri,\n      gatewayUrls\n    });\n    // if the resolved URI is on chain, return the data\n    if (isOnChain && (resolvedNftUri.includes('data:application/json;base64,') || resolvedNftUri.startsWith('{'))) {\n      const encodedJson = isEncoded ?\n      // if it is encoded, decode it\n      atob(resolvedNftUri.replace('data:application/json;base64,', '')) :\n      // if it isn't encoded assume it is a JSON string, but it could be anything (it will error if it is)\n      resolvedNftUri;\n      const decoded = JSON.parse(encodedJson);\n      return (0, _utilsJs.parseAvatarUri)({\n        uri: (0, _utilsJs.getJsonImage)(decoded),\n        gatewayUrls\n      });\n    }\n    let uriTokenId = nft.tokenID;\n    if (nft.namespace === 'erc1155') uriTokenId = uriTokenId.replace('0x', '').padStart(64, '0');\n    return (0, _utilsJs.getMetadataAvatarUri)({\n      gatewayUrls,\n      uri: resolvedNftUri.replace(/(?:0x)?{id}/, uriTokenId)\n    });\n  }\n});","lineCount":71,"map":[[7,2,12,0,"exports"],[7,9,12,0],[7,10,12,0,"parseAvatarRecord"],[7,27,12,0],[7,30,12,0,"parseAvatarRecord"],[7,47,12,0],[8,2,1,0],[8,6,1,0,"_utilsJs"],[8,14,1,0],[8,17,1,0,"require"],[8,24,1,0],[8,25,1,0,"_dependencyMap"],[8,39,1,0],[9,2,2,0],[10,0,3,0],[11,0,4,0],[12,0,5,0],[13,0,6,0],[14,0,7,0],[15,0,8,0],[16,0,9,0],[17,0,10,0],[18,0,11,0],[19,2,12,7],[19,17,12,22,"parseAvatarRecord"],[19,34,12,39,"parseAvatarRecord"],[19,35,12,40,"client"],[19,41,12,46],[19,43,12,48],[20,4,12,50,"gatewayUrls"],[20,15,12,61],[21,4,12,63,"record"],[22,2,12,71],[22,3,12,72],[22,5,12,74],[23,4,13,4],[23,8,13,8],[23,18,13,18],[23,19,13,19,"test"],[23,23,13,23],[23,24,13,24,"record"],[23,30,13,30],[23,31,13,31],[23,33,14,8],[23,40,14,15,"parseNftAvatarUri"],[23,57,14,32],[23,58,14,33,"client"],[23,64,14,39],[23,66,14,41],[24,6,14,43,"gatewayUrls"],[24,17,14,54],[25,6,14,56,"record"],[26,4,14,63],[26,5,14,64],[26,6,14,65],[27,4,15,4],[27,11,15,11],[27,15,15,11,"parseAvatarUri"],[27,23,15,25],[27,24,15,25,"parseAvatarUri"],[27,38,15,25],[27,40,15,26],[28,6,15,28,"uri"],[28,9,15,31],[28,11,15,33,"record"],[28,17,15,39],[29,6,15,41,"gatewayUrls"],[30,4,15,53],[30,5,15,54],[30,6,15,55],[31,2,16,0],[32,2,17,0],[32,17,17,15,"parseNftAvatarUri"],[32,34,17,32,"parseNftAvatarUri"],[32,35,17,33,"client"],[32,41,17,39],[32,43,17,41],[33,4,17,43,"gatewayUrls"],[33,15,17,54],[34,4,17,56,"record"],[35,2,17,64],[35,3,17,65],[35,5,17,67],[36,4,18,4],[37,4,19,4],[37,10,19,10,"nft"],[37,13,19,13],[37,16,19,16],[37,20,19,16,"parseNftUri"],[37,28,19,27],[37,29,19,27,"parseNftUri"],[37,40,19,27],[37,42,19,28,"record"],[37,48,19,34],[37,49,19,35],[38,4,20,4],[39,4,21,4],[39,10,21,10,"nftUri"],[39,16,21,16],[39,19,21,19],[39,25,21,25],[39,29,21,25,"getNftTokenUri"],[39,37,21,39],[39,38,21,39,"getNftTokenUri"],[39,52,21,39],[39,54,21,40,"client"],[39,60,21,46],[39,62,21,48],[40,6,21,50,"nft"],[41,4,21,54],[41,5,21,55],[41,6,21,56],[42,4,22,4],[43,4,23,4],[43,10,23,10],[44,6,23,12,"uri"],[44,9,23,15],[44,11,23,17,"resolvedNftUri"],[44,25,23,31],[45,6,23,33,"isOnChain"],[45,15,23,42],[46,6,23,44,"isEncoded"],[47,4,23,55],[47,5,23,56],[47,8,23,59],[47,12,23,59,"resolveAvatarUri"],[47,20,23,75],[47,21,23,75,"resolveAvatarUri"],[47,37,23,75],[47,39,23,76],[48,6,23,78,"uri"],[48,9,23,81],[48,11,23,83,"nftUri"],[48,17,23,89],[49,6,23,91,"gatewayUrls"],[50,4,23,103],[50,5,23,104],[50,6,23,105],[51,4,24,4],[52,4,25,4],[52,8,25,8,"isOnChain"],[52,17,25,17],[52,22,26,9,"resolvedNftUri"],[52,36,26,23],[52,37,26,24,"includes"],[52,45,26,32],[52,46,26,33],[52,77,26,64],[52,78,26,65],[52,82,27,12,"resolvedNftUri"],[52,96,27,26],[52,97,27,27,"startsWith"],[52,107,27,37],[52,108,27,38],[52,111,27,41],[52,112,27,42],[52,113,27,43],[52,115,27,45],[53,6,28,8],[53,12,28,14,"encodedJson"],[53,23,28,25],[53,26,28,28,"isEncoded"],[53,35,28,37],[54,6,29,14],[55,6,30,16,"atob"],[55,10,30,20],[55,11,30,21,"resolvedNftUri"],[55,25,30,35],[55,26,30,36,"replace"],[55,33,30,43],[55,34,30,44],[55,65,30,75],[55,67,30,77],[55,69,30,79],[55,70,30,80],[55,71,30,81],[56,6,31,14],[57,6,32,16,"resolvedNftUri"],[57,20,32,30],[58,6,33,8],[58,12,33,14,"decoded"],[58,19,33,21],[58,22,33,24,"JSON"],[58,26,33,28],[58,27,33,29,"parse"],[58,32,33,34],[58,33,33,35,"encodedJson"],[58,44,33,46],[58,45,33,47],[59,6,34,8],[59,13,34,15],[59,17,34,15,"parseAvatarUri"],[59,25,34,29],[59,26,34,29,"parseAvatarUri"],[59,40,34,29],[59,42,34,30],[60,8,34,32,"uri"],[60,11,34,35],[60,13,34,37],[60,17,34,37,"getJsonImage"],[60,25,34,49],[60,26,34,49,"getJsonImage"],[60,38,34,49],[60,40,34,50,"decoded"],[60,47,34,57],[60,48,34,58],[61,8,34,60,"gatewayUrls"],[62,6,34,72],[62,7,34,73],[62,8,34,74],[63,4,35,4],[64,4,36,4],[64,8,36,8,"uriTokenId"],[64,18,36,18],[64,21,36,21,"nft"],[64,24,36,24],[64,25,36,25,"tokenID"],[64,32,36,32],[65,4,37,4],[65,8,37,8,"nft"],[65,11,37,11],[65,12,37,12,"namespace"],[65,21,37,21],[65,26,37,26],[65,35,37,35],[65,37,38,8,"uriTokenId"],[65,47,38,18],[65,50,38,21,"uriTokenId"],[65,60,38,31],[65,61,38,32,"replace"],[65,68,38,39],[65,69,38,40],[65,73,38,44],[65,75,38,46],[65,77,38,48],[65,78,38,49],[65,79,38,50,"padStart"],[65,87,38,58],[65,88,38,59],[65,90,38,61],[65,92,38,63],[65,95,38,66],[65,96,38,67],[66,4,39,4],[66,11,39,11],[66,15,39,11,"getMetadataAvatarUri"],[66,23,39,31],[66,24,39,31,"getMetadataAvatarUri"],[66,44,39,31],[66,46,39,32],[67,6,40,8,"gatewayUrls"],[67,17,40,19],[68,6,41,8,"uri"],[68,9,41,11],[68,11,41,13,"resolvedNftUri"],[68,25,41,27],[68,26,41,28,"replace"],[68,33,41,35],[68,34,41,36],[68,47,41,49],[68,49,41,51,"uriTokenId"],[68,59,41,61],[69,4,42,4],[69,5,42,5],[69,6,42,6],[70,2,43,0],[71,0,43,1],[71,3]],"functionMap":{"names":["<global>","parseAvatarRecord","parseNftAvatarUri"],"mappings":"AAA;OCW;CDI;AEC;CF0B"},"hasCjsExports":false},"type":"js/module"}]}