{"dependencies":[{"name":"./wait.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":18,"index":116},"end":{"line":4,"column":38,"index":136}}],"key":"lTd7daSLOD/ecbgI6mmlzFr4/T0=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.poll = poll;\n  const wait_js_1 = require(_dependencyMap[0], \"./wait.js\");\n  function poll(fn, {\n    emitOnBegin,\n    initialWaitTime,\n    interval\n  }) {\n    let active = true;\n    const unwatch = () => active = false;\n    const watch = async () => {\n      let data = undefined;\n      if (emitOnBegin) data = await fn({\n        unpoll: unwatch\n      });\n      const initialWait = (await initialWaitTime?.(data)) ?? interval;\n      await (0, wait_js_1.wait)(initialWait);\n      const poll = async () => {\n        if (!active) return;\n        await fn({\n          unpoll: unwatch\n        });\n        await (0, wait_js_1.wait)(interval);\n        poll();\n      };\n      poll();\n    };\n    watch();\n    return unwatch;\n  }\n});","lineCount":36,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"poll"],[7,14,3,12],[7,17,3,15,"poll"],[7,21,3,19],[8,2,4,0],[8,8,4,6,"wait_js_1"],[8,17,4,15],[8,20,4,18,"require"],[8,27,4,25],[8,28,4,25,"_dependencyMap"],[8,42,4,25],[8,58,4,37],[8,59,4,38],[9,2,5,0],[9,11,5,9,"poll"],[9,15,5,13,"poll"],[9,16,5,14,"fn"],[9,18,5,16],[9,20,5,18],[10,4,5,20,"emitOnBegin"],[10,15,5,31],[11,4,5,33,"initialWaitTime"],[11,19,5,48],[12,4,5,50,"interval"],[13,2,5,59],[13,3,5,60],[13,5,5,62],[14,4,6,4],[14,8,6,8,"active"],[14,14,6,14],[14,17,6,17],[14,21,6,21],[15,4,7,4],[15,10,7,10,"unwatch"],[15,17,7,17],[15,20,7,20,"unwatch"],[15,21,7,20],[15,26,7,27,"active"],[15,32,7,33],[15,35,7,36],[15,40,7,42],[16,4,8,4],[16,10,8,10,"watch"],[16,15,8,15],[16,18,8,18],[16,24,8,18,"watch"],[16,25,8,18],[16,30,8,30],[17,6,9,8],[17,10,9,12,"data"],[17,14,9,16],[17,17,9,19,"undefined"],[17,26,9,28],[18,6,10,8],[18,10,10,12,"emitOnBegin"],[18,21,10,23],[18,23,11,12,"data"],[18,27,11,16],[18,30,11,19],[18,36,11,25,"fn"],[18,38,11,27],[18,39,11,28],[19,8,11,30,"unpoll"],[19,14,11,36],[19,16,11,38,"unwatch"],[20,6,11,46],[20,7,11,47],[20,8,11,48],[21,6,12,8],[21,12,12,14,"initialWait"],[21,23,12,25],[21,26,12,28],[21,27,12,29],[21,33,12,35,"initialWaitTime"],[21,48,12,50],[21,51,12,53,"data"],[21,55,12,57],[21,56,12,58],[21,61,12,63,"interval"],[21,69,12,71],[22,6,13,8],[22,12,13,14],[22,13,13,15],[22,14,13,16],[22,16,13,18,"wait_js_1"],[22,25,13,27],[22,26,13,28,"wait"],[22,30,13,32],[22,32,13,34,"initialWait"],[22,43,13,45],[22,44,13,46],[23,6,14,8],[23,12,14,14,"poll"],[23,16,14,18],[23,19,14,21],[23,25,14,21,"poll"],[23,26,14,21],[23,31,14,33],[24,8,15,12],[24,12,15,16],[24,13,15,17,"active"],[24,19,15,23],[24,21,16,16],[25,8,17,12],[25,14,17,18,"fn"],[25,16,17,20],[25,17,17,21],[26,10,17,23,"unpoll"],[26,16,17,29],[26,18,17,31,"unwatch"],[27,8,17,39],[27,9,17,40],[27,10,17,41],[28,8,18,12],[28,14,18,18],[28,15,18,19],[28,16,18,20],[28,18,18,22,"wait_js_1"],[28,27,18,31],[28,28,18,32,"wait"],[28,32,18,36],[28,34,18,38,"interval"],[28,42,18,46],[28,43,18,47],[29,8,19,12,"poll"],[29,12,19,16],[29,13,19,17],[29,14,19,18],[30,6,20,8],[30,7,20,9],[31,6,21,8,"poll"],[31,10,21,12],[31,11,21,13],[31,12,21,14],[32,4,22,4],[32,5,22,5],[33,4,23,4,"watch"],[33,9,23,9],[33,10,23,10],[33,11,23,11],[34,4,24,4],[34,11,24,11,"unwatch"],[34,18,24,18],[35,2,25,0],[36,0,25,1],[36,3]],"functionMap":{"names":["<global>","poll","unwatch","watch"],"mappings":"AAA;ACI;oBCE,sBD;kBEC;qBFM;SEM;KFE;CDG"},"hasCjsExports":true},"type":"js/module"}]}