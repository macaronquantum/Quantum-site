{"dependencies":[{"name":"../controllers/AccountController.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":72,"index":72}}],"key":"raxu2hnZ9hCXAXGKKedCSNk4kOw=","exportNames":["*"],"imports":1}},{"name":"../controllers/BlockchainApiController.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":73},"end":{"line":2,"column":84,"index":157}}],"key":"a0Gyip/3MT7Ik3+5DFMfpYkDURk=","exportNames":["*"],"imports":1}},{"name":"../controllers/ChainController.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":158},"end":{"line":3,"column":68,"index":226}}],"key":"/k9dnUgYQKzJovjmtDttxLYEwvk=","exportNames":["*"],"imports":1}},{"name":"../controllers/ConnectionController.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":227},"end":{"line":4,"column":78,"index":305}}],"key":"+QMPexp8lWQCy637Jx32pHeJqYY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"SwapApiUtil\", {\n    enumerable: true,\n    get: function () {\n      return SwapApiUtil;\n    }\n  });\n  var _controllersAccountControllerJs = require(_dependencyMap[0], \"../controllers/AccountController.js\");\n  var _controllersBlockchainApiControllerJs = require(_dependencyMap[1], \"../controllers/BlockchainApiController.js\");\n  var _controllersChainControllerJs = require(_dependencyMap[2], \"../controllers/ChainController.js\");\n  var _controllersConnectionControllerJs = require(_dependencyMap[3], \"../controllers/ConnectionController.js\");\n  // -- Controller ---------------------------------------- //\n  const SwapApiUtil = {\n    async getTokenList() {\n      const caipNetwork = _controllersChainControllerJs.ChainController.state.activeCaipNetwork;\n      const response = await _controllersBlockchainApiControllerJs.BlockchainApiController.fetchSwapTokens({\n        chainId: caipNetwork?.caipNetworkId\n      });\n      const tokens = response?.tokens?.map(token => ({\n        ...token,\n        eip2612: false,\n        quantity: {\n          decimals: '0',\n          numeric: '0'\n        },\n        price: 0,\n        value: 0\n      })) || [];\n      return tokens;\n    },\n    async fetchGasPrice() {\n      const caipNetwork = _controllersChainControllerJs.ChainController.state.activeCaipNetwork;\n      if (!caipNetwork) {\n        return null;\n      }\n      try {\n        switch (caipNetwork.chainNamespace) {\n          case 'solana':\n            // eslint-disable-next-line no-case-declarations\n            const lamportsPerSignature = (await _controllersConnectionControllerJs.ConnectionController?.estimateGas({\n              chainNamespace: 'solana'\n            }))?.toString();\n            return {\n              standard: lamportsPerSignature,\n              fast: lamportsPerSignature,\n              instant: lamportsPerSignature\n            };\n          case 'eip155':\n          default:\n            return await _controllersBlockchainApiControllerJs.BlockchainApiController.fetchGasPrice({\n              chainId: caipNetwork.caipNetworkId\n            });\n        }\n      } catch {\n        return null;\n      }\n    },\n    async fetchSwapAllowance({\n      tokenAddress,\n      userAddress,\n      sourceTokenAmount,\n      sourceTokenDecimals\n    }) {\n      const response = await _controllersBlockchainApiControllerJs.BlockchainApiController.fetchSwapAllowance({\n        tokenAddress,\n        userAddress\n      });\n      if (response?.allowance && sourceTokenAmount && sourceTokenDecimals) {\n        const parsedValue = _controllersConnectionControllerJs.ConnectionController.parseUnits(sourceTokenAmount, sourceTokenDecimals) || 0;\n        const hasAllowance = BigInt(response.allowance) >= parsedValue;\n        return hasAllowance;\n      }\n      return false;\n    },\n    async getMyTokensWithBalance(forceUpdate) {\n      const address = _controllersAccountControllerJs.AccountController.state.address;\n      const caipNetwork = _controllersChainControllerJs.ChainController.state.activeCaipNetwork;\n      if (!address || !caipNetwork) {\n        return [];\n      }\n      const response = await _controllersBlockchainApiControllerJs.BlockchainApiController.getBalance(address, caipNetwork.caipNetworkId, forceUpdate);\n      /*\n       * The 1Inch API includes many low-quality tokens in the balance response,\n       * which appear inconsistently. This filter prevents them from being displayed.\n       */\n      const balances = response.balances.filter(balance => balance.quantity.decimals !== '0');\n      _controllersAccountControllerJs.AccountController.setTokenBalance(balances, _controllersChainControllerJs.ChainController.state.activeChain);\n      return this.mapBalancesToSwapTokens(balances);\n    },\n    mapBalancesToSwapTokens(balances) {\n      return balances?.map(token => ({\n        ...token,\n        address: token?.address ? token.address : _controllersChainControllerJs.ChainController.getActiveNetworkTokenAddress(),\n        decimals: parseInt(token.quantity.decimals, 10),\n        logoUri: token.iconUrl,\n        eip2612: false\n      })) || [];\n    }\n  };\n});","lineCount":105,"map":[[7,2,6,0,"Object"],[7,8,6,0],[7,9,6,0,"defineProperty"],[7,23,6,0],[7,24,6,0,"exports"],[7,31,6,0],[8,4,6,0,"enumerable"],[8,14,6,0],[9,4,6,0,"get"],[9,7,6,0],[9,18,6,0,"get"],[9,19,6,0],[10,6,6,0],[10,13,6,0,"SwapApiUtil"],[10,24,6,0],[11,4,6,0],[12,2,6,0],[13,2,1,0],[13,6,1,0,"_controllersAccountControllerJs"],[13,37,1,0],[13,40,1,0,"require"],[13,47,1,0],[13,48,1,0,"_dependencyMap"],[13,62,1,0],[14,2,2,0],[14,6,2,0,"_controllersBlockchainApiControllerJs"],[14,43,2,0],[14,46,2,0,"require"],[14,53,2,0],[14,54,2,0,"_dependencyMap"],[14,68,2,0],[15,2,3,0],[15,6,3,0,"_controllersChainControllerJs"],[15,35,3,0],[15,38,3,0,"require"],[15,45,3,0],[15,46,3,0,"_dependencyMap"],[15,60,3,0],[16,2,4,0],[16,6,4,0,"_controllersConnectionControllerJs"],[16,40,4,0],[16,43,4,0,"require"],[16,50,4,0],[16,51,4,0,"_dependencyMap"],[16,65,4,0],[17,2,5,0],[18,2,6,7],[18,8,6,13,"SwapApiUtil"],[18,19,6,24],[18,22,6,27],[19,4,7,4],[19,10,7,10,"getTokenList"],[19,22,7,22,"getTokenList"],[19,23,7,22],[19,25,7,25],[20,6,8,8],[20,12,8,14,"caipNetwork"],[20,23,8,25],[20,26,8,28,"ChainController"],[20,55,8,43],[20,56,8,43,"ChainController"],[20,71,8,43],[20,72,8,44,"state"],[20,77,8,49],[20,78,8,50,"activeCaipNetwork"],[20,95,8,67],[21,6,9,8],[21,12,9,14,"response"],[21,20,9,22],[21,23,9,25],[21,29,9,31,"BlockchainApiController"],[21,66,9,54],[21,67,9,54,"BlockchainApiController"],[21,90,9,54],[21,91,9,55,"fetchSwapTokens"],[21,106,9,70],[21,107,9,71],[22,8,10,12,"chainId"],[22,15,10,19],[22,17,10,21,"caipNetwork"],[22,28,10,32],[22,30,10,34,"caipNetworkId"],[23,6,11,8],[23,7,11,9],[23,8,11,10],[24,6,12,8],[24,12,12,14,"tokens"],[24,18,12,20],[24,21,12,23,"response"],[24,29,12,31],[24,31,12,33,"tokens"],[24,37,12,39],[24,39,12,41,"map"],[24,42,12,44],[24,43,12,45,"token"],[24,48,12,50],[24,53,12,55],[25,8,13,12],[25,11,13,15,"token"],[25,16,13,20],[26,8,14,12,"eip2612"],[26,15,14,19],[26,17,14,21],[26,22,14,26],[27,8,15,12,"quantity"],[27,16,15,20],[27,18,15,22],[28,10,16,16,"decimals"],[28,18,16,24],[28,20,16,26],[28,23,16,29],[29,10,17,16,"numeric"],[29,17,17,23],[29,19,17,25],[30,8,18,12],[30,9,18,13],[31,8,19,12,"price"],[31,13,19,17],[31,15,19,19],[31,16,19,20],[32,8,20,12,"value"],[32,13,20,17],[32,15,20,19],[33,6,21,8],[33,7,21,9],[33,8,21,10],[33,9,21,11],[33,13,21,15],[33,15,21,17],[34,6,22,8],[34,13,22,15,"tokens"],[34,19,22,21],[35,4,23,4],[35,5,23,5],[36,4,24,4],[36,10,24,10,"fetchGasPrice"],[36,23,24,23,"fetchGasPrice"],[36,24,24,23],[36,26,24,26],[37,6,25,8],[37,12,25,14,"caipNetwork"],[37,23,25,25],[37,26,25,28,"ChainController"],[37,55,25,43],[37,56,25,43,"ChainController"],[37,71,25,43],[37,72,25,44,"state"],[37,77,25,49],[37,78,25,50,"activeCaipNetwork"],[37,95,25,67],[38,6,26,8],[38,10,26,12],[38,11,26,13,"caipNetwork"],[38,22,26,24],[38,24,26,26],[39,8,27,12],[39,15,27,19],[39,19,27,23],[40,6,28,8],[41,6,29,8],[41,10,29,12],[42,8,30,12],[42,16,30,20,"caipNetwork"],[42,27,30,31],[42,28,30,32,"chainNamespace"],[42,42,30,46],[43,10,31,16],[43,15,31,21],[43,23,31,29],[44,12,32,20],[45,12,33,20],[45,18,33,26,"lamportsPerSignature"],[45,38,33,46],[45,41,33,49],[45,42,33,50],[45,48,33,56,"ConnectionController"],[45,82,33,76],[45,83,33,76,"ConnectionController"],[45,103,33,76],[45,105,33,78,"estimateGas"],[45,116,33,89],[45,117,33,90],[46,14,33,92,"chainNamespace"],[46,28,33,106],[46,30,33,108],[47,12,33,117],[47,13,33,118],[47,14,33,119],[47,17,33,122,"toString"],[47,25,33,130],[47,26,33,131],[47,27,33,132],[48,12,34,20],[48,19,34,27],[49,14,35,24,"standard"],[49,22,35,32],[49,24,35,34,"lamportsPerSignature"],[49,44,35,54],[50,14,36,24,"fast"],[50,18,36,28],[50,20,36,30,"lamportsPerSignature"],[50,40,36,50],[51,14,37,24,"instant"],[51,21,37,31],[51,23,37,33,"lamportsPerSignature"],[52,12,38,20],[52,13,38,21],[53,10,39,16],[53,15,39,21],[53,23,39,29],[54,10,40,16],[55,12,41,20],[55,19,41,27],[55,25,41,33,"BlockchainApiController"],[55,62,41,56],[55,63,41,56,"BlockchainApiController"],[55,86,41,56],[55,87,41,57,"fetchGasPrice"],[55,100,41,70],[55,101,41,71],[56,14,42,24,"chainId"],[56,21,42,31],[56,23,42,33,"caipNetwork"],[56,34,42,44],[56,35,42,45,"caipNetworkId"],[57,12,43,20],[57,13,43,21],[57,14,43,22],[58,8,44,12],[59,6,45,8],[59,7,45,9],[59,8,46,8],[59,14,46,14],[60,8,47,12],[60,15,47,19],[60,19,47,23],[61,6,48,8],[62,4,49,4],[62,5,49,5],[63,4,50,4],[63,10,50,10,"fetchSwapAllowance"],[63,28,50,28,"fetchSwapAllowance"],[63,29,50,29],[64,6,50,31,"tokenAddress"],[64,18,50,43],[65,6,50,45,"userAddress"],[65,17,50,56],[66,6,50,58,"sourceTokenAmount"],[66,23,50,75],[67,6,50,77,"sourceTokenDecimals"],[68,4,50,97],[68,5,50,98],[68,7,50,100],[69,6,51,8],[69,12,51,14,"response"],[69,20,51,22],[69,23,51,25],[69,29,51,31,"BlockchainApiController"],[69,66,51,54],[69,67,51,54,"BlockchainApiController"],[69,90,51,54],[69,91,51,55,"fetchSwapAllowance"],[69,109,51,73],[69,110,51,74],[70,8,52,12,"tokenAddress"],[70,20,52,24],[71,8,53,12,"userAddress"],[72,6,54,8],[72,7,54,9],[72,8,54,10],[73,6,55,8],[73,10,55,12,"response"],[73,18,55,20],[73,20,55,22,"allowance"],[73,29,55,31],[73,33,55,35,"sourceTokenAmount"],[73,50,55,52],[73,54,55,56,"sourceTokenDecimals"],[73,73,55,75],[73,75,55,77],[74,8,56,12],[74,14,56,18,"parsedValue"],[74,25,56,29],[74,28,56,32,"ConnectionController"],[74,62,56,52],[74,63,56,52,"ConnectionController"],[74,83,56,52],[74,84,56,53,"parseUnits"],[74,94,56,63],[74,95,56,64,"sourceTokenAmount"],[74,112,56,81],[74,114,56,83,"sourceTokenDecimals"],[74,133,56,102],[74,134,56,103],[74,138,56,107],[74,139,56,108],[75,8,57,12],[75,14,57,18,"hasAllowance"],[75,26,57,30],[75,29,57,33,"BigInt"],[75,35,57,39],[75,36,57,40,"response"],[75,44,57,48],[75,45,57,49,"allowance"],[75,54,57,58],[75,55,57,59],[75,59,57,63,"parsedValue"],[75,70,57,74],[76,8,58,12],[76,15,58,19,"hasAllowance"],[76,27,58,31],[77,6,59,8],[78,6,60,8],[78,13,60,15],[78,18,60,20],[79,4,61,4],[79,5,61,5],[80,4,62,4],[80,10,62,10,"getMyTokensWithBalance"],[80,32,62,32,"getMyTokensWithBalance"],[80,33,62,33,"forceUpdate"],[80,44,62,44],[80,46,62,46],[81,6,63,8],[81,12,63,14,"address"],[81,19,63,21],[81,22,63,24,"AccountController"],[81,53,63,41],[81,54,63,41,"AccountController"],[81,71,63,41],[81,72,63,42,"state"],[81,77,63,47],[81,78,63,48,"address"],[81,85,63,55],[82,6,64,8],[82,12,64,14,"caipNetwork"],[82,23,64,25],[82,26,64,28,"ChainController"],[82,55,64,43],[82,56,64,43,"ChainController"],[82,71,64,43],[82,72,64,44,"state"],[82,77,64,49],[82,78,64,50,"activeCaipNetwork"],[82,95,64,67],[83,6,65,8],[83,10,65,12],[83,11,65,13,"address"],[83,18,65,20],[83,22,65,24],[83,23,65,25,"caipNetwork"],[83,34,65,36],[83,36,65,38],[84,8,66,12],[84,15,66,19],[84,17,66,21],[85,6,67,8],[86,6,68,8],[86,12,68,14,"response"],[86,20,68,22],[86,23,68,25],[86,29,68,31,"BlockchainApiController"],[86,66,68,54],[86,67,68,54,"BlockchainApiController"],[86,90,68,54],[86,91,68,55,"getBalance"],[86,101,68,65],[86,102,68,66,"address"],[86,109,68,73],[86,111,68,75,"caipNetwork"],[86,122,68,86],[86,123,68,87,"caipNetworkId"],[86,136,68,100],[86,138,68,102,"forceUpdate"],[86,149,68,113],[86,150,68,114],[87,6,69,8],[88,0,70,0],[89,0,71,0],[90,0,72,0],[91,6,73,8],[91,12,73,14,"balances"],[91,20,73,22],[91,23,73,25,"response"],[91,31,73,33],[91,32,73,34,"balances"],[91,40,73,42],[91,41,73,43,"filter"],[91,47,73,49],[91,48,73,50,"balance"],[91,55,73,57],[91,59,73,61,"balance"],[91,66,73,68],[91,67,73,69,"quantity"],[91,75,73,77],[91,76,73,78,"decimals"],[91,84,73,86],[91,89,73,91],[91,92,73,94],[91,93,73,95],[92,6,74,8,"AccountController"],[92,37,74,25],[92,38,74,25,"AccountController"],[92,55,74,25],[92,56,74,26,"setTokenBalance"],[92,71,74,41],[92,72,74,42,"balances"],[92,80,74,50],[92,82,74,52,"ChainController"],[92,111,74,67],[92,112,74,67,"ChainController"],[92,127,74,67],[92,128,74,68,"state"],[92,133,74,73],[92,134,74,74,"activeChain"],[92,145,74,85],[92,146,74,86],[93,6,75,8],[93,13,75,15],[93,17,75,19],[93,18,75,20,"mapBalancesToSwapTokens"],[93,41,75,43],[93,42,75,44,"balances"],[93,50,75,52],[93,51,75,53],[94,4,76,4],[94,5,76,5],[95,4,77,4,"mapBalancesToSwapTokens"],[95,27,77,27,"mapBalancesToSwapTokens"],[95,28,77,28,"balances"],[95,36,77,36],[95,38,77,38],[96,6,78,8],[96,13,78,16,"balances"],[96,21,78,24],[96,23,78,26,"map"],[96,26,78,29],[96,27,78,30,"token"],[96,32,78,35],[96,37,78,40],[97,8,79,12],[97,11,79,15,"token"],[97,16,79,20],[98,8,80,12,"address"],[98,15,80,19],[98,17,80,21,"token"],[98,22,80,26],[98,24,80,28,"address"],[98,31,80,35],[98,34,81,18,"token"],[98,39,81,23],[98,40,81,24,"address"],[98,47,81,31],[98,50,82,18,"ChainController"],[98,79,82,33],[98,80,82,33,"ChainController"],[98,95,82,33],[98,96,82,34,"getActiveNetworkTokenAddress"],[98,124,82,62],[98,125,82,63],[98,126,82,64],[99,8,83,12,"decimals"],[99,16,83,20],[99,18,83,22,"parseInt"],[99,26,83,30],[99,27,83,31,"token"],[99,32,83,36],[99,33,83,37,"quantity"],[99,41,83,45],[99,42,83,46,"decimals"],[99,50,83,54],[99,52,83,56],[99,54,83,58],[99,55,83,59],[100,8,84,12,"logoUri"],[100,15,84,19],[100,17,84,21,"token"],[100,22,84,26],[100,23,84,27,"iconUrl"],[100,30,84,34],[101,8,85,12,"eip2612"],[101,15,85,19],[101,17,85,21],[102,6,86,8],[102,7,86,9],[102,8,86,10],[102,9,86,11],[102,13,86,15],[102,15,86,17],[103,4,87,4],[104,2,88,0],[104,3,88,1],[105,0,88,2],[105,3]],"functionMap":{"names":["<global>","getTokenList","response.tokens.map$argument_0","fetchGasPrice","fetchSwapAllowance","getMyTokensWithBalance","response.balances.filter$argument_0","mapBalancesToSwapTokens","balances.map$argument_0"],"mappings":"AAA;ICM;6CCK;UDS;KDE;IGC;KHyB;IIC;KJW;IKC;kDCW,4CD;KLG;IOC;8BCC;UDQ;KPC"},"hasCjsExports":false},"type":"js/module"}]}