{"dependencies":[{"name":"../address/isAddressEqual.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":62,"index":62}}],"key":"g7Heh1CcuKgiDNOJYMlZD8SYUXg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.validateSiweMessage = validateSiweMessage;\n  var _addressIsAddressEqualJs = require(_dependencyMap[0], \"../address/isAddressEqual.js\");\n  /**\n   * @description Validates EIP-4361 message.\n   *\n   * @see https://eips.ethereum.org/EIPS/eip-4361\n   */\n  function validateSiweMessage(parameters) {\n    const {\n      address,\n      domain,\n      message,\n      nonce,\n      scheme,\n      time = new Date()\n    } = parameters;\n    if (domain && message.domain !== domain) return false;\n    if (nonce && message.nonce !== nonce) return false;\n    if (scheme && message.scheme !== scheme) return false;\n    if (message.expirationTime && time >= message.expirationTime) return false;\n    if (message.notBefore && time < message.notBefore) return false;\n    try {\n      if (!message.address) return false;\n      if (address && !(0, _addressIsAddressEqualJs.isAddressEqual)(message.address, address)) return false;\n    } catch {\n      return false;\n    }\n    return true;\n  }\n});","lineCount":36,"map":[[7,2,7,0,"exports"],[7,9,7,0],[7,10,7,0,"validateSiweMessage"],[7,29,7,0],[7,32,7,0,"validateSiweMessage"],[7,51,7,0],[8,2,1,0],[8,6,1,0,"_addressIsAddressEqualJs"],[8,30,1,0],[8,33,1,0,"require"],[8,40,1,0],[8,41,1,0,"_dependencyMap"],[8,55,1,0],[9,2,2,0],[10,0,3,0],[11,0,4,0],[12,0,5,0],[13,0,6,0],[14,2,7,7],[14,11,7,16,"validateSiweMessage"],[14,30,7,35,"validateSiweMessage"],[14,31,7,36,"parameters"],[14,41,7,46],[14,43,7,48],[15,4,8,4],[15,10,8,10],[16,6,8,12,"address"],[16,13,8,19],[17,6,8,21,"domain"],[17,12,8,27],[18,6,8,29,"message"],[18,13,8,36],[19,6,8,38,"nonce"],[19,11,8,43],[20,6,8,45,"scheme"],[20,12,8,51],[21,6,8,53,"time"],[21,10,8,57],[21,13,8,60],[21,17,8,64,"Date"],[21,21,8,68],[21,22,8,69],[22,4,8,72],[22,5,8,73],[22,8,8,76,"parameters"],[22,18,8,86],[23,4,9,4],[23,8,9,8,"domain"],[23,14,9,14],[23,18,9,18,"message"],[23,25,9,25],[23,26,9,26,"domain"],[23,32,9,32],[23,37,9,37,"domain"],[23,43,9,43],[23,45,10,8],[23,52,10,15],[23,57,10,20],[24,4,11,4],[24,8,11,8,"nonce"],[24,13,11,13],[24,17,11,17,"message"],[24,24,11,24],[24,25,11,25,"nonce"],[24,30,11,30],[24,35,11,35,"nonce"],[24,40,11,40],[24,42,12,8],[24,49,12,15],[24,54,12,20],[25,4,13,4],[25,8,13,8,"scheme"],[25,14,13,14],[25,18,13,18,"message"],[25,25,13,25],[25,26,13,26,"scheme"],[25,32,13,32],[25,37,13,37,"scheme"],[25,43,13,43],[25,45,14,8],[25,52,14,15],[25,57,14,20],[26,4,15,4],[26,8,15,8,"message"],[26,15,15,15],[26,16,15,16,"expirationTime"],[26,30,15,30],[26,34,15,34,"time"],[26,38,15,38],[26,42,15,42,"message"],[26,49,15,49],[26,50,15,50,"expirationTime"],[26,64,15,64],[26,66,16,8],[26,73,16,15],[26,78,16,20],[27,4,17,4],[27,8,17,8,"message"],[27,15,17,15],[27,16,17,16,"notBefore"],[27,25,17,25],[27,29,17,29,"time"],[27,33,17,33],[27,36,17,36,"message"],[27,43,17,43],[27,44,17,44,"notBefore"],[27,53,17,53],[27,55,18,8],[27,62,18,15],[27,67,18,20],[28,4,19,4],[28,8,19,8],[29,6,20,8],[29,10,20,12],[29,11,20,13,"message"],[29,18,20,20],[29,19,20,21,"address"],[29,26,20,28],[29,28,21,12],[29,35,21,19],[29,40,21,24],[30,6,22,8],[30,10,22,12,"address"],[30,17,22,19],[30,21,22,23],[30,22,22,24],[30,26,22,24,"isAddressEqual"],[30,50,22,38],[30,51,22,38,"isAddressEqual"],[30,65,22,38],[30,67,22,39,"message"],[30,74,22,46],[30,75,22,47,"address"],[30,82,22,54],[30,84,22,56,"address"],[30,91,22,63],[30,92,22,64],[30,94,23,12],[30,101,23,19],[30,106,23,24],[31,4,24,4],[31,5,24,5],[31,6,25,4],[31,12,25,10],[32,6,26,8],[32,13,26,15],[32,18,26,20],[33,4,27,4],[34,4,28,4],[34,11,28,11],[34,15,28,15],[35,2,29,0],[36,0,29,1],[36,3]],"functionMap":{"names":["<global>","validateSiweMessage"],"mappings":"AAA;OCM;CDsB"},"hasCjsExports":false},"type":"js/module"}]}