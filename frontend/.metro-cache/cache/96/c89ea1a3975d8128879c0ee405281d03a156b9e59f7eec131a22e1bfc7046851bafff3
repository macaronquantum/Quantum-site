{"dependencies":[{"name":"../../errors/base.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"RZV6q4Ia6g2SthmhXKbx9xro+lE=","exportNames":["*"],"imports":1}},{"name":"../../errors/calls.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":58,"index":108}}],"key":"PaGj+thsdW1L8UxKNYoqW66LaWQ=","exportNames":["*"],"imports":1}},{"name":"../../utils/getAction.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":109},"end":{"line":3,"column":53,"index":162}}],"key":"vt4scbNyA2t/tyY0oQJI6AZPJS4=","exportNames":["*"],"imports":1}},{"name":"../../utils/observe.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":163},"end":{"line":4,"column":49,"index":212}}],"key":"HKjcCKJVuiHtohOTQ78FBQFk94I=","exportNames":["*"],"imports":1}},{"name":"../../utils/poll.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":213},"end":{"line":5,"column":43,"index":256}}],"key":"Vy9/0HY5f9EZBKje2fl3cZrd9b0=","exportNames":["*"],"imports":1}},{"name":"../../utils/promise/withResolvers.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":257},"end":{"line":6,"column":69,"index":326}}],"key":"4pTIVQP/s9Y5cx6B6ztZ4RR/FQw=","exportNames":["*"],"imports":1}},{"name":"../../utils/promise/withRetry.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":327},"end":{"line":7,"column":62,"index":389}}],"key":"mjNdBLPMifX0YwonmSP8kvoGZh0=","exportNames":["*"],"imports":1}},{"name":"../../utils/stringify.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":390},"end":{"line":8,"column":53,"index":443}}],"key":"hATh5RA/q0TQG1HzvPAqv2f5XM8=","exportNames":["*"],"imports":1}},{"name":"./getCallsStatus.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":444},"end":{"line":9,"column":54,"index":498}}],"key":"xXcLntmFfLWz8bUicN+kr4Pd0xU=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.waitForCallsStatus = waitForCallsStatus;\n  Object.defineProperty(exports, \"WaitForCallsStatusTimeoutError\", {\n    enumerable: true,\n    get: function () {\n      return WaitForCallsStatusTimeoutError;\n    }\n  });\n  var _errorsBaseJs = require(_dependencyMap[0], \"../../errors/base.js\");\n  var _errorsCallsJs = require(_dependencyMap[1], \"../../errors/calls.js\");\n  var _utilsGetActionJs = require(_dependencyMap[2], \"../../utils/getAction.js\");\n  var _utilsObserveJs = require(_dependencyMap[3], \"../../utils/observe.js\");\n  var _utilsPollJs = require(_dependencyMap[4], \"../../utils/poll.js\");\n  var _utilsPromiseWithResolversJs = require(_dependencyMap[5], \"../../utils/promise/withResolvers.js\");\n  var _utilsPromiseWithRetryJs = require(_dependencyMap[6], \"../../utils/promise/withRetry.js\");\n  var _utilsStringifyJs = require(_dependencyMap[7], \"../../utils/stringify.js\");\n  var _getCallsStatusJs = require(_dependencyMap[8], \"./getCallsStatus.js\");\n  /**\n   * Waits for the status & receipts of a call bundle that was sent via `sendCalls`.\n   *\n   * - Docs: https://viem.sh/docs/actions/wallet/waitForCallsStatus\n   * - JSON-RPC Methods: [`wallet_getCallsStatus`](https://eips.ethereum.org/EIPS/eip-5792)\n   *\n   * @param client - Client to use\n   * @param parameters - {@link WaitForCallsStatusParameters}\n   * @returns Status & receipts of the call bundle. {@link WaitForCallsStatusReturnType}\n   *\n   * @example\n   * import { createWalletClient, custom } from 'viem'\n   * import { mainnet } from 'viem/chains'\n   * import { waitForCallsStatus } from 'viem/actions'\n   *\n   * const client = createWalletClient({\n   *   chain: mainnet,\n   *   transport: custom(window.ethereum),\n   * })\n   *\n   * const { receipts, status } = await waitForCallsStatus(client, { id: '0xdeadbeef' })\n   */\n  async function waitForCallsStatus(client, parameters) {\n    const {\n      id,\n      pollingInterval = client.pollingInterval,\n      status = ({\n        statusCode\n      }) => statusCode === 200 || statusCode >= 300,\n      retryCount = 4,\n      retryDelay = ({\n        count\n      }) => ~~(1 << count) * 200,\n      // exponential backoff\n      timeout = 60_000,\n      throwOnFailure = false\n    } = parameters;\n    const observerId = (0, _utilsStringifyJs.stringify)(['waitForCallsStatus', client.uid, id]);\n    const {\n      promise,\n      resolve,\n      reject\n    } = (0, _utilsPromiseWithResolversJs.withResolvers)();\n    let timer;\n    const unobserve = (0, _utilsObserveJs.observe)(observerId, {\n      resolve,\n      reject\n    }, emit => {\n      const unpoll = (0, _utilsPollJs.poll)(async () => {\n        const done = fn => {\n          clearTimeout(timer);\n          unpoll();\n          fn();\n          unobserve();\n        };\n        try {\n          const result = await (0, _utilsPromiseWithRetryJs.withRetry)(async () => {\n            const result = await (0, _utilsGetActionJs.getAction)(client, _getCallsStatusJs.getCallsStatus, 'getCallsStatus')({\n              id\n            });\n            if (throwOnFailure && result.status === 'failure') throw new _errorsCallsJs.BundleFailedError(result);\n            return result;\n          }, {\n            retryCount,\n            delay: retryDelay\n          });\n          if (!status(result)) return;\n          done(() => emit.resolve(result));\n        } catch (error) {\n          done(() => emit.reject(error));\n        }\n      }, {\n        interval: pollingInterval,\n        emitOnBegin: true\n      });\n      return unpoll;\n    });\n    timer = timeout ? setTimeout(() => {\n      unobserve();\n      clearTimeout(timer);\n      reject(new WaitForCallsStatusTimeoutError({\n        id\n      }));\n    }, timeout) : undefined;\n    return await promise;\n  }\n  class WaitForCallsStatusTimeoutError extends _errorsBaseJs.BaseError {\n    constructor({\n      id\n    }) {\n      super(`Timed out while waiting for call bundle with id \"${id}\" to be confirmed.`, {\n        name: 'WaitForCallsStatusTimeoutError'\n      });\n    }\n  }\n});","lineCount":118,"map":[[7,2,32,0,"exports"],[7,9,32,0],[7,10,32,0,"waitForCallsStatus"],[7,28,32,0],[7,31,32,0,"waitForCallsStatus"],[7,49,32,0],[8,2,78,0,"Object"],[8,8,78,0],[8,9,78,0,"defineProperty"],[8,23,78,0],[8,24,78,0,"exports"],[8,31,78,0],[9,4,78,0,"enumerable"],[9,14,78,0],[10,4,78,0,"get"],[10,7,78,0],[10,18,78,0,"get"],[10,19,78,0],[11,6,78,0],[11,13,78,0,"WaitForCallsStatusTimeoutError"],[11,43,78,0],[12,4,78,0],[13,2,78,0],[14,2,1,0],[14,6,1,0,"_errorsBaseJs"],[14,19,1,0],[14,22,1,0,"require"],[14,29,1,0],[14,30,1,0,"_dependencyMap"],[14,44,1,0],[15,2,2,0],[15,6,2,0,"_errorsCallsJs"],[15,20,2,0],[15,23,2,0,"require"],[15,30,2,0],[15,31,2,0,"_dependencyMap"],[15,45,2,0],[16,2,3,0],[16,6,3,0,"_utilsGetActionJs"],[16,23,3,0],[16,26,3,0,"require"],[16,33,3,0],[16,34,3,0,"_dependencyMap"],[16,48,3,0],[17,2,4,0],[17,6,4,0,"_utilsObserveJs"],[17,21,4,0],[17,24,4,0,"require"],[17,31,4,0],[17,32,4,0,"_dependencyMap"],[17,46,4,0],[18,2,5,0],[18,6,5,0,"_utilsPollJs"],[18,18,5,0],[18,21,5,0,"require"],[18,28,5,0],[18,29,5,0,"_dependencyMap"],[18,43,5,0],[19,2,6,0],[19,6,6,0,"_utilsPromiseWithResolversJs"],[19,34,6,0],[19,37,6,0,"require"],[19,44,6,0],[19,45,6,0,"_dependencyMap"],[19,59,6,0],[20,2,7,0],[20,6,7,0,"_utilsPromiseWithRetryJs"],[20,30,7,0],[20,33,7,0,"require"],[20,40,7,0],[20,41,7,0,"_dependencyMap"],[20,55,7,0],[21,2,8,0],[21,6,8,0,"_utilsStringifyJs"],[21,23,8,0],[21,26,8,0,"require"],[21,33,8,0],[21,34,8,0,"_dependencyMap"],[21,48,8,0],[22,2,9,0],[22,6,9,0,"_getCallsStatusJs"],[22,23,9,0],[22,26,9,0,"require"],[22,33,9,0],[22,34,9,0,"_dependencyMap"],[22,48,9,0],[23,2,10,0],[24,0,11,0],[25,0,12,0],[26,0,13,0],[27,0,14,0],[28,0,15,0],[29,0,16,0],[30,0,17,0],[31,0,18,0],[32,0,19,0],[33,0,20,0],[34,0,21,0],[35,0,22,0],[36,0,23,0],[37,0,24,0],[38,0,25,0],[39,0,26,0],[40,0,27,0],[41,0,28,0],[42,0,29,0],[43,0,30,0],[44,0,31,0],[45,2,32,7],[45,17,32,22,"waitForCallsStatus"],[45,35,32,40,"waitForCallsStatus"],[45,36,32,41,"client"],[45,42,32,47],[45,44,32,49,"parameters"],[45,54,32,59],[45,56,32,61],[46,4,33,4],[46,10,33,10],[47,6,33,12,"id"],[47,8,33,14],[48,6,33,16,"pollingInterval"],[48,21,33,31],[48,24,33,34,"client"],[48,30,33,40],[48,31,33,41,"pollingInterval"],[48,46,33,56],[49,6,33,58,"status"],[49,12,33,64],[49,15,33,67,"status"],[49,16,33,68],[50,8,33,70,"statusCode"],[51,6,33,81],[51,7,33,82],[51,12,33,87,"statusCode"],[51,22,33,97],[51,27,33,102],[51,30,33,105],[51,34,33,109,"statusCode"],[51,44,33,119],[51,48,33,123],[51,51,33,126],[52,6,33,128,"retryCount"],[52,16,33,138],[52,19,33,141],[52,20,33,142],[53,6,33,144,"retryDelay"],[53,16,33,154],[53,19,33,157,"retryDelay"],[53,20,33,158],[54,8,33,160,"count"],[55,6,33,166],[55,7,33,167],[55,12,33,172],[55,13,33,173],[55,15,33,175],[55,16,33,176],[55,20,33,180,"count"],[55,25,33,185],[55,26,33,186],[55,29,33,189],[55,32,33,192],[56,6,33,194],[57,6,34,4,"timeout"],[57,13,34,11],[57,16,34,14],[57,22,34,20],[58,6,34,22,"throwOnFailure"],[58,20,34,36],[58,23,34,39],[59,4,34,46],[59,5,34,47],[59,8,34,50,"parameters"],[59,18,34,60],[60,4,35,4],[60,10,35,10,"observerId"],[60,20,35,20],[60,23,35,23],[60,27,35,23,"stringify"],[60,44,35,32],[60,45,35,32,"stringify"],[60,54,35,32],[60,56,35,33],[60,57,35,34],[60,77,35,54],[60,79,35,56,"client"],[60,85,35,62],[60,86,35,63,"uid"],[60,89,35,66],[60,91,35,68,"id"],[60,93,35,70],[60,94,35,71],[60,95,35,72],[61,4,36,4],[61,10,36,10],[62,6,36,12,"promise"],[62,13,36,19],[63,6,36,21,"resolve"],[63,13,36,28],[64,6,36,30,"reject"],[65,4,36,37],[65,5,36,38],[65,8,36,41],[65,12,36,41,"withResolvers"],[65,40,36,54],[65,41,36,54,"withResolvers"],[65,54,36,54],[65,56,36,55],[65,57,36,56],[66,4,37,4],[66,8,37,8,"timer"],[66,13,37,13],[67,4,38,4],[67,10,38,10,"unobserve"],[67,19,38,19],[67,22,38,22],[67,26,38,22,"observe"],[67,41,38,29],[67,42,38,29,"observe"],[67,49,38,29],[67,51,38,30,"observerId"],[67,61,38,40],[67,63,38,42],[68,6,38,44,"resolve"],[68,13,38,51],[69,6,38,53,"reject"],[70,4,38,60],[70,5,38,61],[70,7,38,64,"emit"],[70,11,38,68],[70,15,38,73],[71,6,39,8],[71,12,39,14,"unpoll"],[71,18,39,20],[71,21,39,23],[71,25,39,23,"poll"],[71,37,39,27],[71,38,39,27,"poll"],[71,42,39,27],[71,44,39,28],[71,56,39,40],[72,8,40,12],[72,14,40,18,"done"],[72,18,40,22],[72,21,40,26,"fn"],[72,23,40,28],[72,27,40,33],[73,10,41,16,"clearTimeout"],[73,22,41,28],[73,23,41,29,"timer"],[73,28,41,34],[73,29,41,35],[74,10,42,16,"unpoll"],[74,16,42,22],[74,17,42,23],[74,18,42,24],[75,10,43,16,"fn"],[75,12,43,18],[75,13,43,19],[75,14,43,20],[76,10,44,16,"unobserve"],[76,19,44,25],[76,20,44,26],[76,21,44,27],[77,8,45,12],[77,9,45,13],[78,8,46,12],[78,12,46,16],[79,10,47,16],[79,16,47,22,"result"],[79,22,47,28],[79,25,47,31],[79,31,47,37],[79,35,47,37,"withRetry"],[79,59,47,46],[79,60,47,46,"withRetry"],[79,69,47,46],[79,71,47,47],[79,83,47,59],[80,12,48,20],[80,18,48,26,"result"],[80,24,48,32],[80,27,48,35],[80,33,48,41],[80,37,48,41,"getAction"],[80,54,48,50],[80,55,48,50,"getAction"],[80,64,48,50],[80,66,48,51,"client"],[80,72,48,57],[80,74,48,59,"getCallsStatus"],[80,91,48,73],[80,92,48,73,"getCallsStatus"],[80,106,48,73],[80,108,48,75],[80,124,48,91],[80,125,48,92],[80,126,48,93],[81,14,48,95,"id"],[82,12,48,98],[82,13,48,99],[82,14,48,100],[83,12,49,20],[83,16,49,24,"throwOnFailure"],[83,30,49,38],[83,34,49,42,"result"],[83,40,49,48],[83,41,49,49,"status"],[83,47,49,55],[83,52,49,60],[83,61,49,69],[83,63,50,24],[83,69,50,30],[83,73,50,34,"BundleFailedError"],[83,87,50,51],[83,88,50,51,"BundleFailedError"],[83,105,50,51],[83,106,50,52,"result"],[83,112,50,58],[83,113,50,59],[84,12,51,20],[84,19,51,27,"result"],[84,25,51,33],[85,10,52,16],[85,11,52,17],[85,13,52,19],[86,12,53,20,"retryCount"],[86,22,53,30],[87,12,54,20,"delay"],[87,17,54,25],[87,19,54,27,"retryDelay"],[88,10,55,16],[88,11,55,17],[88,12,55,18],[89,10,56,16],[89,14,56,20],[89,15,56,21,"status"],[89,21,56,27],[89,22,56,28,"result"],[89,28,56,34],[89,29,56,35],[89,31,57,20],[90,10,58,16,"done"],[90,14,58,20],[90,15,58,21],[90,21,58,27,"emit"],[90,25,58,31],[90,26,58,32,"resolve"],[90,33,58,39],[90,34,58,40,"result"],[90,40,58,46],[90,41,58,47],[90,42,58,48],[91,8,59,12],[91,9,59,13],[91,10,60,12],[91,17,60,19,"error"],[91,22,60,24],[91,24,60,26],[92,10,61,16,"done"],[92,14,61,20],[92,15,61,21],[92,21,61,27,"emit"],[92,25,61,31],[92,26,61,32,"reject"],[92,32,61,38],[92,33,61,39,"error"],[92,38,61,44],[92,39,61,45],[92,40,61,46],[93,8,62,12],[94,6,63,8],[94,7,63,9],[94,9,63,11],[95,8,64,12,"interval"],[95,16,64,20],[95,18,64,22,"pollingInterval"],[95,33,64,37],[96,8,65,12,"emitOnBegin"],[96,19,65,23],[96,21,65,25],[97,6,66,8],[97,7,66,9],[97,8,66,10],[98,6,67,8],[98,13,67,15,"unpoll"],[98,19,67,21],[99,4,68,4],[99,5,68,5],[99,6,68,6],[100,4,69,4,"timer"],[100,9,69,9],[100,12,69,12,"timeout"],[100,19,69,19],[100,22,70,10,"setTimeout"],[100,32,70,20],[100,33,70,21],[100,39,70,27],[101,6,71,12,"unobserve"],[101,15,71,21],[101,16,71,22],[101,17,71,23],[102,6,72,12,"clearTimeout"],[102,18,72,24],[102,19,72,25,"timer"],[102,24,72,30],[102,25,72,31],[103,6,73,12,"reject"],[103,12,73,18],[103,13,73,19],[103,17,73,23,"WaitForCallsStatusTimeoutError"],[103,47,73,53],[103,48,73,54],[104,8,73,56,"id"],[105,6,73,59],[105,7,73,60],[105,8,73,61],[105,9,73,62],[106,4,74,8],[106,5,74,9],[106,7,74,11,"timeout"],[106,14,74,18],[106,15,74,19],[106,18,75,10,"undefined"],[106,27,75,19],[107,4,76,4],[107,11,76,11],[107,17,76,17,"promise"],[107,24,76,24],[108,2,77,0],[109,2,78,7],[109,8,78,13,"WaitForCallsStatusTimeoutError"],[109,38,78,43],[109,47,78,52,"BaseError"],[109,60,78,61],[109,61,78,61,"BaseError"],[109,70,78,61],[109,71,78,62],[110,4,79,4,"constructor"],[110,15,79,15,"constructor"],[110,16,79,16],[111,6,79,18,"id"],[112,4,79,21],[112,5,79,22],[112,7,79,24],[113,6,80,8],[113,11,80,13],[113,12,80,14],[113,64,80,66,"id"],[113,66,80,68],[113,86,80,88],[113,88,80,90],[114,8,80,92,"name"],[114,12,80,96],[114,14,80,98],[115,6,80,131],[115,7,80,132],[115,8,80,133],[116,4,81,4],[117,2,82,0],[118,0,82,1],[118,3]],"functionMap":{"names":["<global>","waitForCallsStatus","<anonymous>","observe$argument_2","poll$argument_0","done","withRetry$argument_0","done$argument_0","setTimeout$argument_0","WaitForCallsStatusTimeoutError","WaitForCallsStatusTimeoutError#constructor"],"mappings":"AAA;OC+B;mECC,2DD,+BC,mCD;+DEK;4BCC;yBCC;aDK;+CEE;iBFK;qBGM,0BH;qBGG,wBH;SDE;KFK;qBOE;SPI;CDG;OSC;ICC;KDE;CTC"},"hasCjsExports":false},"type":"js/module"}]}