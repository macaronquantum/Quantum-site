{"dependencies":[{"name":"../controllers/AccountController.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":72,"index":72}}],"key":"raxu2hnZ9hCXAXGKKedCSNk4kOw=","exportNames":["*"],"imports":1}},{"name":"../controllers/BlockchainApiController.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":73},"end":{"line":2,"column":84,"index":157}}],"key":"a0Gyip/3MT7Ik3+5DFMfpYkDURk=","exportNames":["*"],"imports":1}},{"name":"../controllers/ChainController.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":158},"end":{"line":3,"column":68,"index":226}}],"key":"/k9dnUgYQKzJovjmtDttxLYEwvk=","exportNames":["*"],"imports":1}},{"name":"../controllers/ConnectionController.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":227},"end":{"line":4,"column":78,"index":305}}],"key":"+QMPexp8lWQCy637Jx32pHeJqYY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"SwapApiUtil\", {\n    enumerable: true,\n    get: function () {\n      return SwapApiUtil;\n    }\n  });\n  var _controllersAccountControllerJs = require(_dependencyMap[0], \"../controllers/AccountController.js\");\n  var _controllersBlockchainApiControllerJs = require(_dependencyMap[1], \"../controllers/BlockchainApiController.js\");\n  var _controllersChainControllerJs = require(_dependencyMap[2], \"../controllers/ChainController.js\");\n  var _controllersConnectionControllerJs = require(_dependencyMap[3], \"../controllers/ConnectionController.js\");\n  // -- Controller ---------------------------------------- //\n  const SwapApiUtil = {\n    async getTokenList() {\n      const caipNetwork = _controllersChainControllerJs.ChainController.state.activeCaipNetwork;\n      const response = await _controllersBlockchainApiControllerJs.BlockchainApiController.fetchSwapTokens({\n        chainId: caipNetwork?.caipNetworkId\n      });\n      const tokens = response?.tokens?.map(token => Object.assign({}, token, {\n        eip2612: false,\n        quantity: {\n          decimals: '0',\n          numeric: '0'\n        },\n        price: 0,\n        value: 0\n      })) || [];\n      return tokens;\n    },\n    async fetchGasPrice() {\n      const caipNetwork = _controllersChainControllerJs.ChainController.state.activeCaipNetwork;\n      if (!caipNetwork) {\n        return null;\n      }\n      try {\n        switch (caipNetwork.chainNamespace) {\n          case 'solana':\n            // eslint-disable-next-line no-case-declarations\n            const lamportsPerSignature = (await _controllersConnectionControllerJs.ConnectionController?.estimateGas({\n              chainNamespace: 'solana'\n            }))?.toString();\n            return {\n              standard: lamportsPerSignature,\n              fast: lamportsPerSignature,\n              instant: lamportsPerSignature\n            };\n          case 'eip155':\n          default:\n            return await _controllersBlockchainApiControllerJs.BlockchainApiController.fetchGasPrice({\n              chainId: caipNetwork.caipNetworkId\n            });\n        }\n      } catch {\n        return null;\n      }\n    },\n    async fetchSwapAllowance({\n      tokenAddress,\n      userAddress,\n      sourceTokenAmount,\n      sourceTokenDecimals\n    }) {\n      const response = await _controllersBlockchainApiControllerJs.BlockchainApiController.fetchSwapAllowance({\n        tokenAddress,\n        userAddress\n      });\n      if (response?.allowance && sourceTokenAmount && sourceTokenDecimals) {\n        const parsedValue = _controllersConnectionControllerJs.ConnectionController.parseUnits(sourceTokenAmount, sourceTokenDecimals) || 0;\n        const hasAllowance = BigInt(response.allowance) >= parsedValue;\n        return hasAllowance;\n      }\n      return false;\n    },\n    async getMyTokensWithBalance(forceUpdate) {\n      const address = _controllersAccountControllerJs.AccountController.state.address;\n      const caipNetwork = _controllersChainControllerJs.ChainController.state.activeCaipNetwork;\n      if (!address || !caipNetwork) {\n        return [];\n      }\n      const response = await _controllersBlockchainApiControllerJs.BlockchainApiController.getBalance(address, caipNetwork.caipNetworkId, forceUpdate);\n      /*\n       * The 1Inch API includes many low-quality tokens in the balance response,\n       * which appear inconsistently. This filter prevents them from being displayed.\n       */\n      const balances = response.balances.filter(balance => balance.quantity.decimals !== '0');\n      _controllersAccountControllerJs.AccountController.setTokenBalance(balances, _controllersChainControllerJs.ChainController.state.activeChain);\n      return this.mapBalancesToSwapTokens(balances);\n    },\n    mapBalancesToSwapTokens(balances) {\n      return balances?.map(token => Object.assign({}, token, {\n        address: token?.address ? token.address : _controllersChainControllerJs.ChainController.getActiveNetworkTokenAddress(),\n        decimals: parseInt(token.quantity.decimals, 10),\n        logoUri: token.iconUrl,\n        eip2612: false\n      })) || [];\n    }\n  };\n});","lineCount":103,"map":[[7,2,6,0,"Object"],[7,8,6,0],[7,9,6,0,"defineProperty"],[7,23,6,0],[7,24,6,0,"exports"],[7,31,6,0],[8,4,6,0,"enumerable"],[8,14,6,0],[9,4,6,0,"get"],[9,7,6,0],[9,18,6,0,"get"],[9,19,6,0],[10,6,6,0],[10,13,6,0,"SwapApiUtil"],[10,24,6,0],[11,4,6,0],[12,2,6,0],[13,2,1,0],[13,6,1,0,"_controllersAccountControllerJs"],[13,37,1,0],[13,40,1,0,"require"],[13,47,1,0],[13,48,1,0,"_dependencyMap"],[13,62,1,0],[14,2,2,0],[14,6,2,0,"_controllersBlockchainApiControllerJs"],[14,43,2,0],[14,46,2,0,"require"],[14,53,2,0],[14,54,2,0,"_dependencyMap"],[14,68,2,0],[15,2,3,0],[15,6,3,0,"_controllersChainControllerJs"],[15,35,3,0],[15,38,3,0,"require"],[15,45,3,0],[15,46,3,0,"_dependencyMap"],[15,60,3,0],[16,2,4,0],[16,6,4,0,"_controllersConnectionControllerJs"],[16,40,4,0],[16,43,4,0,"require"],[16,50,4,0],[16,51,4,0,"_dependencyMap"],[16,65,4,0],[17,2,5,0],[18,2,6,7],[18,8,6,13,"SwapApiUtil"],[18,19,6,24],[18,22,6,27],[19,4,7,4],[19,10,7,10,"getTokenList"],[19,22,7,22,"getTokenList"],[19,23,7,22],[19,25,7,25],[20,6,8,8],[20,12,8,14,"caipNetwork"],[20,23,8,25],[20,26,8,28,"ChainController"],[20,55,8,43],[20,56,8,43,"ChainController"],[20,71,8,43],[20,72,8,44,"state"],[20,77,8,49],[20,78,8,50,"activeCaipNetwork"],[20,95,8,67],[21,6,9,8],[21,12,9,14,"response"],[21,20,9,22],[21,23,9,25],[21,29,9,31,"BlockchainApiController"],[21,66,9,54],[21,67,9,54,"BlockchainApiController"],[21,90,9,54],[21,91,9,55,"fetchSwapTokens"],[21,106,9,70],[21,107,9,71],[22,8,10,12,"chainId"],[22,15,10,19],[22,17,10,21,"caipNetwork"],[22,28,10,32],[22,30,10,34,"caipNetworkId"],[23,6,11,8],[23,7,11,9],[23,8,11,10],[24,6,12,8],[24,12,12,14,"tokens"],[24,18,12,20],[24,21,12,23,"response"],[24,29,12,31],[24,31,12,33,"tokens"],[24,37,12,39],[24,39,12,41,"map"],[24,42,12,44],[24,43,12,45,"token"],[24,48,12,50],[24,52,12,50,"Object"],[24,58,12,50],[24,59,12,50,"assign"],[24,65,12,50],[24,70,13,15,"token"],[24,75,13,20],[25,8,14,12,"eip2612"],[25,15,14,19],[25,17,14,21],[25,22,14,26],[26,8,15,12,"quantity"],[26,16,15,20],[26,18,15,22],[27,10,16,16,"decimals"],[27,18,16,24],[27,20,16,26],[27,23,16,29],[28,10,17,16,"numeric"],[28,17,17,23],[28,19,17,25],[29,8,18,12],[29,9,18,13],[30,8,19,12,"price"],[30,13,19,17],[30,15,19,19],[30,16,19,20],[31,8,20,12,"value"],[31,13,20,17],[31,15,20,19],[32,6,20,20],[32,8,21,10],[32,9,21,11],[32,13,21,15],[32,15,21,17],[33,6,22,8],[33,13,22,15,"tokens"],[33,19,22,21],[34,4,23,4],[34,5,23,5],[35,4,24,4],[35,10,24,10,"fetchGasPrice"],[35,23,24,23,"fetchGasPrice"],[35,24,24,23],[35,26,24,26],[36,6,25,8],[36,12,25,14,"caipNetwork"],[36,23,25,25],[36,26,25,28,"ChainController"],[36,55,25,43],[36,56,25,43,"ChainController"],[36,71,25,43],[36,72,25,44,"state"],[36,77,25,49],[36,78,25,50,"activeCaipNetwork"],[36,95,25,67],[37,6,26,8],[37,10,26,12],[37,11,26,13,"caipNetwork"],[37,22,26,24],[37,24,26,26],[38,8,27,12],[38,15,27,19],[38,19,27,23],[39,6,28,8],[40,6,29,8],[40,10,29,12],[41,8,30,12],[41,16,30,20,"caipNetwork"],[41,27,30,31],[41,28,30,32,"chainNamespace"],[41,42,30,46],[42,10,31,16],[42,15,31,21],[42,23,31,29],[43,12,32,20],[44,12,33,20],[44,18,33,26,"lamportsPerSignature"],[44,38,33,46],[44,41,33,49],[44,42,33,50],[44,48,33,56,"ConnectionController"],[44,82,33,76],[44,83,33,76,"ConnectionController"],[44,103,33,76],[44,105,33,78,"estimateGas"],[44,116,33,89],[44,117,33,90],[45,14,33,92,"chainNamespace"],[45,28,33,106],[45,30,33,108],[46,12,33,117],[46,13,33,118],[46,14,33,119],[46,17,33,122,"toString"],[46,25,33,130],[46,26,33,131],[46,27,33,132],[47,12,34,20],[47,19,34,27],[48,14,35,24,"standard"],[48,22,35,32],[48,24,35,34,"lamportsPerSignature"],[48,44,35,54],[49,14,36,24,"fast"],[49,18,36,28],[49,20,36,30,"lamportsPerSignature"],[49,40,36,50],[50,14,37,24,"instant"],[50,21,37,31],[50,23,37,33,"lamportsPerSignature"],[51,12,38,20],[51,13,38,21],[52,10,39,16],[52,15,39,21],[52,23,39,29],[53,10,40,16],[54,12,41,20],[54,19,41,27],[54,25,41,33,"BlockchainApiController"],[54,62,41,56],[54,63,41,56,"BlockchainApiController"],[54,86,41,56],[54,87,41,57,"fetchGasPrice"],[54,100,41,70],[54,101,41,71],[55,14,42,24,"chainId"],[55,21,42,31],[55,23,42,33,"caipNetwork"],[55,34,42,44],[55,35,42,45,"caipNetworkId"],[56,12,43,20],[56,13,43,21],[56,14,43,22],[57,8,44,12],[58,6,45,8],[58,7,45,9],[58,8,46,8],[58,14,46,14],[59,8,47,12],[59,15,47,19],[59,19,47,23],[60,6,48,8],[61,4,49,4],[61,5,49,5],[62,4,50,4],[62,10,50,10,"fetchSwapAllowance"],[62,28,50,28,"fetchSwapAllowance"],[62,29,50,29],[63,6,50,31,"tokenAddress"],[63,18,50,43],[64,6,50,45,"userAddress"],[64,17,50,56],[65,6,50,58,"sourceTokenAmount"],[65,23,50,75],[66,6,50,77,"sourceTokenDecimals"],[67,4,50,97],[67,5,50,98],[67,7,50,100],[68,6,51,8],[68,12,51,14,"response"],[68,20,51,22],[68,23,51,25],[68,29,51,31,"BlockchainApiController"],[68,66,51,54],[68,67,51,54,"BlockchainApiController"],[68,90,51,54],[68,91,51,55,"fetchSwapAllowance"],[68,109,51,73],[68,110,51,74],[69,8,52,12,"tokenAddress"],[69,20,52,24],[70,8,53,12,"userAddress"],[71,6,54,8],[71,7,54,9],[71,8,54,10],[72,6,55,8],[72,10,55,12,"response"],[72,18,55,20],[72,20,55,22,"allowance"],[72,29,55,31],[72,33,55,35,"sourceTokenAmount"],[72,50,55,52],[72,54,55,56,"sourceTokenDecimals"],[72,73,55,75],[72,75,55,77],[73,8,56,12],[73,14,56,18,"parsedValue"],[73,25,56,29],[73,28,56,32,"ConnectionController"],[73,62,56,52],[73,63,56,52,"ConnectionController"],[73,83,56,52],[73,84,56,53,"parseUnits"],[73,94,56,63],[73,95,56,64,"sourceTokenAmount"],[73,112,56,81],[73,114,56,83,"sourceTokenDecimals"],[73,133,56,102],[73,134,56,103],[73,138,56,107],[73,139,56,108],[74,8,57,12],[74,14,57,18,"hasAllowance"],[74,26,57,30],[74,29,57,33,"BigInt"],[74,35,57,39],[74,36,57,40,"response"],[74,44,57,48],[74,45,57,49,"allowance"],[74,54,57,58],[74,55,57,59],[74,59,57,63,"parsedValue"],[74,70,57,74],[75,8,58,12],[75,15,58,19,"hasAllowance"],[75,27,58,31],[76,6,59,8],[77,6,60,8],[77,13,60,15],[77,18,60,20],[78,4,61,4],[78,5,61,5],[79,4,62,4],[79,10,62,10,"getMyTokensWithBalance"],[79,32,62,32,"getMyTokensWithBalance"],[79,33,62,33,"forceUpdate"],[79,44,62,44],[79,46,62,46],[80,6,63,8],[80,12,63,14,"address"],[80,19,63,21],[80,22,63,24,"AccountController"],[80,53,63,41],[80,54,63,41,"AccountController"],[80,71,63,41],[80,72,63,42,"state"],[80,77,63,47],[80,78,63,48,"address"],[80,85,63,55],[81,6,64,8],[81,12,64,14,"caipNetwork"],[81,23,64,25],[81,26,64,28,"ChainController"],[81,55,64,43],[81,56,64,43,"ChainController"],[81,71,64,43],[81,72,64,44,"state"],[81,77,64,49],[81,78,64,50,"activeCaipNetwork"],[81,95,64,67],[82,6,65,8],[82,10,65,12],[82,11,65,13,"address"],[82,18,65,20],[82,22,65,24],[82,23,65,25,"caipNetwork"],[82,34,65,36],[82,36,65,38],[83,8,66,12],[83,15,66,19],[83,17,66,21],[84,6,67,8],[85,6,68,8],[85,12,68,14,"response"],[85,20,68,22],[85,23,68,25],[85,29,68,31,"BlockchainApiController"],[85,66,68,54],[85,67,68,54,"BlockchainApiController"],[85,90,68,54],[85,91,68,55,"getBalance"],[85,101,68,65],[85,102,68,66,"address"],[85,109,68,73],[85,111,68,75,"caipNetwork"],[85,122,68,86],[85,123,68,87,"caipNetworkId"],[85,136,68,100],[85,138,68,102,"forceUpdate"],[85,149,68,113],[85,150,68,114],[86,6,69,8],[87,0,70,0],[88,0,71,0],[89,0,72,0],[90,6,73,8],[90,12,73,14,"balances"],[90,20,73,22],[90,23,73,25,"response"],[90,31,73,33],[90,32,73,34,"balances"],[90,40,73,42],[90,41,73,43,"filter"],[90,47,73,49],[90,48,73,50,"balance"],[90,55,73,57],[90,59,73,61,"balance"],[90,66,73,68],[90,67,73,69,"quantity"],[90,75,73,77],[90,76,73,78,"decimals"],[90,84,73,86],[90,89,73,91],[90,92,73,94],[90,93,73,95],[91,6,74,8,"AccountController"],[91,37,74,25],[91,38,74,25,"AccountController"],[91,55,74,25],[91,56,74,26,"setTokenBalance"],[91,71,74,41],[91,72,74,42,"balances"],[91,80,74,50],[91,82,74,52,"ChainController"],[91,111,74,67],[91,112,74,67,"ChainController"],[91,127,74,67],[91,128,74,68,"state"],[91,133,74,73],[91,134,74,74,"activeChain"],[91,145,74,85],[91,146,74,86],[92,6,75,8],[92,13,75,15],[92,17,75,19],[92,18,75,20,"mapBalancesToSwapTokens"],[92,41,75,43],[92,42,75,44,"balances"],[92,50,75,52],[92,51,75,53],[93,4,76,4],[93,5,76,5],[94,4,77,4,"mapBalancesToSwapTokens"],[94,27,77,27,"mapBalancesToSwapTokens"],[94,28,77,28,"balances"],[94,36,77,36],[94,38,77,38],[95,6,78,8],[95,13,78,16,"balances"],[95,21,78,24],[95,23,78,26,"map"],[95,26,78,29],[95,27,78,30,"token"],[95,32,78,35],[95,36,78,35,"Object"],[95,42,78,35],[95,43,78,35,"assign"],[95,49,78,35],[95,54,79,15,"token"],[95,59,79,20],[96,8,80,12,"address"],[96,15,80,19],[96,17,80,21,"token"],[96,22,80,26],[96,24,80,28,"address"],[96,31,80,35],[96,34,81,18,"token"],[96,39,81,23],[96,40,81,24,"address"],[96,47,81,31],[96,50,82,18,"ChainController"],[96,79,82,33],[96,80,82,33,"ChainController"],[96,95,82,33],[96,96,82,34,"getActiveNetworkTokenAddress"],[96,124,82,62],[96,125,82,63],[96,126,82,64],[97,8,83,12,"decimals"],[97,16,83,20],[97,18,83,22,"parseInt"],[97,26,83,30],[97,27,83,31,"token"],[97,32,83,36],[97,33,83,37,"quantity"],[97,41,83,45],[97,42,83,46,"decimals"],[97,50,83,54],[97,52,83,56],[97,54,83,58],[97,55,83,59],[98,8,84,12,"logoUri"],[98,15,84,19],[98,17,84,21,"token"],[98,22,84,26],[98,23,84,27,"iconUrl"],[98,30,84,34],[99,8,85,12,"eip2612"],[99,15,85,19],[99,17,85,21],[100,6,85,26],[100,8,86,10],[100,9,86,11],[100,13,86,15],[100,15,86,17],[101,4,87,4],[102,2,88,0],[102,3,88,1],[103,0,88,2],[103,3]],"functionMap":{"names":["<global>","getTokenList","response.tokens.map$argument_0","fetchGasPrice","fetchSwapAllowance","getMyTokensWithBalance","response.balances.filter$argument_0","mapBalancesToSwapTokens","balances.map$argument_0"],"mappings":"AAA;ICM;6CCK;UDS;KDE;IGC;KHyB;IIC;KJW;IKC;kDCW,4CD;KLG;IOC;8BCC;UDQ;KPC"},"hasCjsExports":false},"type":"js/module"}]}