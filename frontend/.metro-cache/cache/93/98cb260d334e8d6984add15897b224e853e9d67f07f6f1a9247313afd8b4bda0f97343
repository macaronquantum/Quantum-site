{"dependencies":[{"name":"../../accounts/utils/parseAccount.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":69,"index":69}}],"key":"/2Bvi5qErxbS6yBB5FzUPODHkYU=","exportNames":["*"],"imports":1}},{"name":"../../errors/account.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":70},"end":{"line":2,"column":64,"index":134}}],"key":"K61ywxBVZ9paXlRCxRBVdR8Z3Zk=","exportNames":["*"],"imports":1}},{"name":"../../utils/address/isAddressEqual.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":135},"end":{"line":3,"column":71,"index":206}}],"key":"QOKdL7e5DneeeeM2JMix/Sm+VlQ=","exportNames":["*"],"imports":1}},{"name":"../../utils/getAction.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":207},"end":{"line":4,"column":53,"index":260}}],"key":"vt4scbNyA2t/tyY0oQJI6AZPJS4=","exportNames":["*"],"imports":1}},{"name":"../public/getChainId.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":261},"end":{"line":5,"column":53,"index":314}}],"key":"jXyNetIDw+iP/Bya7ka3CqSfeeQ=","exportNames":["*"],"imports":1}},{"name":"../public/getTransactionCount.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":315},"end":{"line":6,"column":71,"index":386}}],"key":"ZW0M7bkET5Vf6T8vaq1M2uSS0Cc=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.prepareAuthorization = prepareAuthorization;\n  var _accountsUtilsParseAccountJs = require(_dependencyMap[0], \"../../accounts/utils/parseAccount.js\");\n  var _errorsAccountJs = require(_dependencyMap[1], \"../../errors/account.js\");\n  var _utilsAddressIsAddressEqualJs = require(_dependencyMap[2], \"../../utils/address/isAddressEqual.js\");\n  var _utilsGetActionJs = require(_dependencyMap[3], \"../../utils/getAction.js\");\n  var _publicGetChainIdJs = require(_dependencyMap[4], \"../public/getChainId.js\");\n  var _publicGetTransactionCountJs = require(_dependencyMap[5], \"../public/getTransactionCount.js\");\n  /**\n   * Prepares an [EIP-7702 Authorization](https://eips.ethereum.org/EIPS/eip-7702) object for signing.\n   * This Action will fill the required fields of the Authorization object if they are not provided (e.g. `nonce` and `chainId`).\n   *\n   * With the prepared Authorization object, you can use [`signAuthorization`](https://viem.sh/docs/eip7702/signAuthorization) to sign over the Authorization object.\n   *\n   * @param client - Client to use\n   * @param parameters - {@link PrepareAuthorizationParameters}\n   * @returns The prepared Authorization object. {@link PrepareAuthorizationReturnType}\n   *\n   * @example\n   * import { createClient, http } from 'viem'\n   * import { privateKeyToAccount } from 'viem/accounts'\n   * import { mainnet } from 'viem/chains'\n   * import { prepareAuthorization } from 'viem/experimental'\n   *\n   * const client = createClient({\n   *   chain: mainnet,\n   *   transport: http(),\n   * })\n   * const authorization = await prepareAuthorization(client, {\n   *   account: privateKeyToAccount('0x..'),\n   *   contractAddress: '0xA0Cf798816D4b9b9866b5330EEa46a18382f251e',\n   * })\n   *\n   * @example\n   * // Account Hoisting\n   * import { createClient, http } from 'viem'\n   * import { privateKeyToAccount } from 'viem/accounts'\n   * import { mainnet } from 'viem/chains'\n   * import { prepareAuthorization } from 'viem/experimental'\n   *\n   * const client = createClient({\n   *   account: privateKeyToAccount('0xâ€¦'),\n   *   chain: mainnet,\n   *   transport: http(),\n   * })\n   * const authorization = await prepareAuthorization(client, {\n   *   contractAddress: '0xA0Cf798816D4b9b9866b5330EEa46a18382f251e',\n   * })\n   */\n  async function prepareAuthorization(client, parameters) {\n    const {\n      account: account_ = client.account,\n      chainId,\n      nonce\n    } = parameters;\n    if (!account_) throw new _errorsAccountJs.AccountNotFoundError({\n      docsPath: '/docs/eip7702/prepareAuthorization'\n    });\n    const account = (0, _accountsUtilsParseAccountJs.parseAccount)(account_);\n    const executor = (() => {\n      if (!parameters.executor) return undefined;\n      if (parameters.executor === 'self') return parameters.executor;\n      return (0, _accountsUtilsParseAccountJs.parseAccount)(parameters.executor);\n    })();\n    const authorization = {\n      address: parameters.contractAddress ?? parameters.address,\n      chainId,\n      nonce\n    };\n    if (typeof authorization.chainId === 'undefined') authorization.chainId = client.chain?.id ?? (await (0, _utilsGetActionJs.getAction)(client, _publicGetChainIdJs.getChainId, 'getChainId')({}));\n    if (typeof authorization.nonce === 'undefined') {\n      authorization.nonce = await (0, _utilsGetActionJs.getAction)(client, _publicGetTransactionCountJs.getTransactionCount, 'getTransactionCount')({\n        address: account.address,\n        blockTag: 'pending'\n      });\n      if (executor === 'self' || executor?.address && (0, _utilsAddressIsAddressEqualJs.isAddressEqual)(executor.address, account.address)) authorization.nonce += 1;\n    }\n    return authorization;\n  }\n});","lineCount":85,"map":[[7,2,48,0,"exports"],[7,9,48,0],[7,10,48,0,"prepareAuthorization"],[7,30,48,0],[7,33,48,0,"prepareAuthorization"],[7,53,48,0],[8,2,1,0],[8,6,1,0,"_accountsUtilsParseAccountJs"],[8,34,1,0],[8,37,1,0,"require"],[8,44,1,0],[8,45,1,0,"_dependencyMap"],[8,59,1,0],[9,2,2,0],[9,6,2,0,"_errorsAccountJs"],[9,22,2,0],[9,25,2,0,"require"],[9,32,2,0],[9,33,2,0,"_dependencyMap"],[9,47,2,0],[10,2,3,0],[10,6,3,0,"_utilsAddressIsAddressEqualJs"],[10,35,3,0],[10,38,3,0,"require"],[10,45,3,0],[10,46,3,0,"_dependencyMap"],[10,60,3,0],[11,2,4,0],[11,6,4,0,"_utilsGetActionJs"],[11,23,4,0],[11,26,4,0,"require"],[11,33,4,0],[11,34,4,0,"_dependencyMap"],[11,48,4,0],[12,2,5,0],[12,6,5,0,"_publicGetChainIdJs"],[12,25,5,0],[12,28,5,0,"require"],[12,35,5,0],[12,36,5,0,"_dependencyMap"],[12,50,5,0],[13,2,6,0],[13,6,6,0,"_publicGetTransactionCountJs"],[13,34,6,0],[13,37,6,0,"require"],[13,44,6,0],[13,45,6,0,"_dependencyMap"],[13,59,6,0],[14,2,7,0],[15,0,8,0],[16,0,9,0],[17,0,10,0],[18,0,11,0],[19,0,12,0],[20,0,13,0],[21,0,14,0],[22,0,15,0],[23,0,16,0],[24,0,17,0],[25,0,18,0],[26,0,19,0],[27,0,20,0],[28,0,21,0],[29,0,22,0],[30,0,23,0],[31,0,24,0],[32,0,25,0],[33,0,26,0],[34,0,27,0],[35,0,28,0],[36,0,29,0],[37,0,30,0],[38,0,31,0],[39,0,32,0],[40,0,33,0],[41,0,34,0],[42,0,35,0],[43,0,36,0],[44,0,37,0],[45,0,38,0],[46,0,39,0],[47,0,40,0],[48,0,41,0],[49,0,42,0],[50,0,43,0],[51,0,44,0],[52,0,45,0],[53,0,46,0],[54,0,47,0],[55,2,48,7],[55,17,48,22,"prepareAuthorization"],[55,37,48,42,"prepareAuthorization"],[55,38,48,43,"client"],[55,44,48,49],[55,46,48,51,"parameters"],[55,56,48,61],[55,58,48,63],[56,4,49,4],[56,10,49,10],[57,6,49,12,"account"],[57,13,49,19],[57,15,49,21,"account_"],[57,23,49,29],[57,26,49,32,"client"],[57,32,49,38],[57,33,49,39,"account"],[57,40,49,46],[58,6,49,48,"chainId"],[58,13,49,55],[59,6,49,57,"nonce"],[60,4,49,63],[60,5,49,64],[60,8,49,67,"parameters"],[60,18,49,77],[61,4,50,4],[61,8,50,8],[61,9,50,9,"account_"],[61,17,50,17],[61,19,51,8],[61,25,51,14],[61,29,51,18,"AccountNotFoundError"],[61,45,51,38],[61,46,51,38,"AccountNotFoundError"],[61,66,51,38],[61,67,51,39],[62,6,52,12,"docsPath"],[62,14,52,20],[62,16,52,22],[63,4,53,8],[63,5,53,9],[63,6,53,10],[64,4,54,4],[64,10,54,10,"account"],[64,17,54,17],[64,20,54,20],[64,24,54,20,"parseAccount"],[64,52,54,32],[64,53,54,32,"parseAccount"],[64,65,54,32],[64,67,54,33,"account_"],[64,75,54,41],[64,76,54,42],[65,4,55,4],[65,10,55,10,"executor"],[65,18,55,18],[65,21,55,21],[65,22,55,22],[65,28,55,28],[66,6,56,8],[66,10,56,12],[66,11,56,13,"parameters"],[66,21,56,23],[66,22,56,24,"executor"],[66,30,56,32],[66,32,57,12],[66,39,57,19,"undefined"],[66,48,57,28],[67,6,58,8],[67,10,58,12,"parameters"],[67,20,58,22],[67,21,58,23,"executor"],[67,29,58,31],[67,34,58,36],[67,40,58,42],[67,42,59,12],[67,49,59,19,"parameters"],[67,59,59,29],[67,60,59,30,"executor"],[67,68,59,38],[68,6,60,8],[68,13,60,15],[68,17,60,15,"parseAccount"],[68,45,60,27],[68,46,60,27,"parseAccount"],[68,58,60,27],[68,60,60,28,"parameters"],[68,70,60,38],[68,71,60,39,"executor"],[68,79,60,47],[68,80,60,48],[69,4,61,4],[69,5,61,5],[69,7,61,7],[69,8,61,8],[70,4,62,4],[70,10,62,10,"authorization"],[70,23,62,23],[70,26,62,26],[71,6,63,8,"address"],[71,13,63,15],[71,15,63,17,"parameters"],[71,25,63,27],[71,26,63,28,"contractAddress"],[71,41,63,43],[71,45,63,47,"parameters"],[71,55,63,57],[71,56,63,58,"address"],[71,63,63,65],[72,6,64,8,"chainId"],[72,13,64,15],[73,6,65,8,"nonce"],[74,4,66,4],[74,5,66,5],[75,4,67,4],[75,8,67,8],[75,15,67,15,"authorization"],[75,28,67,28],[75,29,67,29,"chainId"],[75,36,67,36],[75,41,67,41],[75,52,67,52],[75,54,68,8,"authorization"],[75,67,68,21],[75,68,68,22,"chainId"],[75,75,68,29],[75,78,69,12,"client"],[75,84,69,18],[75,85,69,19,"chain"],[75,90,69,24],[75,92,69,26,"id"],[75,94,69,28],[75,99,70,17],[75,105,70,23],[75,109,70,23,"getAction"],[75,126,70,32],[75,127,70,32,"getAction"],[75,136,70,32],[75,138,70,33,"client"],[75,144,70,39],[75,146,70,41,"getChainId"],[75,165,70,51],[75,166,70,51,"getChainId"],[75,176,70,51],[75,178,70,53],[75,190,70,65],[75,191,70,66],[75,192,70,67],[75,193,70,68],[75,194,70,69],[75,195,70,70],[75,196,70,71],[76,4,71,4],[76,8,71,8],[76,15,71,15,"authorization"],[76,28,71,28],[76,29,71,29,"nonce"],[76,34,71,34],[76,39,71,39],[76,50,71,50],[76,52,71,52],[77,6,72,8,"authorization"],[77,19,72,21],[77,20,72,22,"nonce"],[77,25,72,27],[77,28,72,30],[77,34,72,36],[77,38,72,36,"getAction"],[77,55,72,45],[77,56,72,45,"getAction"],[77,65,72,45],[77,67,72,46,"client"],[77,73,72,52],[77,75,72,54,"getTransactionCount"],[77,103,72,73],[77,104,72,73,"getTransactionCount"],[77,123,72,73],[77,125,72,75],[77,146,72,96],[77,147,72,97],[77,148,72,98],[78,8,73,12,"address"],[78,15,73,19],[78,17,73,21,"account"],[78,24,73,28],[78,25,73,29,"address"],[78,32,73,36],[79,8,74,12,"blockTag"],[79,16,74,20],[79,18,74,22],[80,6,75,8],[80,7,75,9],[80,8,75,10],[81,6,76,8],[81,10,76,12,"executor"],[81,18,76,20],[81,23,76,25],[81,29,76,31],[81,33,77,13,"executor"],[81,41,77,21],[81,43,77,23,"address"],[81,50,77,30],[81,54,77,34],[81,58,77,34,"isAddressEqual"],[81,87,77,48],[81,88,77,48,"isAddressEqual"],[81,102,77,48],[81,104,77,49,"executor"],[81,112,77,57],[81,113,77,58,"address"],[81,120,77,65],[81,122,77,67,"account"],[81,129,77,74],[81,130,77,75,"address"],[81,137,77,82],[81,138,77,84],[81,140,78,12,"authorization"],[81,153,78,25],[81,154,78,26,"nonce"],[81,159,78,31],[81,163,78,35],[81,164,78,36],[82,4,79,4],[83,4,80,4],[83,11,80,11,"authorization"],[83,24,80,24],[84,2,81,0],[85,0,81,1],[85,3]],"functionMap":{"names":["<global>","prepareAuthorization","<anonymous>"],"mappings":"AAA;OC+C;sBCO;KDM;CDoB"},"hasCjsExports":false},"type":"js/module"}]}